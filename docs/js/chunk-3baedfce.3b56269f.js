(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3baedfce"],{"0179":function(module,exports,__webpack_require__){if(!jSuites){var jSuites=__webpack_require__("67ca");__webpack_require__("fece")}(function(e,t){module.exports=t()})(0,(function(){"use strict";var jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("JEXCEL: el is not a valid DOM element"),!1;if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options)))return console.error("JEXCEL: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,data:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jexcel",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,meta:null,style:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:"jExcel CE Spreadsheet\nVersion 4.3.0\nAuthor: Paul Hodel <paul.hodel@gmail.com>\nWebsite: https://bossanova.uk/jexcel/v3"};for(var property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("JEXCEL: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){null==e&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,1==e?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if("function"==typeof obj.options.onevent)var t=obj.options.onevent.apply(this,arguments);if("function"==typeof obj.options[e])t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1))}if("onafterchanges"==e&&obj.options.persistance){var o=1==obj.options.persistance?obj.options.url:obj.options.persistance,r=obj.prepareJson(arguments[2]);obj.save(o,r)}return t},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&"undefined"!==typeof obj.options.data[0]){var t=Object.keys(obj.options.data[0]);t.length>e&&(e=t.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var o=[],r=0;r<e;r++)obj.options.colHeaders[r]||(obj.options.colHeaders[r]=""),obj.options.colWidths[r]||(obj.options.colWidths[r]=obj.options.defaultColWidth),obj.options.colAlignments[r]||(obj.options.colAlignments[r]=obj.options.defaultColAlign),obj.options.columns[r]?obj.options.columns[r].type||(obj.options.columns[r].type="text"):obj.options.columns[r]={type:"text"},obj.options.columns[r].name||(obj.options.columns[r].name=t&&t[r]?t[r]:r),obj.options.columns[r].source||(obj.options.columns[r].source=[]),obj.options.columns[r].options||(obj.options.columns[r].options=[]),obj.options.columns[r].editor||(obj.options.columns[r].editor=null),obj.options.columns[r].allowEmpty||(obj.options.columns[r].allowEmpty=!1),obj.options.columns[r].title||(obj.options.columns[r].title=obj.options.colHeaders[r]?obj.options.colHeaders[r]:""),obj.options.columns[r].width||(obj.options.columns[r].width=obj.options.colWidths[r]?obj.options.colWidths[r]:obj.options.defaultColWidth),obj.options.columns[r].align||(obj.options.columns[r].align=obj.options.colAlignments[r]?obj.options.colAlignments[r]:"center"),"autocomplete"==obj.options.columns[r].type||"dropdown"==obj.options.columns[r].type?obj.options.columns[r].url&&o.push({url:obj.options.columns[r].url,index:r,method:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)obj.options.columns[this.index].source.push(e[t])}}):"calendar"==obj.options.columns[r].type&&(obj.options.columns[r].options.format||(obj.options.columns[r].options.format="DD/MM/YYYY"));o.length?jSuites.ajax(o,(function(){obj.createTable()})):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(e){obj.scrollControls(e)},obj.content.onwheel=function(e){obj.wheelControls(e)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var o=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var r=0;r<obj.options.paginationOptions.length;r++){var n=document.createElement("option");n.value=obj.options.paginationOptions[r],n.innerHTML=obj.options.paginationOptions[r],obj.paginationDropdown.appendChild(n)}o.appendChild(document.createTextNode(obj.options.text.show)),o.appendChild(obj.paginationDropdown),o.appendChild(document.createTextNode(obj.options.text.entries))}var i=document.createElement("div");i.classList.add("jexcel_filter"),i.appendChild(o),i.appendChild(e),obj.colgroupContainer=document.createElement("colgroup");var s=document.createElement("col");if(s.setAttribute("width","50"),obj.colgroupContainer.appendChild(s),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var a=0;a<obj.options.nestedHeaders.length;a++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[a]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));obj.headerContainer=document.createElement("tr");s=document.createElement("td");s.classList.add("jexcel_selectall"),obj.headerContainer.appendChild(s);for(r=0;r<obj.options.columns.length;r++)obj.createCellHeader(r),obj.headerContainer.appendChild(obj.headers[r]),obj.colgroupContainer.appendChild(obj.colgroup[r]);if(obj.thead.appendChild(obj.headerContainer),1==obj.options.filters){obj.filter=document.createElement("tr");var l=document.createElement("td");obj.filter.appendChild(l);for(r=0;r<obj.options.columns.length;r++){l=document.createElement("td");l.innerHTML="&nbsp;",l.setAttribute("data-x",r),l.className="jexcel_column_filter",obj.filter.appendChild(l)}obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var u=document.createElement("a");u.setAttribute("href","https://bossanova.uk/jexcel/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if("undefined"!==typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var c=document.createElement("img");c.src="//bossanova.uk/jexcel/logo.png",u.appendChild(c)}}catch(b){}var d=document.createElement("span");d.innerHTML="Jexcel spreadsheet",u.appendChild(d),obj.ads.appendChild(u);var p=document.createElement("div");p.classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var h=document.createElement("div"),f=document.createElement("div");obj.pagination.appendChild(h),obj.pagination.appendChild(f),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(i),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1)},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:"GET",dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&("string"==typeof e&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var t=0;t<obj.options.data.length;t++){for(var o=[],r=0;r<obj.options.columns.length;r++)o[r]=obj.options.data[t][obj.options.columns[r].name];e.push(o)}obj.options.data=e}t=0,r=0;var n=obj.options.columns.length,i=obj.options.data.length,s=obj.options.minDimensions[0],a=obj.options.minDimensions[1],l=s>n?s:n,u=a>i?a:i;for(t=0;t<u;t++)for(r=0;r<l;r++)void 0==obj.options.data[t]&&(obj.options.data[t]=[]),void 0==obj.options.data[t][r]&&(obj.options.data[t][r]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading){var c=0,d=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("JEXCEL: Pagination will be disable due the lazyLoading"))}else if(obj.options.pagination){obj.pageNumber||(obj.pageNumber=0);obj.options.pagination;c=obj.options.pagination*obj.pageNumber,d=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<d&&(d=obj.options.data.length)}else c=0,d=obj.options.data.length;for(t=0;t<obj.options.data.length;t++){var p=obj.createRow(t,obj.options.data[t]);t>=c&&t<d&&obj.tbody.appendChild(p)}if(1==obj.options.lazyLoading||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var h=Object.keys(obj.options.mergeCells);for(r=0;r<h.length;r++){var f=obj.options.mergeCells[h[r]];obj.setMerge(h[r],f[0],f[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var o=[],r=0,n=0,i=1==t||0==obj.options.copyCompatibility,s=obj.options.columns.length,a=obj.options.data.length,l=0;l<a;l++){r=0;for(var u=0;u<s;u++)e&&!obj.records[l][u].classList.contains("highlight")||(o[n]||(o[n]=[]),o[n][r]=i?obj.options.data[l][u]:obj.records[l][u].innerHTML,r++);r>0&&n++}return o},obj.getJson=function(e){for(var t=[],o=obj.options.columns.length,r=obj.options.data.length,n=0;n<r;n++){for(var i=null,s=0;s<o;s++)e&&!obj.records[n][s].classList.contains("highlight")||(null==i&&(i={}),obj.options.columns[s].name||(obj.options.columns[s].name=s),i[obj.options.columns[s].name]=obj.options.data[n][s]);null!=i&&t.push(i)}return t},obj.prepareJson=function(e){for(var t=[],o=0;o<e.length;o++){var r=e[o].x,n=e[o].y,i=obj.options.columns[r].name?obj.options.columns[r].name:r;t[n]||(t[n]={row:n,data:{}}),t[n].data[i]=e[o].newValue}return t.filter((function(e){return null!=e}))},obj.save=function(e,t){var o=obj.dispatch("onbeforesave",el,obj,t);if(console.log(o),o)t=o;else if(!1===o)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){obj.dispatch("onsave",el,obj,t)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,t){for(var o=0;o<obj.headers.length;o++){var r=jexcel.getColumnNameFromId([o,e]);null!=t[o]&&obj.setValue(r,t[o])}},obj.getColumnData=function(e){for(var t=[],o=0;o<obj.options.data.length;o++)t.push(obj.options.data[o][e]);return t},obj.setColumnData=function(e,t){for(var o=0;o<obj.rows.length;o++){var r=jexcel.getColumnNameFromId([e,o]);null!=t[o]&&obj.setValue(r,t[o])}},obj.createRow=function(e,t){if(obj.records[e]||(obj.records[e]=[]),!t)t=obj.options.data[e];obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e),obj.options.rows[e]&&obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height);var o=document.createElement("td");o.innerHTML=parseInt(e+1),o.setAttribute("data-y",e),o.className="jexcel_row",obj.rows[e].appendChild(o);for(var r=0;r<obj.options.columns.length;r++)obj.records[e][r]=obj.createCell(r,e,t[r]),obj.rows[e].appendChild(obj.records[e][r]);return obj.rows[e]},obj.parseValue=function(e,t,o){if("="==(""+o).substr(0,1)&&1==obj.options.parseFormulas&&(o=obj.executeFormula(o,e,t)),obj.options.columns[e].mask){var r=obj.options.columns[e].decimal||".";o=""+jSuites.mask.run(o,obj.options.columns[e].mask,r)}return o},obj.createCell=function(e,t,o){var r=document.createElement("td");if(r.setAttribute("data-x",e),r.setAttribute("data-y",t),"="==(""+o).substr(0,1)&&1==obj.options.secureFormulas){var n=secureFormula(o);n!=o&&(o=n)}if(obj.options.columns[e].editor)!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?r.innerHTML=o:r.innerText=o,"function"==typeof obj.options.columns[e].editor.createCell&&(r=obj.options.columns[e].editor.createCell(r));else if("hidden"==obj.options.columns[e].type)r.style.display="none",r.innerText=o;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){var i=document.createElement("input");i.type=obj.options.columns[e].type,i.name="c"+e,i.checked=1==o||1==o||"true"==o,i.onclick=function(){obj.setValue(r,this.checked)},1!=obj.options.columns[e].readOnly&&0!=obj.options.editable||i.setAttribute("disabled","disabled"),r.appendChild(i),obj.options.data[t][e]=i.checked}else if("calendar"==obj.options.columns[e].type){var s=jSuites.calendar.extractDateFromString(o,obj.options.columns[e].options.format);r.innerText=jSuites.calendar.getDateString(s||o,obj.options.columns[e].options.format)}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)r.classList.add("jexcel_dropdown"),r.innerText=obj.getDropDownValue(e,o);else if("color"==obj.options.columns[e].type)if("square"==obj.options.columns[e].render){var a=document.createElement("div");a.className="color",a.style.backgroundColor=o,r.appendChild(a)}else r.style.color=o,r.innerText=o;else if("image"==obj.options.columns[e].type){if(o&&"data:image"==o.substr(0,10)){var l=document.createElement("img");l.src=o,r.appendChild(l)}}else"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?r.innerHTML=stripScript(obj.parseValue(e,t,o)):r.innerText=obj.parseValue(e,t,o);1==obj.options.columns[e].readOnly&&(r.className="readonly");var u=obj.options.columns[e].align?obj.options.columns[e].align:"center";return r.style.textAlign=u,0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||r.innerHTML.length>200)&&(r.style.whiteSpace="pre-wrap"),e>0&&(o||r.innerHTML?obj.records[t][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(r.style.overflow="hidden")),r},obj.createCellHeader=function(e){var t=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,o=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.headers[e].innerText=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=o,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.options.columns[e].title),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),"hidden"==obj.options.columns[e].type&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,o){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=o,obj.options.nestedHeaders[t].element.children[e+1].innerText=o)},obj.createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jexcel_nested");var o=document.createElement("td");t.appendChild(o),e.element=t;for(var r=0,n=0;n<e.length;n++){e[n].colspan||(e[n].colspan=1),e[n].align||(e[n].align="center"),e[n].title||(e[n].title="");for(var i=e[n].colspan,s=[],a=0;a<i;a++)obj.options.columns[r]&&"hidden"==obj.options.columns[r].type&&i++,s.push(r),r++;o=document.createElement("td");o.setAttribute("data-column",s.join(",")),o.setAttribute("colspan",e[n].colspan),o.setAttribute("align",e[n].align),o.innerText=e[n].title,t.appendChild(o)}return t},obj.createToolbar=function(e){if(e)obj.options.toolbar=e;else e=obj.options.toolbar;for(var t=0;t<e.length;t++)if("i"==e[t].type){var o=document.createElement("i");o.classList.add("jexcel_toolbar_item"),o.classList.add("material-icons"),o.setAttribute("data-k",e[t].k),o.setAttribute("data-v",e[t].v),e[t].tooltip&&o.setAttribute("title",e[t].tooltip),e[t].onclick&&(e[t].onclick,1)?o.onclick=function(t){var o=t;return function(){e[o].onclick(el,obj,this)}}(t):o.onclick=function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");obj.setStyle(obj.highlighted,e,t)},o.innerText=e[t].content,obj.toolbar.appendChild(o)}else if("select"==e[t].type){o=document.createElement("select");o.classList.add("jexcel_toolbar_item"),o.setAttribute("data-k",e[t].k),e[t].tooltip&&o.setAttribute("title",e[t].tooltip),e[t].onchange&&(e[t].onchange,1)?o.onchange=e[t].onchange:o.onchange=function(){var e=this.getAttribute("data-k");obj.setStyle(obj.highlighted,e,this.value)};for(var r=0;r<e[t].v.length;r++){var n=document.createElement("option");n.value=e[t].v[r],n.innerText=e[t].v[r],o.appendChild(n)}obj.toolbar.appendChild(o)}else if("color"==e[t].type){o=document.createElement("i");o.classList.add("jexcel_toolbar_item"),o.classList.add("material-icons"),o.setAttribute("data-k",e[t].k),o.setAttribute("data-v",""),e[t].tooltip&&o.setAttribute("title",e[t].tooltip),obj.toolbar.appendChild(o),o.onclick=function(){this.color.open()},o.innerText=e[t].content,jSuites.color(o,{onchange:function(e,t){var o=e.getAttribute("data-k");obj.setStyle(obj.highlighted,o,t)}})}},obj.setMerge=function(e,t,o,r){var n=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var i=parseInt(obj.highlighted[0].getAttribute("data-x")),s=parseInt(obj.highlighted[0].getAttribute("data-y")),a=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),l=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([i,s]),t=a-i+1,o=l-s+1}var u=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[u[1]][u[0]].getAttribute("data-merged")&&(n=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!o||o<2))n=obj.options.text.invalidMergeProperties;else for(var c=u[1];c<u[1]+o;c++)for(var d=u[0];d<u[0]+t;d++){jexcel.getColumnNameFromId([d,c]);obj.records[c][d].getAttribute("data-merged")&&(n=obj.options.text.thereIsAConflictWithAnotherMergedCell)}if(n)alert(n);else{t>1?obj.records[u[1]][u[0]].setAttribute("colspan",t):t=1,o>1?obj.records[u[1]][u[0]].setAttribute("rowspan",o):o=1,obj.options.mergeCells[e]=[t,o,[]],obj.records[u[1]][u[0]].setAttribute("data-merged","true"),obj.records[u[1]][u[0]].style.overflow="hidden";for(var p=[],h=u[1];h<u[1]+o;h++)for(var f=u[0];f<u[0]+t;f++)u[0]==f&&u[1]==h||(p.push(obj.options.data[h][f]),obj.updateCell(f,h,"",!0),obj.options.mergeCells[e][2].push(obj.records[h][f]),obj.records[h][f].style.display="none",obj.records[h][f]=obj.records[u[1]][u[0]]);obj.updateSelection(obj.records[u[1]][u[0]]),r||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:o,data:p}),obj.dispatch("onmerge",el,e,t,o))}},obj.getMerge=function(e){var t={};if(e)t=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++)t[o[r]]=[obj.options.mergeCells[o[r]][0],obj.options.mergeCells[o[r]][1]]}return t},obj.removeMerge=function(e,t,o){if(obj.options.mergeCells[e]){var r=jexcel.getIdFromColumnName(e,!0);obj.records[r[1]][r[0]].removeAttribute("colspan"),obj.records[r[1]][r[0]].removeAttribute("rowspan"),obj.records[r[1]][r[0]].removeAttribute("data-merged");for(var n=obj.options.mergeCells[e],i=0,s=0;s<n[1];s++)for(var a=0;a<n[0];a++)(s>0||a>0)&&(obj.records[r[1]+s][r[0]+a]=n[2][i],obj.records[r[1]+s][r[0]+a].style.display="",t&&t[i]&&obj.updateCell(r[0]+a,r[1]+s,t[i]),i++);obj.updateSelection(obj.records[r[1]][r[0]],obj.records[r[1]+s-1][r[0]+a-1]),o||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),o=0;o<t.length;o++)obj.removeMerge(t[o],null,e)}},obj.isColMerged=function(e,t){var o=[];if(obj.options.mergeCells)for(var r=Object.keys(obj.options.mergeCells),n=0;n<r.length;n++){var i=jexcel.getIdFromColumnName(r[n],!0),s=obj.options.mergeCells[r[n]][0],a=i[0],l=i[0]+(s>1?s-1:0);null==t?a<=e&&l>=e&&o.push(r[n]):t?a<e&&l>=e&&o.push(r[n]):a<=e&&l>e&&o.push(r[n])}return o},obj.isRowMerged=function(e,t){var o=[];if(obj.options.mergeCells)for(var r=Object.keys(obj.options.mergeCells),n=0;n<r.length;n++){var i=jexcel.getIdFromColumnName(r[n],!0),s=obj.options.mergeCells[r[n]][1],a=i[1],l=i[1]+(s>1?s-1:0);null==t?a<=e&&l>=e&&o.push(r[n]):t?a<e&&l>=e&&o.push(r[n]):a<=e&&l>e&&o.push(r[n])}return o},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();for(var t=[],o=0;o<obj.options.data.length;o++){var r=obj.options.data[o][e],n=obj.records[o][e].innerHTML;r&&n&&(t[r]=n)}var i=Object.keys(t),s=[];for(o=0;o<i.length;o++)s.push({id:i[o],name:t[i[o]]});var a=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(a),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial",jSuites.dropdown(a,{data:s,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[e]?obj.filters[e]:"",width:"100%",position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(t){obj.resetFilters(),obj.filters[e]=t.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=t.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e)}})}else console.log("JEXCEL: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null},obj.closeFilter=function(e){if(!e)for(var t=0;t<obj.filter.children.length;t++)obj.filters[t]&&(e=t);var o=function(e,t,o){for(var r=0;r<e.length;r++)if((""+obj.options.data[o][t]).search(e[r])>=0||(""+obj.records[o][t].innerHTML).search(e[r])>=0)return!0;return!1},r=obj.filters[e];obj.results=[];for(var n=0;n<obj.options.data.length;n++)o(r,e,n)&&obj.results.push(n);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,t,o){var r=e.getAttribute("data-y"),n=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,n,r),n>0&&(obj.records[r][n-1].style.overflow="hidden");var i=function(t){var o=e.getBoundingClientRect(),r=document.createElement(t);return r.style.width=o.width+"px",r.style.height=o.height-2+"px",r.style.minHeight=o.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(r),r};if(1==e.classList.contains("readonly"));else if(obj.edition=[obj.records[r][n],obj.records[r][n].innerHTML,n,r],obj.options.columns[n].editor)obj.options.columns[n].editor.openEditor(e,el,t,o);else if("hidden"==obj.options.columns[n].type);else if("checkbox"==obj.options.columns[n].type||"radio"==obj.options.columns[n].type){var s=!e.children[0].checked;obj.setValue(e,s),obj.edition=null}else if("dropdown"==obj.options.columns[n].type||"autocomplete"==obj.options.columns[n].type){s=obj.options.data[r][n];if("function"==typeof obj.options.columns[n].filter)var a=obj.options.columns[n].filter(el,e,n,r,obj.options.columns[n].source);else a=obj.options.columns[n].source;for(var l=[],u=0;u<a.length;u++)l.push(a[u]);var c=i("div"),d={data:l,multiple:!!obj.options.columns[n].multiple,autocomplete:!(!obj.options.columns[n].autocomplete&&"autocomplete"!=obj.options.columns[n].type),opened:!0,value:obj.options.columns[n].multiple?s.split(";"):s,width:"100%",height:c.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[n].options&&obj.options.columns[n].options.type&&(d.type=obj.options.columns[n].options.type),jSuites.dropdown(c,d)}else if("calendar"==obj.options.columns[n].type||"color"==obj.options.columns[n].type){s=obj.options.data[r][n],c=i("input");c.value=s,1!=obj.options.tableOverflow&&1!=obj.options.fullscreen||(obj.options.columns[n].options.position=!0),obj.options.columns[n].options.value=obj.options.data[r][n],obj.options.columns[n].options.opened=!0,obj.options.columns[n].options.onclose=function(t,o){obj.closeEditor(e,!0)},"color"==obj.options.columns[n].type?jSuites.color(c,obj.options.columns[n].options):jSuites.calendar(c,obj.options.columns[n].options),c.focus()}else if("html"==obj.options.columns[n].type){s=obj.options.data[r][n],c=i("div");c.style.position="relative";var p=document.createElement("div");p.classList.add("jexcel_richtext"),c.appendChild(p),jSuites.editor(p,{focus:!0,value:s});const t=e.getBoundingClientRect(),o=p.getBoundingClientRect();window.innerHeight<t.bottom+o.height?p.style.top=t.top-(o.height+2)+"px":p.style.top=t.top+"px"}else if("image"==obj.options.columns[n].type){var h=e.children[0];c=i("div");c.style.position="relative";p=document.createElement("div");p.classList.add("jclose"),h&&h.src&&p.appendChild(h),c.appendChild(p),jSuites.image(p,obj.options.imageOptions);const t=e.getBoundingClientRect(),o=p.getBoundingClientRect();window.innerHeight<t.bottom+o.height?p.style.top=t.top-(o.height+2)+"px":p.style.top=t.top+"px"}else{s=1==t?"":obj.options.data[r][n];if(0==obj.options.columns[n].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[n].wordWrap){c=i("input");obj.options.columns[n].mask&&c.setAttribute("data-mask",obj.options.columns[n].mask)}else var c=i("textarea");c.onblur=function(){obj.closeEditor(e,!0)},c.focus(),c.value=s}},obj.closeEditor=function(e,t){var o=parseInt(e.getAttribute("data-x")),r=parseInt(e.getAttribute("data-y"));if(1==t){if(obj.options.columns[o].editor)var n=obj.options.columns[o].editor.closeEditor(e,t);else if("checkbox"==obj.options.columns[o].type||"radio"==obj.options.columns[o].type||"hidden"==obj.options.columns[o].type);else if("dropdown"==obj.options.columns[o].type||"autocomplete"==obj.options.columns[o].type)n=e.children[0].dropdown.close(!0);else if("calendar"==obj.options.columns[o].type)n=e.children[0].calendar.close(!0);else if("color"==obj.options.columns[o].type)n=e.children[0].color.close(!0);else if("html"==obj.options.columns[o].type)n=e.children[0].children[0].editor.getData();else if("image"==obj.options.columns[o].type){var i=e.children[0].children[0].children[0];n=i&&"IMG"==i.tagName?i.src:""}else if("numeric"==obj.options.columns[o].type){n=e.children[0].value;"="!=n.substr(0,1)&&""==n&&(n=obj.options.columns[o].allowEmpty?"":0),e.children[0].onblur=null}else{n=e.children[0].value;e.children[0].onblur=null}obj.options.data[r][o]==n?e.innerHTML=obj.edition[1]:obj.setValue(e,n)}else obj.options.columns[o].editor?obj.options.columns[o].editor.closeEditor(e,t):"dropdown"==obj.options.columns[o].type||"autocomplete"==obj.options.columns[o].type?e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[o].type?e.children[0].calendar.close(!0):"color"==obj.options.columns[o].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,o,r,n,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){e=jexcel.getIdFromColumnName(e,!0);var t=e[0],o=e[1];return obj.records[o][t]},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){e=jexcel.getIdFromColumnName(e,!0);var t=e[0],o=e[1];return obj.records[o][t].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){if("object"==typeof e)var o=e.getAttribute("data-x"),r=e.getAttribute("data-y");else{e=jexcel.getIdFromColumnName(e,!0);o=e[0],r=e[1]}var n=null;return null!=o&&null!=r&&(obj.records[r]&&obj.records[r][o]&&(t||1==obj.options.copyCompatibility)?n=obj.records[r][o].innerHTML:obj.options.data[r]&&"undefined"!=obj.options.data[r][o]&&(n=obj.options.data[r][o])),n},obj.getValueFromCoords=function(e,t,o){var r=null;return null!=e&&null!=t&&(obj.records[t]&&obj.records[t][e]&&o||1==obj.options.copyCompatibility?r=obj.records[t][e].innerHTML:obj.options.data[t]&&"undefined"!=obj.options.data[t][e]&&(r=obj.options.data[t][e])),r},obj.setValue=function(e,t,o){var r=[];if("string"==typeof e){var n=jexcel.getIdFromColumnName(e,!0),i=n[0],s=n[1];r.push(obj.updateCell(i,s,t,o)),obj.updateFormulaChain(i,s,r)}else{i=null,s=null;if(e&&e.getAttribute)i=e.getAttribute("data-x"),s=e.getAttribute("data-y");if(null!=i&&null!=s)r.push(obj.updateCell(i,s,t,o)),obj.updateFormulaChain(i,s,r);else{var a=Object.keys(e);if(a.length>0)for(var l=0;l<a.length;l++){if("string"==typeof e[l])n=jexcel.getIdFromColumnName(e[l],!0),i=n[0],s=n[1];else if(null!=e[l].x&&null!=e[l].y){i=e[l].x,s=e[l].y;null!=e[l].newValue?t=e[l].newValue:null!=e[l].value&&(t=e[l].value)}else i=e[l].getAttribute("data-x"),s=e[l].getAttribute("data-y");null!=i&&null!=s&&(r.push(obj.updateCell(i,s,t,o)),obj.updateFormulaChain(i,s,r))}}}obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.setValueFromCoords=function(e,t,o,r){var n=[];n.push(obj.updateCell(e,t,o,r)),obj.updateFormulaChain(e,t,n),obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,n)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),o=0;o<t.length;o++){var r=obj.highlighted[o].getAttribute("data-x"),n=obj.highlighted[o].getAttribute("data-y");"checkbox"!=obj.options.columns[r].type&&"radio"!=obj.options.columns[r].type||e.push(obj.updateCell(r,n,!obj.options.data[n][r]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var t=new Option;t.innerHTML=e;var o=null;for(e=t.getElementsByTagName("script");o=e[0];)o.parentNode.removeChild(o);return t.innerHTML};obj.updateCell=function(e,t,o,r){if(1!=obj.records[t][e].classList.contains("readonly")||r){if("="==(""+o).substr(0,1)&&1==obj.options.secureFormulas){var n=secureFormula(o);n!=o&&(o=n)}n=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,o);void 0!=n&&(o=n),obj.options.columns[e].editor&&"function"==typeof obj.options.columns[e].editor.updateCell&&(o=obj.options.columns[e].editor.updateCell(obj.records[t][e],o,r));u={x:e,y:t,col:e,row:t,newValue:o,oldValue:obj.options.data[t][e]};if(obj.options.columns[e].editor)obj.options.data[t][e]=o;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){if("radio"==obj.options.columns[e].type)for(var i=0;i<obj.options.data.length;i++)obj.options.data[i][e]=!1;obj.records[t][e].children[0].checked=1==o||1==o||"true"==o||"TRUE"==o,obj.options.data[t][e]=obj.records[t][e].children[0].checked}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)obj.options.data[t][e]=o,obj.records[t][e].innerText=obj.getDropDownValue(e,o);else if("calendar"==obj.options.columns[e].type){var s=jSuites.calendar.extractDateFromString(o,obj.options.columns[e].options.format);obj.options.data[t][e]=o,obj.records[t][e].innerText=jSuites.calendar.getDateString(s||o,obj.options.columns[e].options.format)}else if("color"==obj.options.columns[e].type)if(obj.options.data[t][e]=o,"square"==obj.options.columns[e].render){var a=document.createElement("div");a.className="color",a.style.backgroundColor=o,obj.records[t][e].innerText="",obj.records[t][e].appendChild(a)}else obj.records[t][e].style.color=o,obj.records[t][e].innerText=o;else if("image"==obj.options.columns[e].type){if(o=""+o,obj.options.data[t][e]=o,obj.records[t][e].innerHTML="",o&&"data:image"==o.substr(0,10)){var l=document.createElement("img");l.src=o,obj.records[t][e].appendChild(l)}}else obj.options.data[t][e]=o,"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,o)):obj.records[t][e].innerText=obj.parseValue(e,t,o),0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||obj.records[t][e].innerHTML.length>200)?obj.records[t][e].style.whiteSpace="pre-wrap":obj.records[t][e].style.whiteSpace="";e>0&&(obj.records[t][e-1].style.overflow=o?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,o,u.oldValue)}else var u={x:e,y:t,col:e,row:t};return u},obj.copyData=function(e,t){var o=obj.getData(!0,!0),r=obj.selectedContainer,n=parseInt(e.getAttribute("data-x")),i=parseInt(e.getAttribute("data-y")),s=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y")),l=[],u=!1;if(r[0]==n){if(i<r[1])var c=i-r[1];else c=1;var d=0}else{if(n<r[0])d=n-r[0];else d=1;c=0}for(var p=0,h=0,f=i;f<=a;f++)if(!obj.rows[f]||"none"!=obj.rows[f].style.display){if(void 0==o[h]&&(h=0),p=0,r[0]!=n)if(n<r[0])d=n-r[0];else d=1;for(var b=n;b<=s;b++){if(obj.records[f][b]&&!obj.records[f][b].classList.contains("readonly")&&"none"!=obj.records[f][b].style.display&&0==u){if(!obj.selection.length&&""!=obj.options.data[f][b]){u=!0;continue}(void 0==o[h]||void 0==o[h][p])&&(p=0);var m=o[h][p];if(m&&!o[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[b].type||"number"==obj.options.columns[b].type)if("="==(""+m).substr(0,1)){var g=m.match(/([A-Z]+[0-9]+)/g);if(g){for(var j=[],v=0;v<g.length;v++){var y=jexcel.getIdFromColumnName(g[v],1);y[0]+=d,y[1]+=c,y[1]<0&&(y[1]=0);var x=jexcel.getColumnNameFromId([y[0],y[1]]);x!=g[v]&&(j[g[v]]=x)}j&&(m=obj.updateFormula(m,j))}}else m==Number(m)&&(m=Number(m)+c);else if("calendar"==obj.options.columns[b].type){var C=new Date(m);C.setDate(C.getDate()+c),m=C.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(C.getMonth()+1))+"-"+jexcel.doubleDigitFormat(C.getDate())+" 00:00:00"}l.push(obj.updateCell(b,f,m)),obj.updateFormulaChain(b,f,l)}p++,r[0]!=n&&d++}h++,c++}obj.setHistory({action:"setValue",records:l,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,l)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,o){if(1==e){if(obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||o>=obj.selectedCell[1]&&o<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||o>=obj.selectedCell[0]&&o<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){u=1;for(var t=0;t<obj.highlighted.length;t++){obj.highlighted[t].classList.remove("highlight"),obj.highlighted[t].classList.remove("highlight-left"),obj.highlighted[t].classList.remove("highlight-right"),obj.highlighted[t].classList.remove("highlight-top"),obj.highlighted[t].classList.remove("highlight-bottom"),obj.highlighted[t].classList.remove("highlight-selected");var o=parseInt(obj.highlighted[t].getAttribute("data-x")),r=parseInt(obj.highlighted[t].getAttribute("data-y"));if(obj.highlighted[t].getAttribute("data-merged"))var n=parseInt(obj.highlighted[t].getAttribute("colspan")),i=parseInt(obj.highlighted[t].getAttribute("rowspan")),s=n>0?o+(n-1):o,a=i>0?r+(i-1):r;else s=o,a=r;for(var l=o;l<=s;l++)obj.headers[l]&&obj.headers[l].classList.remove("selected");for(l=r;l<=a;l++)obj.rows[l]&&obj.rows[l].classList.remove("selected")}}else var u=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1==e&&1==u&&obj.dispatch("onblur",el),u},obj.updateSelection=function(e,t,o){var r=e.getAttribute("data-x"),n=e.getAttribute("data-y");if(t)var i=t.getAttribute("data-x"),s=t.getAttribute("data-y");else i=r,s=n;obj.updateSelectionFromCoords(r,n,i,s,o)},obj.updateSelectionFromCoords=function(e,t,o,r,n){var i=obj.resetSelection();if(null==o&&(o=e),null==r&&(r=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),o>=obj.headers.length&&(o=obj.headers.length-1),r>=obj.rows.length&&(r=obj.rows.length-1),obj.selectedCell=[e,t,o,r],null!=e){if(obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(o))var s=parseInt(e),a=parseInt(o);else s=parseInt(o),a=parseInt(e);if(parseInt(t)<parseInt(r))var l=parseInt(t),u=parseInt(r);else l=parseInt(r),u=parseInt(t);for(var c=s;c<=a;c++)for(var d=l;d<=u;d++)if(obj.records[d][c]&&obj.records[d][c].getAttribute("data-merged")){var p=parseInt(obj.records[d][c].getAttribute("data-x")),h=parseInt(obj.records[d][c].getAttribute("data-y")),f=parseInt(obj.records[d][c].getAttribute("colspan")),b=parseInt(obj.records[d][c].getAttribute("rowspan"));f>1&&(p<s&&(s=p),p+f>a&&(a=p+f-1)),b&&(h<l&&(l=h),h+b>u&&(u=h+b-1))}var m=null,g=null,j=null,v=null;for(d=l;d<=u;d++)"none"!=obj.rows[d].style.display&&(null==j&&(j=d),v=d);for(c=s;c<=a;c++){for(d=l;d<=u;d++)"none"!=obj.rows[d].style.display&&"none"!=obj.records[d][c].style.display&&(obj.records[d][c].classList.add("highlight"),obj.highlighted.push(obj.records[d][c]));"hidden"!=obj.options.columns[c].type&&(null==m&&(m=c),g=c)}m||(m=0),g||(g=0);for(c=m;c<=g;c++)"hidden"!=obj.options.columns[c].type&&(obj.records[j][c]&&obj.records[j][c].classList.add("highlight-top"),obj.records[v][c]&&obj.records[v][c].classList.add("highlight-bottom"),obj.headers[c].classList.add("selected"));for(d=j;d<=v;d++)"none"!=obj.rows[d].style.display&&(obj.records[d][m].classList.add("highlight-left"),obj.records[d][g].classList.add("highlight-right"),obj.rows[d].classList.add("selected"));obj.selectedContainer=[m,j,g,v]}0==i&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,m,j,g,v,n),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var o=obj.selectedContainer[0],r=obj.selectedContainer[1],n=obj.selectedContainer[2],i=obj.selectedContainer[3];if(null!=e&&null!=t){if(e-n>0)var s=parseInt(n)+1,a=parseInt(e);else s=parseInt(e),a=parseInt(o)-1;if(t-i>0)var l=parseInt(i)+1,u=parseInt(t);else l=parseInt(t),u=parseInt(r)-1;if(a-s<=u-l)s=parseInt(o),a=parseInt(n);else l=parseInt(r),u=parseInt(i);for(var c=l;c<=u;c++)for(var d=s;d<=a;d++)obj.records[c][d]&&"none"!=obj.rows[c].style.display&&"none"!=obj.records[c][d].style.display&&(obj.records[c][d].classList.add("selection"),obj.records[l][d].classList.add("selection-top"),obj.records[u][d].classList.add("selection-bottom"),obj.records[c][s].classList.add("selection-left"),obj.records[c][a].classList.add("selection-right"),obj.selection.push(obj.records[c][d]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1];const c=obj.content.getBoundingClientRect();var t=c.left,o=c.top;const d=e.getBoundingClientRect();var r=d.left,n=d.top,i=d.width,s=d.height,a=r-t+obj.content.scrollLeft+i-4,l=n-o+obj.content.scrollTop+s-4;if(obj.corner.style.top=l+"px",obj.corner.style.left=a+"px",obj.options.freezeColumns){var u=obj.getFreezeWidth();r-t+i<u?obj.corner.style.display="none":1==obj.options.selectionCopy&&(obj.corner.style.display="")}else 1==obj.options.selectionCopy&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){const t=obj.content.getBoundingClientRect();var o=t.left,r=t.top,n=t.width,i=t.height,s=obj.records[obj.selectedCell[3]][obj.selectedCell[2]];const a=s.getBoundingClientRect();var l=a.left,u=a.top,c=a.width,d=a.height;if(0==e||1==e)var p=l-o+obj.content.scrollLeft,h=u-r+obj.content.scrollTop-2;else p=l-o+obj.content.scrollLeft+c,h=u-r+obj.content.scrollTop+d;h>obj.content.scrollTop+30&&h<obj.content.scrollTop+i||(h<obj.content.scrollTop+30?obj.content.scrollTop=h-d:obj.content.scrollTop=h-(i-2));var f=obj.getFreezeWidth();p>obj.content.scrollLeft+f&&p<obj.content.scrollLeft+n||(p<obj.content.scrollLeft+30?(obj.content.scrollLeft=p,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):p<obj.content.scrollLeft+f?obj.content.scrollLeft=p-f-1:obj.content.scrollLeft=p-(n-20))},obj.getWidth=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-x")),t=obj.colgroup[e].getAttribute("width");else for(var t=[],o=0;o<obj.headers.length;o++)t.push(obj.options.columns[o].width);return t},obj.setWidth=function(e,t,o){if(t){if(Array.isArray(e)){if(!o)o=[];for(var r=0;r<e.length;r++){o[r]||(o[r]=obj.colgroup[e[r]].getAttribute("width"));var n=Array.isArray(t)&&t[r]?t[r]:t;obj.colgroup[e[r]].setAttribute("width",n),obj.options.columns[e[r]].width=n}}else o||(o=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:o,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,o),obj.updateCornerPosition()}},obj.setHeight=function(e,t,o){if(t>0){if("object"==typeof e&&(e=e.getAttribute("data-y")),!o&&(o=obj.rows[e].getAttribute("height"),!o)){var r=obj.rows[e].getBoundingClientRect();o=r.height}t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:o,newValue:t}),obj.dispatch("onresizerow",el,e,t,o),obj.updateCornerPosition()}},obj.getHeight=function(e){if(e){"object"==typeof e&&(e=$(e).getAttribute("data-y"));t=obj.rows[e].style.height}else for(var t=[],o=0;o<obj.rows.length;o++){var r=obj.rows[o].style.height;r&&(t[o]=r)}return t},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var t=0;t<obj.options.footers.length;t++){if(obj.tfoot.children[t])var o=obj.tfoot.children[t];else{o=document.createElement("tr");var r=document.createElement("td");o.appendChild(r),obj.tfoot.appendChild(o)}for(var n=0;n<obj.headers.length;n++){if(obj.options.footers[t][n]||(obj.options.footers[t][n]=""),obj.tfoot.children[t].children[n+1])r=obj.tfoot.children[t].children[n+1];else{r=document.createElement("td");o.appendChild(r);var i=obj.options.columns[n].align?obj.options.columns[n].align:"center";r.style.textAlign=i}r.innerText=obj.parseValue(n,t,obj.options.footers[t][n])}}}},obj.getHeader=function(e){return obj.headers[e].innerText},obj.setHeader=function(e,t){if(obj.headers[e]){var o=obj.headers[e].innerText;t||(t=prompt(obj.options.text.columnName,o)),t&&(obj.headers[e].innerText=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:o,newValue:t}),obj.dispatch("onchangeheader",el,e,o,t)}},obj.getHeaders=function(e){for(var t=[],o=0;o<obj.headers.length;o++)t.push(obj.getHeader(o));return e?t:t.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,t,o){if(obj.options.meta||(obj.options.meta={}),t&&o)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=o;else for(var r=Object.keys(e),n=0;n<r.length;n++){obj.options.meta[r[n]]||(obj.options.meta[r[n]]={});for(var i=Object.keys(e[r[n]]),s=0;s<i.length;s++)obj.options.meta[r[n]][i[s]]=e[r[n]][i[s]]}obj.dispatch("onchangemeta",el,e,t,o)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},o=Object.keys(obj.options.meta),r=0;r<o.length;r++)e[o[r]]?t[e[o[r]]]=obj.options.meta[o[r]]:t[o[r]]=obj.options.meta[o[r]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var o={},r=obj.options.data[0].length,n=obj.options.data.length,i=0;i<n;i++)for(var s=0;s<r;s++){var a=t?obj.records[i][s].style[t]:obj.records[i][s].getAttribute("style");if(a){var l=jexcel.getColumnNameFromId([s,i]);o[l]=a}}return o},obj.resetStyle=function(e,t){for(var o=Object.keys(e),r=0;r<o.length;r++){var n=jexcel.getIdFromColumnName(o[r],!0);obj.records[n[1]]&&obj.records[n[1]][n[0]]&&obj.records[n[1]][n[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,o,r,n){var i={},s={},a=function(e,t,o){var n=jexcel.getIdFromColumnName(e,!0);if(obj.records[n[1]]&&obj.records[n[1]][n[0]]){var a=obj.records[n[1]][n[0]].style[t];a!=o||r?obj.records[n[1]][n[0]].style[t]=o:(o="",obj.records[n[1]][n[0]].style[t]=""),s[e]||(s[e]=[]),i[e]||(i[e]=[]),s[e].push([t+":"+a]),i[e].push([t+":"+o])}};if(t&&o)if("string"==typeof e)a(e,t,o);else for(var l=[],u=0;u<e.length;u++){var c=e[u].getAttribute("data-x"),d=e[u].getAttribute("data-y"),p=jexcel.getColumnNameFromId([c,d]);l[p]||(a(p,t,o),l[p]=!0)}else{var h=Object.keys(e);for(u=0;u<h.length;u++){var f=e[h[u]];"string"==typeof f&&(f=f.split(";"));for(var b=0;b<f.length;b++)"string"==typeof f[b]&&(f[b]=f[b].split(":")),f[b][0].trim()&&a(h[u],f[b][0].trim(),f[b][1])}}for(h=Object.keys(s),u=0;u<h.length;u++)s[h[u]]=s[h[u]].join(";");for(h=Object.keys(i),u=0;u<h.length;u++)i[h[u]]=i[h[u]].join(";");n||obj.setHistory({action:"setStyle",oldValue:s,newValue:i}),obj.dispatch("onchangestyle",el,e,t,o)},obj.getComments=function(e,t){if(e){if("string"==typeof e)e=jexcel.getIdFromColumnName(e,!0);return t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||""}for(var o={},r=0;r<obj.options.data.length;r++)for(var n=0;n<obj.options.columns.length;n++){var i=obj.records[r][n].getAttribute("title");if(i){e=jexcel.getColumnNameFromId([n,r]);o[e]=i}}return o},obj.setComments=function(e,t,o){if("string"==typeof e)var r=jexcel.getIdFromColumnName(e,!0);else r=e;var n=obj.records[r[1]][r[0]].getAttribute("title"),i=(o=obj.records[r[1]][r[0]].getAttribute("data-author"),[n,o]);obj.records[r[1]][r[0]].setAttribute("title",t||""),obj.records[r[1]][r[0]].setAttribute("data-author",o||""),t?obj.records[r[1]][r[0]].classList.add("jexcel_comments"):obj.records[r[1]][r[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,o],oldValue:i})},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=null==t?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0,Array.prototype.orderBy=function(e,t){return this.slice(0).sort((function(o,r){var n=o[e],i=r[e];return t?""==n&&""!=i?1:""!=n&&""==i||n>i?-1:n<i?1:0:""==n&&""!=i?1:""!=n&&""==i?-1:n>i?1:n<i?-1:0}))};var o=[];if("number"==obj.options.columns[e].type||"percentage"==obj.options.columns[e].type||"autonumber"==obj.options.columns[e].type||"color"==obj.options.columns[e].type)for(var r=0;r<obj.options.data.length;r++)o[r]=[r,Number(obj.options.data[r][e])];else if("calendar"==obj.options.columns[e].type||"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type)for(r=0;r<obj.options.data.length;r++)o[r]=[r,obj.options.data[r][e]];else for(r=0;r<obj.options.data.length;r++)o[r]=[r,obj.records[r][e].innerText.toLowerCase()];o=o.orderBy(1,t);var n=[];for(r=0;r<o.length;r++)n[r]=o[r][0];return obj.setHistory({action:"orderBy",rows:n,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(n),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var o=0;o<obj.headers.length;o++)obj.headers[o].classList.remove("arrow-up"),obj.headers[o].classList.remove("arrow-down");t?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var t=[],o=0;o<e.length;o++)t[o]=obj.options.data[e[o]];obj.options.data=t;for(t=[],o=0;o<e.length;o++)t[o]=obj.records[e[o]];obj.records=t;for(t=[],o=0;o<e.length;o++)t[o]=obj.rows[e[o]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(o=0;o<obj.rows.length;o++)obj.tbody.appendChild(obj.rows[o])},obj.moveRow=function(e,t,o){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var r=1;else r=0;if(obj.isRowMerged(e).length||obj.isRowMerged(t,r).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}o||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0?e>t?obj.tbody.insertBefore(obj.rows[e],obj.rows[t]):obj.tbody.insertBefore(obj.rows[e],obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,o){if(1==obj.options.allowInsertRow){var r=[];if(e>0)var n=e;else{n=1;e&&(r=e)}o=!!o;var i=obj.options.data.length-1;if((void 0==t||t>=parseInt(i)||t<0)&&(t=i),!1===obj.dispatch("onbeforeinsertrow",el,t,n,o))return console.log("onbeforeinsertrow returned false"),!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var s=o?t:t+1,a=obj.records.splice(s),l=obj.options.data.splice(s),u=obj.rows.splice(s),c=[],d=[],p=[],h=s;h<n+s;h++){obj.options.data[h]=[];for(var f=0;f<obj.options.columns.length;f++)obj.options.data[h][f]=r[f]?r[f]:"";var b=obj.createRow(h,obj.options.data[h]);u[0]?Array.prototype.indexOf.call(obj.tbody.children,u[0])>=0&&obj.tbody.insertBefore(b,u[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0&&obj.tbody.appendChild(b),c.push(obj.records[h]),d.push(obj.options.data[h]),p.push(b)}Array.prototype.push.apply(obj.records,a),Array.prototype.push.apply(obj.options.data,l),Array.prototype.push.apply(obj.rows,u),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:n,insertBefore:o,rowRecords:c,rowData:d,rowNode:p}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,n,c,o)}},obj.deleteRow=function(e,t){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||obj.options.data.length>1){if(void 0==e){var o=obj.getSelectedRows();o[0]?(e=parseInt(o[0].getAttribute("data-y")),t=o.length):(e=obj.options.data.length-1,t=1)}var r=obj.options.data.length-1;if((void 0==e||e>r||e<0)&&(e=r),t||(t=1),e+t>=obj.options.data.length&&(t=obj.options.data.length-e),!1===obj.dispatch("onbeforedeleterow",el,e,t))return console.log("onbeforedeleterow returned false"),!1;if(parseInt(e)>-1){var n=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var i=e;i<e+t;i++)obj.isRowMerged(i,!1).length&&(n=!0);if(n){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(i=e;i<e+t;i++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[i])>=0&&(obj.rows[i].className="",obj.rows[i].parentNode.removeChild(obj.rows[i]));var s=obj.records.splice(e,t),a=obj.options.data.splice(e,t),l=obj.rows.splice(e,t);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:s,rowData:a,rowNode:l}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,s)}}else console.error("JEXCEL. It is not possible to delete the last row")},obj.moveColumn=function(e,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var o=1;else o=0;if(obj.isColMerged(e).length||obj.isColMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}e=parseInt(e),t=parseInt(t);if(e>t){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var r=0;r<obj.rows.length;r++)obj.rows[r].insertBefore(obj.records[r][e],obj.records[r][t])}else{obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling);for(r=0;r<obj.rows.length;r++)obj.rows[r].insertBefore(obj.records[r][e],obj.records[r][t].nextSibling)}obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]);for(r=0;r<obj.rows.length;r++)obj.options.data[r].splice(t,0,obj.options.data[r].splice(e,1)[0]),obj.records[r].splice(t,0,obj.records[r].splice(e,1)[0]);if(obj.options.footers)for(r=0;r<obj.options.footers.length;r++)obj.options.footers[r].splice(t,0,obj.options.footers[r].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,o,r){if(1==obj.options.allowInsertColumn){var n=[];if(e>0)var i=e;else{i=1;e&&(n=e)}o=!!o;var s=obj.options.columns.length-1;if((void 0==t||t>=parseInt(s)||t<0)&&(t=s),!1===obj.dispatch("onbeforeinsertcolumn",el,t,i,o))return console.log("onbeforeinsertcolumn returned false"),!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}r||(r=[]);for(var a=0;a<i;a++)r[a]||(r[a]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var l=o?t:t+1;obj.options.columns=jexcel.injectArray(obj.options.columns,l,r);for(var u=obj.headers.splice(l),c=obj.colgroup.splice(l),d=[],p=[],h=[],f=[],b=[],m=l;m<i+l;m++)obj.createCellHeader(m),obj.headerContainer.insertBefore(obj.headers[m],obj.headerContainer.children[m+1]),obj.colgroupContainer.insertBefore(obj.colgroup[m],obj.colgroupContainer.children[m+1]),d.push(obj.headers[m]),p.push(obj.colgroup[m]);if(obj.options.footers)for(var g=0;g<obj.options.footers.length;g++){b[g]=[];for(a=0;a<i;a++)b[g].push("");obj.options.footers[g].splice(l,0,b[g])}for(var j=0;j<obj.options.data.length;j++){var v=obj.options.data[j].splice(l),y=obj.records[j].splice(l);f[j]=[],h[j]=[];for(m=l;m<i+l;m++){var x=n[j]?n[j]:"";obj.options.data[j][m]=x;var C=obj.createCell(m,j,obj.options.data[j][m]);obj.records[j][m]=C,obj.rows[j]&&obj.rows[j].insertBefore(C,obj.rows[j].children[m+1]),f[j].push(x),h[j].push(C)}Array.prototype.push.apply(obj.options.data[j],v),Array.prototype.push.apply(obj.records[j],y)}if(Array.prototype.push.apply(obj.headers,u),Array.prototype.push.apply(obj.colgroup,c),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(g=0;g<obj.options.nestedHeaders.length;g++){var w=parseInt(obj.options.nestedHeaders[g][obj.options.nestedHeaders[g].length-1].colspan)+i;obj.options.nestedHeaders[g][obj.options.nestedHeaders[g].length-1].colspan=w,obj.thead.children[g].children[obj.thead.children[g].children.length-1].setAttribute("colspan",w)}else{w=parseInt(obj.options.nestedHeaders[0].colspan)+i;obj.options.nestedHeaders[0].colspan=w,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",w)}obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:i,insertBefore:o,columns:r,headers:d,colgroup:p,records:h,footers:b,data:f}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,i,h,o)}},obj.deleteColumn=function(e,t){if(1==obj.options.allowDeleteColumn)if(obj.headers.length>1){if(void 0==e){var o=obj.getSelectedColumns(!0);o.length?(e=parseInt(o[0]),t=parseInt(o.length)):(e=obj.headers.length-1,t=1)}var r=obj.options.data[0].length-1;if((void 0==e||e>r||e<0)&&(e=r),t||(t=1),t>obj.options.data[0].length-e&&(t=obj.options.data[0].length-e),!1===obj.dispatch("onbeforedeletecolumn",el,e,t))return console.log("onbeforedeletecolumn returned false"),!1;if(parseInt(e)>-1){var n=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var i=e;i<e+t;i++)obj.isColMerged(i,!1).length&&(n=!0);if(n){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var s=obj.options.columns.splice(e,t);for(i=e;i<e+t;i++)obj.colgroup[i].className="",obj.headers[i].className="",obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]),obj.headers[i].parentNode.removeChild(obj.headers[i]);for(var a=obj.headers.splice(e,t),l=obj.colgroup.splice(e,t),u=[],c=[],d=[],p=0;p<obj.options.data.length;p++)for(i=e;i<e+t;i++)obj.records[p][i].className="",obj.records[p][i].parentNode.removeChild(obj.records[p][i]);for(p=0;p<obj.options.data.length;p++)c[p]=obj.options.data[p].splice(e,t),u[p]=obj.records[p].splice(e,t);if(obj.options.footers)for(p=0;p<obj.options.footers.length;p++)d[p]=obj.options.footers[p].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var h=0;h<obj.options.nestedHeaders.length;h++){var f=parseInt(obj.options.nestedHeaders[h][obj.options.nestedHeaders[h].length-1].colspan)-t;obj.options.nestedHeaders[h][obj.options.nestedHeaders[h].length-1].colspan=f,obj.thead.children[h].children[obj.thead.children[h].children.length-1].setAttribute("colspan",f)}else{f=parseInt(obj.options.nestedHeaders[0].colspan)-t;obj.options.nestedHeaders[0].colspan=f,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",f)}obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:s,headers:a,colgroup:l,records:u,footers:d,data:c}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,u)}}else console.error("JEXCEL. It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],o=0;o<obj.rows.length;o++)obj.rows[o].classList.contains("selected")&&(e?t.push(o):t.push(obj.rows[o]));return t},obj.getSelectedColumns=function(){for(var e=[],t=0;t<obj.headers.length;t++)obj.headers[t].classList.contains("selected")&&e.push(t);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++){var t=obj.headers[e].getAttribute("data-x");t!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)))}for(var o=0;o<obj.rows.length;o++)if(obj.rows[o]){var r=obj.rows[o].getAttribute("data-y");r!=o&&(obj.rows[o].setAttribute("data-y",o),obj.rows[o].children[0].setAttribute("data-y",o),obj.rows[o].children[0].innerHTML=o+1)}var n=[],i=[],s=function(e,t,o,r){if(e!=o&&obj.records[r][o].setAttribute("data-x",o),t!=r&&obj.records[r][o].setAttribute("data-y",r),e!=o||t!=r){var i=jexcel.getColumnNameFromId([e,t]),s=jexcel.getColumnNameFromId([o,r]);n[i]=s}};for(o=0;o<obj.records.length;o++)for(e=0;e<obj.records[0].length;e++)if(obj.records[o][e]){t=obj.records[o][e].getAttribute("data-x"),r=obj.records[o][e].getAttribute("data-y");if(obj.records[o][e].getAttribute("data-merged")){var a=jexcel.getColumnNameFromId([t,r]),l=jexcel.getColumnNameFromId([e,o]);if(null==i[a])if(a==l)i[a]=!1;else{var u=parseInt(e-t),c=parseInt(o-r);i[a]=[l,u,c]}}else s(t,r,e,o)}var d=Object.keys(i);if(d.length)for(e=0;e<d.length;e++)if(i[d[e]]){var p=jexcel.getIdFromColumnName(d[e],!0);t=p[0],r=p[1];s(t,r,t+i[d[e]][1],r+i[d[e]][2]);for(a=d[e],l=i[d[e]][0],o=0;o<obj.options.mergeCells[a][2].length;o++){t=parseInt(obj.options.mergeCells[a][2][o].getAttribute("data-x")),r=parseInt(obj.options.mergeCells[a][2][o].getAttribute("data-y"));obj.options.mergeCells[a][2][o].setAttribute("data-x",t+i[d[e]][1]),obj.options.mergeCells[a][2][o].setAttribute("data-y",r+i[d[e]][2])}obj.options.mergeCells[l]=obj.options.mergeCells[a],delete obj.options.mergeCells[a]}obj.updateFormulas(n),obj.updateMeta(n),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,t=obj.rows.length-1;t>=0;t--){for(var o=!1,r=0;r<obj.headers.length;r++)obj.options.data[t][r]&&(o=!0);if(o)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var n=0;for(r=obj.headers.length-1;r>=0;r--){for(o=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][r]&&(o=!0);if(o)break;n++}obj.options.minSpareCols-n>0&&obj.insertColumn(obj.options.minSpareCols-n)}if("function"==typeof obj.options.updateTable){obj.options.detachForUpdates&&el.removeChild(obj.content);for(t=0;t<obj.rows.length;t++)for(r=0;r<obj.headers.length;r++)obj.options.updateTable(el,obj.records[t][r],r,t,obj.options.data[t][r],obj.records[t][r].innerText,jexcel.getColumnNameFromId([r,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout((function(){obj.updateCornerPosition()}),0)},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="";for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display=""},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none";for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none"},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,t,o){var r=jexcel.getColumnNameFromId([e,t]);if(obj.formula[r]&&obj.formula[r].length>0)if(chainLoopProtection[r])obj.records[t][e].innerHTML="#ERROR",obj.formula[r]="";else{chainLoopProtection[r]=!0;for(var n=0;n<obj.formula[r].length;n++){var i=jexcel.getIdFromColumnName(obj.formula[r][n],!0),s=""+obj.options.data[i[1]][i[0]];"="==s.substr(0,1)?o.push(obj.updateCell(i[0],i[1],s,!0)):Object.keys(obj.formula)[n]=null,obj.updateFormulaChain(i[0],i[1],o)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t=0;t<obj.options.data.length;t++)for(var o=0;o<obj.options.data[0].length;o++){var r=""+obj.options.data[t][o];if("="==r.substr(0,1)){var n=obj.updateFormula(r,e);n!=r&&(obj.options.data[t][o]=n)}}var i=[],s=Object.keys(obj.formula);for(t=0;t<s.length;t++){var a=s[t];r=obj.formula[a];e[a]&&(a=e[a]),i[a]=[];for(o=0;o<r.length;o++){var l=r[o];e[l]&&(l=e[l]),i[a].push(l)}}obj.formula=i},obj.updateFormula=function(e,t){for(var o=/[A-Z]/,r=/[0-9]/,n="",i=null,s=null,a="",l=0;l<e.length;l++)o.exec(e[l])?(i=1,s=0,a+=e[l]):r.exec(e[l])?(s=i?1:0,a+=e[l]):(i&&s&&(a=t[a]?t[a]:a),n+=a,n+=e[l],i=0,s=0,a="");return a&&(i&&s&&(a=t[a]?t[a]:a),n+=a),n};var secureFormula=function(e){for(var t="",o=0,r=0;r<e.length;r++)'"'==e[r]&&(o=0==o?1:0),t+=1==o?e[r]:e[r].toUpperCase();return t};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var o=[],r=e[t].split(":"),n=jexcel.getIdFromColumnName(r[0],!0),i=jexcel.getIdFromColumnName(r[1],!0);if(n[0]<=i[0])var s=n[0],a=i[0];else s=i[0],a=n[0];if(n[1]<=i[1])var l=n[1],u=i[1];else l=i[1],u=n[1];for(var c=l;c<=u;c++)for(var d=s;d<=a;d++)o.push(jexcel.getColumnNameFromId([d,c]));expression=expression.replace(e[t],o.join(","))}},tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var evalstring="",tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if("undefined"!=typeof obj.options.data[position[1]]&&"undefined"!=typeof obj.options.data[position[1]][position[0]])var value=obj.options.data[position[1]][position[0]];else var value="";if("="==(""+value).substr(0,1)&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())evalstring+="var "+tokens[i]+" = null;";else if(value==Number(value)&&1==obj.options.autoCasting)evalstring+="var "+tokens[i]+" = "+Number(value)+";";else{var number=obj.parseNumber(value,position[0]);1==obj.options.autoCasting&&number?evalstring+="var "+tokens[i]+" = "+number+";":evalstring+="var "+tokens[i]+" = '"+value+"';"}}try{evalstring+="function COLUMN() { return parseInt(x) + 1; }; function ROW() { return parseInt(y) + 1; }; function CELL() { return parentId; }; function TABLE() { return obj; }; function VALUE(col, row) { return obj.records[row-1][col-1].innerHTML; }; function THISROWCELL(col) { var id = jexcel.getIdFromColumnName(col+(parseInt(y)+1), true); return obj.records[id[1]][id[0]].innerHTML; }";var res=eval(evalstring+expression.substr(1))}catch(e){var res="#ERROR"}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var o=t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:".",r=""+e;if(r=r.split(o),r[0]=r[0].match(/[+-]?[0-9]/g),r[0]&&(r[0]=r[0].join("")),r[1]&&(r[1]=r[1].match(/[0-9]*/g).join("")),r[0]&&Number(r[0])>=0)if(r[1])e=Number(r[0]+"."+r[1]);else var e=Number(r[0]+".00");else e=null;return e},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,t?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)if(0==obj.selectedCell[1]||0==obj.selectedCell[3])obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-o<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var r=obj.whichPage(obj.selectedCell[3]);r!=obj.pageNumber&&obj.page(r)}obj.updateScroll(1)},obj.up.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(0==t){for(var n=0;n<r;n++)if("none"!=obj.records[n][o].style.display&&"none"!=obj.rows[n].style.display){r=n;break}}else r=obj.up.get(o,r);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=r):(obj.selectedCell[2]=o,obj.selectedCell[3]=r)},obj.up.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var o=t-1;o>=0;o--)if("none"!=obj.records[o][e].style.display&&"none"!=obj.rows[o].style.display){if(obj.records[o][e].getAttribute("data-merged")&&obj.records[o][e]==obj.records[t][e])continue;t=o;break}return t},obj.down=function(e,t){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)if(obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1)obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var o=parseInt(obj.tbody.lastChild.getAttribute("data-y"));o-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var r=obj.whichPage(obj.selectedCell[3]);r!=obj.pageNumber&&obj.page(r)}obj.updateScroll(3)},obj.down.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(0==t){for(var n=obj.rows.length-1;n>r;n--)if("none"!=obj.records[n][o].style.display&&"none"!=obj.rows[n].style.display){r=n;break}}else r=obj.down.get(o,r);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=r):(obj.selectedCell[2]=o,obj.selectedCell[3]=r)},obj.down.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var o=t+1;o<obj.rows.length;o++)if("none"!=obj.records[o][e].style.display&&"none"!=obj.rows[o].style.display){if(obj.records[o][e].getAttribute("data-merged")&&obj.records[o][e]==obj.records[t][e])continue;t=o;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(0==t){for(var n=obj.headers.length-1;n>o;n--)if("none"!=obj.records[r][n].style.display){o=n;break}}else o=obj.right.get(o,r);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=r):(obj.selectedCell[2]=o,obj.selectedCell[3]=r)},obj.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var o=e+1;o<obj.headers.length;o++)if("none"!=obj.records[t][o].style.display){if(obj.records[t][o].getAttribute("data-merged")&&obj.records[t][o]==obj.records[t][e])continue;e=o;break}return e},obj.left=function(e,t){e?obj.selectedCell[2]>0&&obj.left.visible(1,t?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(0==t){for(var n=0;n<o;n++)if("none"!=obj.records[r][n].style.display){o=n;break}}else o=obj.left.get(o,r);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=r):(obj.selectedCell[2]=o,obj.selectedCell[3]=r)},obj.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var o=e-1;o>=0;o--)if("none"!=obj.records[t][o].style.display){if(obj.records[t][o].getAttribute("data-merged")&&obj.records[t][o]==obj.records[t][e])continue;e=o;break}return e},obj.first=function(e,t){if(e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]){if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){if(e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(1==obj.options.search&&obj.results)var t=obj.results;else t=obj.rows;var o=100;null!=e&&-1!=e||(e=Math.ceil(t.length/o));var r=e*o,n=e*o+o;n>t.length&&(n=t.length),r=n-100,r<0&&(r=0);for(var i=r;i<n;i++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[t[i]]):obj.tbody.appendChild(obj.rows[i]),obj.tbody.children.length>o&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(1==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var t=0;if(e.length>100){var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(o=e.indexOf(o)),o>0)for(var r=0;r<30;r++)o-=1,o>-1&&(1==obj.options.search&&obj.results?obj.tbody.insertBefore(obj.rows[e[o]],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[o],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1))}return t},obj.loadDown=function(){if(1==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var t=0;if(e.length>100){var o=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(o=e.indexOf(o)),o<obj.rows.length-1)for(var r=0;r<=30;r++)o<e.length&&(1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[e[o]]):obj.tbody.appendChild(obj.rows[o]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1)),o+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),o=parseInt(obj.rows.length/100);if(e!=t&&t<=o&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(e)e=e.toLowerCase();if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var t=function(e,t,o){for(var r=0;r<e.length;r++)if((""+e[r]).toLowerCase().search(t)>=0||(""+obj.records[o][r].innerHTML).toLowerCase().search(t)>=0)return!0;return!1},o=function(e){-1==obj.results.indexOf(e)&&obj.results.push(e)};obj.options.data.filter((function(r,n){if(t(r,e,n)){var i=obj.isRowMerged(n);if(i.length)for(var s=0;s<i.length;s++)for(var a=jexcel.getIdFromColumnName(i[s],!0),l=0;l<obj.options.mergeCells[i[s]][1];l++)o(a[1]+l);else o(n);return!0}return!1}))}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e=0,t=0;e=1==obj.options.lazyLoading?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;while(obj.tbody.firstChild)obj.tbody.removeChild(obj.tbody.firstChild);for(var o=0;o<obj.rows.length;o++)!obj.results||obj.results.indexOf(o)>-1?(t<e&&(obj.tbody.appendChild(obj.rows[o]),t++),obj.rows[o].style.display=""):obj.rows[o].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return 1==obj.options.search&&obj.results&&(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t=obj.pageNumber;if(1==obj.options.search&&obj.results)var o=obj.results;else o=obj.rows;var r=parseInt(obj.options.pagination);null!=e&&-1!=e||(e=Math.ceil(o.length/r)),obj.pageNumber=e;var n=e*r,i=e*r+r;i>o.length&&(i=o.length),n<0&&(n=0);while(obj.tbody.firstChild)obj.tbody.removeChild(obj.tbody.firstChild);for(var s=n;s<i;s++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[o[s]]):obj.tbody.appendChild(obj.rows[s]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,t)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(1==obj.options.search&&obj.results)var e=obj.results.length;else e=obj.rows.length;if(e){var t=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var o=1,r=t<10?t:10;else if(t-obj.pageNumber<5){o=t-9,r=t;o<1&&(o=1)}else o=obj.pageNumber-4,r=obj.pageNumber+5;if(o>1){var n=document.createElement("div");n.className="jexcel_page",n.innerHTML="<",n.title=1,obj.pagination.children[1].appendChild(n)}for(var i=o;i<=r;i++){n=document.createElement("div");n.className="jexcel_page",n.innerHTML=i,obj.pagination.children[1].appendChild(n),obj.pageNumber==i-1&&n.classList.add("jexcel_page_selected")}if(r<t){n=document.createElement("div");n.className="jexcel_page",n.innerHTML=">",n.title=t,obj.pagination.children[1].appendChild(n)}var s=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,o){return"undefined"!=typeof t[o]?t[o]:e}))};obj.pagination.children[0].innerHTML=s(obj.options.text.showingPage,obj.pageNumber+1,t)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(0==obj.options.allowExport)console.error("Export not allowed");else{var t="";1!=e&&1!=obj.options.includeHeadersOnDownload||(t+=obj.getHeaders(),t+="\r\n"),t+=obj.copy(!1,obj.options.csvDelimiter,!0);var o=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,obj.options.csvFileName+".csv");else{var r=document.createElement("a"),n=URL.createObjectURL(o);r.href=n,r.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r)}}},obj.setHistory=function(e){if(1!=obj.ignoreHistory){var t=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,t+1),obj.history[t]=e}},obj.copy=function(e,t,o){t||(t="\t");var r=[],n=[],i=[],s=[],a=obj.options.data[0].length,l=obj.options.data.length,u="";1==obj.options.includeHeadersOnCopy&&(1==obj.options.copyCompatibility?b.push(obj.getHeaders(!0).join(t)):f.push(obj.getHeaders(!0).join(t))),obj.style=[];for(var c=0;c<l;c++){r=[],n=[];for(var d=0;d<a;d++)if(!e||obj.records[c][d].classList.contains("highlight")){var p=obj.options.data[c][d];if(p.match&&(p.match(/,/g)||p.match(/\n/)||p.match(/\"/))&&(p=p.replace(new RegExp('"',"g"),'""'),p='"'+p+'"'),r.push(p),"checkbox"==obj.options.columns[d].type||"radio"==obj.options.columns[d].type)var h=p;else{h=obj.records[c][d].innerHTML;h.match&&(h.match(/,/g)||h.match(/\n/)||h.match(/\"/))&&(h=h.replace(new RegExp('"',"g"),'""'),h='"'+h+'"')}n.push(h),u=obj.records[c][d].getAttribute("style"),u=u.replace("display: none;",""),obj.style.push(u||"")}r.length&&i.push(r.join(t)),n.length&&s.push(n.join(t))}var f=i.join("\r\n"),b=s.join("\r\n");if(o||(1==obj.options.copyCompatibility?obj.textarea.value=b:obj.textarea.value=f,obj.textarea.select(),document.execCommand("copy")),1==obj.options.copyCompatibility?obj.data=b:obj.data=f,obj.hashString=obj.hash(obj.data),obj.removeCopyingSelection(),obj.highlighted)for(d=0;d<obj.highlighted.length;d++)obj.highlighted[d].classList.add("copying"),obj.highlighted[d].classList.contains("highlight-left")&&obj.highlighted[d].classList.add("copying-left"),obj.highlighted[d].classList.contains("highlight-right")&&obj.highlighted[d].classList.add("copying-right"),obj.highlighted[d].classList.contains("highlight-top")&&obj.highlighted[d].classList.add("copying-top"),obj.highlighted[d].classList.contains("highlight-bottom")&&obj.highlighted[d].classList.add("copying-bottom");return obj.dispatch("oncopy",el,1==obj.options.copyCompatibility?s:i,obj.hashString),obj.data},obj.paste=function(e,t,o){var r=obj.dispatch("onbeforepaste",el,o,e,t);if(!1===r)return!1;if(r)o=r;var n=obj.hash(o),i=n==obj.hashString?obj.style:null;if(1==obj.options.copyCompatibility&&n==obj.hashString)o=obj.data;o=obj.parseCSV(o,"\t");if(null!=e&&null!=t&&o){var s=0,a=0,l=[],u={},c={},d=0,p=parseInt(e),h=parseInt(t),f=null;while(f=o[a]){s=0,p=parseInt(e);while(null!=f[s]){var b=obj.updateCell(p,h,f[s]);if(l.push(b),obj.updateFormulaChain(p,h,l),i&&i[d]){var m=jexcel.getColumnNameFromId([p,h]);u[m]=i[d],c[m]=obj.getStyle(m),obj.records[h][p].setAttribute("style",i[d]),d++}s++,null!=f[s]&&(p>=obj.headers.length-1&&obj.insertColumn(),p=obj.right.get(p,h))}a++,o[a]&&(h>=obj.rows.length-1&&obj.insertRow(),h=obj.down.get(e,h))}obj.updateSelectionFromCoords(e,t,p,h),obj.setHistory({action:"setValue",records:l,selection:obj.selectedCell,newStyle:u,oldStyle:c}),obj.updateTable(),obj.dispatch("onpaste",el,o),obj.onafterchanges(el,l)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var o=t.insertBefore?t.rowNumber:t.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==e){for(var r=t.numOfRows,n=o;n<r+o;n++)obj.rows[n].parentNode.removeChild(obj.rows[n]);obj.records.splice(o,r),obj.options.data.splice(o,r),obj.rows.splice(o,r),obj.conditionalSelectionUpdate(1,o,r+o-1)}else{obj.records=jexcel.injectArray(obj.records,o,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,o,t.rowData),obj.rows=jexcel.injectArray(obj.rows,o,t.rowNode);var i=0;for(n=o;n<t.numOfRows+o;n++)obj.tbody.insertBefore(t.rowNode[i],obj.tbody.children[n]),i++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var o=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var r=t.numOfColumns;obj.options.columns.splice(o,r);for(var n=o;n<r+o;n++)obj.headers[n].parentNode.removeChild(obj.headers[n]),obj.colgroup[n].parentNode.removeChild(obj.colgroup[n]);obj.headers.splice(o,r),obj.colgroup.splice(o,r);for(var i=0;i<t.data.length;i++){for(n=o;n<r+o;n++)obj.records[i][n].parentNode.removeChild(obj.records[i][n]);obj.records[i].splice(o,r),obj.options.data[i].splice(o,r)}if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i].splice(o,r)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,o,t.columns),obj.headers=jexcel.injectArray(obj.headers,o,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,o,t.colgroup);var s=0;for(n=o;n<t.numOfColumns+o;n++)obj.headerContainer.insertBefore(t.headers[s],obj.headerContainer.children[n+1]),obj.colgroupContainer.insertBefore(t.colgroup[s],obj.colgroupContainer.children[n+1]),s++;for(i=0;i<t.data.length;i++){obj.options.data[i]=jexcel.injectArray(obj.options.data[i],o,t.data[i]),obj.records[i]=jexcel.injectArray(obj.records[i],o,t.records[i]);for(s=0,n=o;n<t.numOfColumns+o;n++)obj.rows[i].insertBefore(t.records[i][s],obj.rows[i].children[n+1]),s++}if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i]=jexcel.injectArray(obj.options.footers[i],o,t.footers[i])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(i=0;i<obj.options.nestedHeaders.length;i++){if(1==e)var a=parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)-t.numOfColumns;else a=parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)+t.numOfColumns;obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan=a,obj.thead.children[i].children[obj.thead.children[i].children.length-1].setAttribute("colspan",a)}else{if(1==e)a=parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns;else a=parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns;obj.options.nestedHeaders[0].colspan=a,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",a)}obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var o=[];if(obj.historyIndex>=0){var r=obj.history[obj.historyIndex--];if("insertRow"==r.action)obj.historyProcessRow(1,r);else if("deleteRow"==r.action)obj.historyProcessRow(0,r);else if("insertColumn"==r.action)obj.historyProcessColumn(1,r);else if("deleteColumn"==r.action)obj.historyProcessColumn(0,r);else if("moveRow"==r.action)obj.moveRow(r.newValue,r.oldValue);else if("moveColumn"==r.action)obj.moveColumn(r.newValue,r.oldValue);else if("setMerge"==r.action)obj.removeMerge(r.column,r.data);else if("setStyle"==r.action)obj.setStyle(r.oldValue,null,null,1);else if("setWidth"==r.action)obj.setWidth(r.column,r.oldValue);else if("setHeight"==r.action)obj.setHeight(r.row,r.oldValue);else if("setHeader"==r.action)obj.setHeader(r.column,r.oldValue);else if("setComments"==r.action)obj.setComments(r.column,r.oldValue[0],r.oldValue[1]);else if("orderBy"==r.action){for(var n=[],i=0;i<r.rows.length;i++)n[r.rows[i]]=i;obj.updateOrderArrow(r.column,r.order?0:1),obj.updateOrder(n)}else if("setValue"==r.action){for(var s=0;s<r.records.length;s++)o.push({x:r.records[s].x,y:r.records[s].y,newValue:r.records[s].oldValue}),r.oldStyle&&obj.resetStyle(r.oldStyle);obj.setValue(o),r.selection&&obj.updateSelectionFromCoords(r.selection[0],r.selection[1],r.selection[2],r.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,r)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;if(obj.historyIndex<obj.history.length-1){var o=obj.history[++obj.historyIndex];if("insertRow"==o.action)obj.historyProcessRow(0,o);else if("deleteRow"==o.action)obj.historyProcessRow(1,o);else if("insertColumn"==o.action)obj.historyProcessColumn(0,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(1,o);else if("moveRow"==o.action)obj.moveRow(o.oldValue,o.newValue);else if("moveColumn"==o.action)obj.moveColumn(o.oldValue,o.newValue);else if("setMerge"==o.action)obj.setMerge(o.column,o.colspan,o.rowspan,1);else if("setStyle"==o.action)obj.setStyle(o.newValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.newValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.newValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.newValue);else if("setComments"==o.action)obj.setComments(o.column,o.newValue[0],o.newValue[1]);else if("orderBy"==o.action)obj.updateOrderArrow(o.column,o.order),obj.updateOrder(o.rows);else if("setValue"==o.action){obj.setValue(o.records);for(var r=0;r<o.records.length;r++)o.oldStyle&&obj.resetStyle(o.newStyle);o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,o)},obj.getDropDownValue=function(e,t){var o=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var r=[],n=obj.options.columns[e].source,i=0;i<n.length;i++)"object"==typeof n[i]?r[n[i].id]=n[i].name:r[n[i]]=n[i];var s=(""+t).split(";");for(i=0;i<s.length;i++)r[s[i]]&&o.push(r[s[i]])}else console.error("Invalid column");return o.length>0?o.join("; "):""},obj.parseCSV=function(e,t){e=e.replace(/\r?\n$|\r$|\n$/g,""),9==e.charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var o=[],r=!1,n=0,i=0,s=0;s<e.length;s++){var a=e[s],l=e[s+1];o[n]=o[n]||[],o[n][i]=o[n][i]||"",'"'==a&&r&&'"'==l?(o[n][i]+=a,++s):'"'!=a?a!=t||r?"\r"!=a||"\n"!=l||r?("\n"!=a||r)&&("\r"!=a||r)?o[n][i]+=a:(++n,i=0):(++n,i=0,++s):++i:r=!r}return o},obj.hash=function(e){var t,o,r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)o=e.charCodeAt(t),r=(r<<5)-r+o,r|=0;return r},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",(function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())})),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:"GET",dataType:"text",success:function(e){var t=obj.parseCSV(e,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&t.length>0)for(var o=t.shift(),r=0;r<o.length;r++)obj.options.columns[r]||(obj.options.columns[r]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),"undefined"===typeof obj.options.columns[r].title&&(obj.options.columns[r].title=o[r]);obj.options.data=t,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:"GET",dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},options&&null!=options.contextMenu?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,t,o,r){var n=[];if(null==o)1==obj.options.allowInsertColumn&&n.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),1==obj.options.allowInsertColumn&&n.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),1==obj.options.allowDeleteColumn&&n.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),1==obj.options.allowRenameColumn&&n.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),1==obj.options.columnSorting&&(n.push({type:"line"}),n.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),n.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}));else if(1==obj.options.allowInsertRow&&(n.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(o),1)}}),n.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(o))}})),1==obj.options.allowDeleteRow&&n.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(o))}}),t&&1==obj.options.allowComments){n.push({type:"line"});var i=obj.records[o][t].getAttribute("title")||"";n.push({title:i?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var e=prompt(obj.options.text.comments,i);e&&obj.setComments([t,o],e)}}),i&&n.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,o],"")}})}return n.push({type:"line"}),n.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&n.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then((function(e){e&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],e)}))}}),obj.options.allowExport&&n.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&n.push({title:obj.options.text.about,onclick:function(){alert(obj.options.about)}}),n},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),1!=obj.options.lazyLoading&&1!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=e.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout((function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null}),100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var t=0;t<obj.options.freezeColumns;t++)e+=parseInt(obj.options.columns[t].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){scrollLeft=obj.content.scrollLeft;var e=0;if(scrollLeft>50)for(var t=0;t<obj.options.freezeColumns;t++){t>0&&(e+=parseInt(obj.options.columns[t-1].width)),obj.headers[t].classList.add("jexcel_freezed"),obj.headers[t].style.left=e+"px";for(var o=0;o<obj.rows.length;o++)if(obj.rows[o]&&obj.records[o][t]){var r=scrollLeft+(t>0?obj.records[o][t-1].style.width:0)-51+"px";obj.records[o][t].classList.add("jexcel_freezed"),obj.records[o][t].style.left=r}}else for(t=0;t<obj.options.freezeColumns;t++){obj.headers[t].classList.remove("jexcel_freezed"),obj.headers[t].style.left="";for(o=0;o<obj.rows.length;o++)obj.records[o][t]&&(obj.records[o][t].classList.remove("jexcel_freezed"),obj.records[o][t].style.left="")}obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,obj.init(),obj};jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null,jexcel.destroy=function(e,t){if(e.jexcel){var o=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(o.removeEventListener("mouseup",jexcel.mouseUpControls),o.removeEventListener("mousedown",jexcel.mouseDownControls),o.removeEventListener("mousemove",jexcel.mouseMoveControls),o.removeEventListener("mouseover",jexcel.mouseOverControls),o.removeEventListener("dblclick",jexcel.doubleClickControls),o.removeEventListener("paste",jexcel.pasteControls),o.removeEventListener("contextmenu",jexcel.contextMenuControls),o.removeEventListener("touchstart",jexcel.touchStartControls),o.removeEventListener("touchend",jexcel.touchEndControls),o.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls),jexcel=null)}},jexcel.build=function(e){e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(27==e.which)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(13==e.which)if("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if("dropdown"==jexcel.current.options.columns[jexcel.current.edition[2]].type||"autocomplete"==jexcel.current.options.columns[jexcel.current.edition[2]].type);else if((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var t=jexcel.current.edition[0].children[0],o=jexcel.current.edition[0].children[0].value,r=t.selectionStart;o=o.slice(0,r)+"\n"+o.slice(r),t.value=o,t.focus(),t.selectionStart=r+1,t.selectionEnd=r+1}else jexcel.current.edition[0].children[0].blur();else 9==e.which&&("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(37==e.which)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(39==e.which)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(38==e.which)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(40==e.which)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(36==e.which)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(35==e.which)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(32==e.which)1==jexcel.current.options.editable&&jexcel.current.setCheckRadioValue(),e.preventDefault();else if(46==e.which)1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(13==e.which)e.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(9==e.which)e.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&1==jexcel.current.options.editable){var n=jexcel.current.selectedCell[1],i=jexcel.current.selectedCell[0];"readonly"!=jexcel.current.options.columns[i].type&&(32==e.keyCode?"checkbox"==jexcel.current.options.columns[i].type||"radio"==jexcel.current.options.columns[i].type?e.preventDefault():jexcel.current.openEditor(jexcel.current.records[n][i],!0):113==e.keyCode?jexcel.current.openEditor(jexcel.current.records[n][i],!1):(8==e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||187==e.keyCode||189==e.keyCode||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[n][i],!0),"calendar"==jexcel.current.options.columns[i].type&&e.preventDefault()))}}else 65==e.which?(jexcel.current.selectAll(),e.preventDefault()):83==e.which?(jexcel.current.download(),e.preventDefault()):89==e.which?(jexcel.current.redo(),e.preventDefault()):90==e.which?(jexcel.current.undo(),e.preventDefault()):67==e.which||67==e.which?(jexcel.current.copy(!0),e.preventDefault()):88==e.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):86==e.which&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout((function(){jexcel.current.search(e.target.value)}),200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if(e=e||window.event,e.buttons)var t=e.buttons;else if(e.button)t=e.button;else t=e.which;var o=jexcel.getElement(e.target);if(o[0]?jexcel.current!=o[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=o[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==t){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(1==o[1]){var r=e.target.getAttribute("data-x");if(r){var n=e.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&n.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:r,width:n.width},jexcel.current.headers[r].classList.add("resizing");for(var i=0;i<jexcel.current.records.length;i++)jexcel.current.records[i][r]&&jexcel.current.records[i][r].classList.add("resizing")}else if(1==jexcel.current.options.columnDrag&&n.height-e.offsetY<6)if(jexcel.current.isColMerged(r).length)console.error("JEXCEL: This column is part of a merged cell.");else{jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:r,destination:r},jexcel.current.headers[r].classList.add("dragging");for(i=0;i<jexcel.current.records.length;i++)jexcel.current.records[i][r]&&jexcel.current.records[i][r].classList.add("dragging")}else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var s=jexcel.current.selectedHeader,a=r;else{jexcel.current.selectedHeader==r&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout((function(){jexcel.current.setHeader(r)}),800)),jexcel.current.selectedHeader=r;s=r,a=r}jexcel.current.updateSelectionFromCoords(s,0,a,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var l=e.target.getAttribute("data-column").split(","),u=parseInt(l[0]),c=parseInt(l[l.length-1]);else u=0,c=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(u,0,c,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(2==o[1]){var d=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row")){n=e.target.getBoundingClientRect();if(1==jexcel.current.options.rowResize&&n.height-e.offsetY<6)jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:d,height:n.height},e.target.parentNode.classList.add("resizing");else if(1==jexcel.current.options.rowDrag&&n.width-e.offsetX<6)jexcel.current.isRowMerged(d).length?console.error("JEXCEL: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("JEXCEL: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:d,destination:d},e.target.parentNode.classList.add("dragging"));else{if(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey))s=jexcel.current.selectedRow,a=d;else{jexcel.current.selectedRow=d;s=d,a=d}jexcel.current.updateSelectionFromCoords(0,s,jexcel.current.options.data[0].length-1,a)}}else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var p=function(e){var t=e.getAttribute("data-x"),o=e.getAttribute("data-y");return t&&o?[t,o]:e.parentNode?p(e.parentNode):void 0},h=p(e.target);if(h){r=h[0],d=h[1];jexcel.current.edition&&(jexcel.current.edition[2]==r&&jexcel.current.edition[3]==d||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],r,d):jexcel.current.updateSelectionFromCoords(r,d)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&("<"==e.target.innerText?jexcel.current.page(0):">"==e.target.innerText?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.innerText-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),o=jexcel.current.getSelectedColumns();if(o.length>1){for(var r=[],n=0;n<o.length;n++)r.push(parseInt(jexcel.current.colgroup[o[n]].getAttribute("width")));var i=o.indexOf(parseInt(jexcel.current.resizing.column));r[i]=jexcel.current.resizing.width,jexcel.current.setWidth(o,t,r)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var s=0;s<jexcel.current.records.length;s++)jexcel.current.records[s][jexcel.current.resizing.column]&&jexcel.current.records[s][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var a=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,a,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var l=e.target.getAttribute("data-x");jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging");for(s=0;s<jexcel.current.rows.length;s++)jexcel.current.records[s][jexcel.current.dragging.column]&&jexcel.current.records[s][jexcel.current.dragging.column].classList.remove("dragging");for(n=0;n<jexcel.current.headers.length;n++)jexcel.current.headers[n].classList.remove("dragging-left"),jexcel.current.headers[n].classList.remove("dragging-right");l&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var u=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<u&&(u-=1)}else u=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=u&&jexcel.current.moveRow(jexcel.current.dragging.row,u,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if(e=e||window.event,e.buttons)var t=e.buttons;else if(e.button)t=e.button;else t=e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current)if(1==jexcel.isMouseAction){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var o=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+o>0){var r=jexcel.current.resizing.width+o;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",r),jexcel.current.updateCornerPosition()}}else{var n=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+n>0){var i=jexcel.current.resizing.height+n;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",i),jexcel.current.updateCornerPosition()}}}else{var s=e.target.getAttribute("data-x"),a=e.target.getAttribute("data-y"),l=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&s&&!a&&l.width-(e.clientX-l.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!s&&a&&l.height-(e.clientY-l.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!s&&a&&l.width-(e.clientX-l.left)<6||e.target&&s&&!a&&l.height-(e.clientY-l.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if(e=e||window.event,e.buttons)var t=e.buttons;else if(e.button)t=e.button;else t=e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){var o=jexcel.getElement(e.target);if(o[0]){if(jexcel.current!=o[0].jexcel&&jexcel.current)return!1;var r=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y");if(jexcel.current.dragging){if(jexcel.current.dragging.column){if(r)if(jexcel.current.isColMerged(r).length)console.error("JEXCEL: This column is part of a merged cell.");else{for(var i=0;i<jexcel.current.headers.length;i++)jexcel.current.headers[i].classList.remove("dragging-left"),jexcel.current.headers[i].classList.remove("dragging-right");jexcel.current.dragging.column==r?jexcel.current.dragging.destination=parseInt(r):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<r?jexcel.current.dragging.destination=parseInt(r)-1:jexcel.current.dragging.destination=parseInt(r),jexcel.current.headers[r].classList.add("dragging-left")):(jexcel.current.dragging.column<r?jexcel.current.dragging.destination=parseInt(r):jexcel.current.dragging.destination=parseInt(r)+1,jexcel.current.headers[r].classList.add("dragging-right"))}}else if(n)if(jexcel.current.isRowMerged(n).length)console.error("JEXCEL: This row is part of a merged cell.");else{var s=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,s)}}else if(jexcel.current.resizing);else{if(1==o[1]&&jexcel.current.selectedHeader){r=e.target.getAttribute("data-x");var a=jexcel.current.selectedHeader,l=r;jexcel.current.updateSelectionFromCoords(a,0,l,jexcel.current.options.data.length-1)}if(2==o[1])if(e.target.classList.contains("jexcel_row")){if(jexcel.current.selectedRow){a=jexcel.current.selectedRow,l=n;jexcel.current.updateSelectionFromCoords(0,a,jexcel.current.options.data[0].length-1,l)}}else jexcel.current.edition||r&&n&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(r,n):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],r,n))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var t=jexcel.current.highlighted[0].getAttribute("data-x"),o=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,r=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),n=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[o][t],jexcel.current.records[n][r])}}else if(e.target.classList.contains("jexcel_column_filter")){var i=e.target.getAttribute("data-x");jexcel.current.openFilter(i)}else{var s=jexcel.getElement(e.target);if(1==s[1]&&1==jexcel.current.options.columnSorting){i=e.target.getAttribute("data-x");i&&jexcel.current.orderBy(i)}if(2==s[1]&&1==jexcel.current.options.editable&&!jexcel.current.edition){var a=function(e){if(e.parentNode){var t=e.getAttribute("data-x"),o=e.getAttribute("data-y");return t&&o?e:a(e.parentNode)}},l=a(e.target);l&&l.classList.contains("highlight")&&jexcel.current.openEditor(l)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if(e=e||window.event,"buttons"in e)e.buttons;else e.which||e.button;if(jexcel.current)if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var t=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y");if(t||o){var r=jexcel.current.options.contextMenu(jexcel.current,t,o,e);jexcel.current.contextMenu.contextmenu.open(e,r),e.preventDefault()}}},jexcel.touchStartControls=function(e){var t=jexcel.getElement(e.target);if(t[0]?jexcel.current!=t[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=t[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var o=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");o&&r&&(jexcel.current.updateSelectionFromCoords(o,r),jexcel.timeControl=setTimeout((function(){"color"==jexcel.current.options.columns[o].type?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)}),500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){var o=[];if(e.classList.contains("jexcel_tabs"))n=e.children[0],i=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var r=document.createElement("div"),n=e.appendChild(r),i=(r=document.createElement("div"),e.appendChild(r))}for(var s=[],a=[],l=0;l<t.length;l++){s[l]=document.createElement("div"),s[l].classList.add("jexcel_tab");var u=jexcel(s[l],t[l]);i.appendChild(s[l]),o[l]=e.jexcel.push(u),a[l]=document.createElement("div"),a[l].classList.add("jexcel_tab_link"),a[l].setAttribute("data-spreadsheet",e.jexcel.length-1),a[l].innerHTML=t[l].sheetName,a[l].onclick=function(){for(var e=0;e<n.children.length;e++)n.children[e].classList.remove("selected"),i.children[e].style.display="none";var t=this.getAttribute("data-spreadsheet");i.children[t].style.display="block",n.children[t].classList.add("selected")},n.appendChild(a[l])}for(var c=0;c<n.children.length;c++)n.children[c].classList.remove("selected"),i.children[c].style.display="none";return n.children[n.children.length-1].classList.add("selected"),i.children[n.children.length-1].style.display="block",o},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,t){var o,r=function(e){var t=[];return e.SheetNames.forEach((function(o){var r={rows:[],columns:[],data:[],style:{}};r.sheetName=o;var n=e.Sheets[o]["!cols"];if(n&&n.length)for(var i=0;i<n.length;i++)r.columns[i]={},n[i]&&n[i].wpx&&(r.columns[i].width=n[i].wpx+"px");n=e.Sheets[o]["!rows"];if(n&&n.length)for(i=0;i<n.length;i++)n[i]&&n[i].hpx&&(r.rows[i]={},r.rows[i].height=n[i].hpx+"px");n=e.Sheets[o]["!merges"];if(n&&n.length>0){r.mergeCells=[];for(i=0;i<n.length;i++){var s=n[i].s.c,a=n[i].s.r,l=n[i].e.c,u=n[i].e.r,c=jexcel.getColumnNameFromId([s,a]);r.mergeCells[c]=[l-s+1,u-a+1]}}var d=0,p=0;for(n=Object.keys(e.Sheets[o]),i=0;i<n.length;i++)if("!"!=n[i].substr(0,1)){var h=e.Sheets[o][n[i]],f=jexcel.getIdFromColumnName(n[i],!0);r.data[f[1]]||(r.data[f[1]]=[]),r.data[f[1]][f[0]]=h.f?"="+h.f:h.w,d<f[0]&&(d=f[0]),p<f[1]&&(p=f[1]),h.style&&Object.keys(h.style).length>0&&(r.style[n[i]]=h.style),h.s&&h.s.fgColor&&(r.style[n[i]]&&(r.style[n[i]]+=";"),r.style[n[i]]+="background-color:#"+h.s.fgColor.rgb)}for(var b=r.columns,m=0;m<=p;m++)for(i=0;i<=d;i++)r.data[m]||(r.data[m]=[]),r.data[m][i]||b<i&&(r.data[m][i]="");t.push(r)})),t};o=new XMLHttpRequest,o.open("GET",e,!0),"undefined"!==typeof Uint8Array?(o.responseType="arraybuffer",o.onload=function(e){var n=o.response,i=new Uint8Array(n),s=XLSX.read(i,{type:"array",cellFormula:!0,cellStyles:!0});t(r(s))}):(o.setRequestHeader("Accept-Charset","x-user-defined"),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var e=convertResponseBodyToText(o.responseBody),n=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0});t(r(n))}}),o.send()},jexcel.validLetter=function(e){var t=/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g;return e.match(t)?1:0},jexcel.injectArray=function(e,t,o){return e.slice(0,t).concat(o).concat(e.slice(t))},jexcel.getColumnName=function(e){var t="";return e>701?(t+=String.fromCharCode(64+parseInt(e/676)),t+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(t+=String.fromCharCode(64+parseInt(e/26))),t+=String.fromCharCode(65+e%26),t},jexcel.getIdFromColumnName=function(e,t){var o=/^[a-zA-Z]+/.exec(e);if(o){for(var r=0,n=0;n<o[0].length;n++)r+=parseInt(o[0].charCodeAt(n)-64)*Math.pow(26,o[0].length-1-n);r--,r<0&&(r=0);var i=parseInt(/[0-9]+$/.exec(e));i>0&&i--,e=1==t?[r,i]:r+"-"+i}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var t=0,o=0;function r(e){e.className&&e.classList.contains("jexcel_container")&&(o=e),"THEAD"==e.tagName?t=1:"TBODY"==e.tagName&&(t=2),e.parentNode&&(o||r(e.parentNode))}return r(e),[o,t]},jexcel.doubleDigitFormat=function(e){return e=""+e,1==e.length&&(e="0"+e),e},jexcel.createFromTable=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];var o=e.querySelectorAll("colgroup > col");if(o.length)for(var r=0;r<o.length;r++){var n=o[r].style.width;if(!n)n=o[r].getAttribute("width");n&&(t.columns[r]||(t.columns[r]={}),t.columns[r].width=n)}var i=function(e){var o=e.getBoundingClientRect(),n=o.width>50?o.width:50;t.columns[r]||(t.columns[r]={}),e.getAttribute("data-celltype")?t.columns[r].type=e.getAttribute("data-celltype"):t.columns[r].type="text",t.columns[r].width=n+"px",t.columns[r].title=e.innerText,t.columns[r].align=e.style.textAlign||"center"},s=e.querySelectorAll("thead > tr");if(s.length){s=s[s.length-1].children;for(r=0;r<s.length;r++)i(s[r])}for(var a=0,l={},u={},c={},d=e.querySelectorAll("table > tr, tbody tr"),p=0;p<d.length;p++)if(t.data[a]=[],1==t.parseTableFirstRowAsHeader&&0==p)for(r=0;r<d[p].children.length;r++)i(d[p].children[r]);else{for(r=0;r<d[p].children.length;r++){var h=d[p].children[r].getAttribute("data-formula");if(h)"="!=h.substr(0,1)&&(h="="+h);else h=d[p].children[r].innerText;t.data[a].push(h);var f=jexcel.getColumnNameFromId([r,p]),b=parseInt(d[p].children[r].getAttribute("colspan"))||0,m=parseInt(d[p].children[r].getAttribute("rowspan"))||0;(b||m)&&(l[f]=[b||1,m||1]),(g=d[p].children[r].style&&"none"==d[p].children[r].style.display)&&(d[p].children[r].style.display="");var g=d[p].children[r].getAttribute("style");g&&(c[f]=g),d[p].children[r].classList.contains("styleBold")&&(c[f]?c[f]+="; font-weight:bold;":c[f]="font-weight:bold;")}d[p].style&&d[p].style.height&&(u[p]={height:d[p].style.height}),a++}if(Object.keys(c).length,Object.keys(l).length>0&&(t.mergeCells=l),Object.keys(u).length>0&&(t.rows=u),1==t.parseTableAutoCellType){var j=[];for(r=0;r<t.columns.length;r++){var v=!0,y=!0;j[r]=[];for(p=0;p<t.data.length;p++){h=t.data[p][r];j[r][h]||(j[r][h]=0),j[r][h]++,h.length>25&&(v=!1),10==h.length&&"-"==h.substr(4,1)&&"-"==h.substr(7,1)||(y=!1)}var x=Object.keys(j[r]).length;y?t.columns[r].type="calendar":1==v&&x>1&&x<=parseInt(.1*t.data.length)&&(t.columns[r].type="dropdown",t.columns[r].source=Object.keys(j[r]))}}return t}console.log("Element is not a table")},"undefined"!=typeof jQuery&&function(e){e.fn.jexcel=function(t){var o=e(this).get(0);return o.jexcel?o.jexcel[t].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}}(jQuery);var error=function(){var e={};return e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA"),e}(),utils=function(){var e={flattenShallow:function(e){return e&&e.reduce?e.reduce((function(e,t){var o=Array.isArray(e),r=Array.isArray(t);return o&&r?e.concat(t):o?(e.push(t),e):r?[e].concat(t):[e,t]})):e},isFlat:function(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0},flatten:function(){var t=e.argsToArray.apply(null,arguments);while(!e.isFlat(t))t=e.flattenShallow(t);return t},argsToArray:function(t){var o=[];return e.arrayEach(t,(function(e){o.push(e)})),o},numbers:function(){var e=this.flatten.apply(null,arguments);return e.filter((function(e){return"number"===typeof e}))},cleanFloat:function(e){var t=1e14;return Math.round(e*t)/t},parseBool:function(e){if("boolean"===typeof e)return e;if(e instanceof Error)return e;if("number"===typeof e)return 0!==e;if("string"===typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||error.value},parseNumber:function(e){return void 0===e||""===e||isNaN(e)?error.value:parseFloat(e)},parseNumberArray:function(t){var o,r;if(!t||0===(o=t.length))return error.value;while(o--){if(r=e.parseNumber(t[o]),r===error.value)return r;t[o]=r}return t},parseMatrix:function(t){var o;if(!t||0===t.length)return error.value;for(var r=0;r<t.length;r++)if(o=e.parseNumberArray(t[r]),t[r]=o,o instanceof Error)return o;return t}},t=new Date(Date.UTC(1900,0,1));return e.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var o=parseInt(e,10);return o<0?error.num:o<=60?new Date(t.getTime()+864e5*(o-1)):new Date(t.getTime()+864e5*(o-2))}return"string"!==typeof e||(e=new Date(e),isNaN(e))?error.value:e},e.parseDateArray=function(e){var t,o=e.length;while(o--){if(t=this.parseDate(e[o]),t===error.value)return t;e[o]=t}return e},e.anyIsError=function(){var e=arguments.length;while(e--)if(arguments[e]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(e){var t,o=e.length;while(o--)if(t=e[o],"number"!==typeof t)if(!0!==t)if(!1!==t){if("string"===typeof t){var r=this.parseNumber(t);r instanceof Error?e[o]=0:e[o]=r}}else e[o]=0;else e[o]=1;return e},e.rest=function(e,t){return t=t||1,e&&"function"===typeof e.slice?e.slice(t):e},e.initial=function(e,t){return t=t||1,e&&"function"===typeof e.slice?e.slice(0,e.length-t):e},e.arrayEach=function(e,t){var o=-1,r=e.length;while(++o<r)if(!1===t(e[o],o,e))break;return e},e.transpose=function(e){return e?e[0].map((function(t,o){return e.map((function(e){return e[o]}))})):error.value},e}();jexcel.methods={},jexcel.methods.datetime=function(){var e={},t=new Date(1900,0,1),o=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];function r(e){var o=e>-22038912e5?2:1;return(e-t)/864e5+o}return e.DATE=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;if(e<0||t<0||o<0)return error.num;var r=new Date(e,t-1,o);return r},e.DATEVALUE=function(e){if("string"!==typeof e)return error.value;var o=Date.parse(e);return isNaN(o)?error.value:o<=-22038912e5?(o-t)/864e5+1:(o-t)/864e5+2},e.DAY=function(e){var t=utils.parseDate(e);return t instanceof Error?t:t.getDate()},e.DAYS=function(e,t){return e=utils.parseDate(e),t=utils.parseDate(t),e instanceof Error?e:t instanceof Error?t:r(e)-r(t)},e.DAYS360=function(e,t,o){},e.EDATE=function(e,t){return e=utils.parseDate(e),e instanceof Error?e:isNaN(t)?error.value:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),r(e))},e.EOMONTH=function(e,t){return e=utils.parseDate(e),e instanceof Error?e:isNaN(t)?error.value:(t=parseInt(t,10),r(new Date(e.getFullYear(),e.getMonth()+t+1,0)))},e.HOUR=function(e){return e=utils.parseDate(e),e instanceof Error?e:e.getHours()},e.INTERVAL=function(e){if("number"!==typeof e&&"string"!==typeof e)return error.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var o=Math.floor(e/2592e3);e%=2592e3;var r=Math.floor(e/86400);e%=86400;var n=Math.floor(e/3600);e%=3600;var i=Math.floor(e/60);e%=60;var s=e;return t=t>0?t+"Y":"",o=o>0?o+"M":"",r=r>0?r+"D":"",n=n>0?n+"H":"",i=i>0?i+"M":"",s=s>0?s+"S":"","P"+t+o+r+"T"+n+i+s},e.ISOWEEKNUM=function(e){if(e=utils.parseDate(e),e instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},e.MINUTE=function(e){return e=utils.parseDate(e),e instanceof Error?e:e.getMinutes()},e.MONTH=function(e){return e=utils.parseDate(e),e instanceof Error?e:e.getMonth()+1},e.NETWORKDAYS=function(e,t,o){},e.NETWORKDAYS.INTL=function(e,t,o,r){},e.NOW=function(){return new Date},e.SECOND=function(e){return e=utils.parseDate(e),e instanceof Error?e:e.getSeconds()},e.TIME=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<0||t<0||o<0?error.num:(3600*e+60*t+o)/86400},e.TIMEVALUE=function(e){return e=utils.parseDate(e),e instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(e,t){if(e=utils.parseDate(e),e instanceof Error)return e;void 0===t&&(t=1);var r=e.getDay();return o[t][r]},e.WEEKNUM=function(e,t){},e.WORKDAY=function(e,t,o){},e.WORKDAY.INTL=function(e,t,o,r){},e.YEAR=function(e){return e=utils.parseDate(e),e instanceof Error?e:e.getFullYear()},e.YEARFRAC=function(e,t,o){},e}(),jexcel.methods.database=function(){var exports={};function compact(e){if(!e)return e;for(var t=[],o=0;o<e.length;++o)e[o]&&t.push(e[o]);return t}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}return exports.FINDFIELD=function(e,t){for(var o=null,r=0;r<e.length;r++)if(e[r][0]===t){o=r;break}return null==o?error.value:o},exports.DAVERAGE=function(e,t,o){if(isNaN(t)&&"string"!==typeof t)return error.value;var r=findResultIndex(e,o),n=[];if("string"===typeof t){var i=exports.FINDFIELD(e,t);n=utils.rest(e[i])}else n=utils.rest(e[t]);for(var s=0,a=0;a<r.length;a++)s+=n[r[a]];return 0===r.length?error.div0:s/r.length},exports.DCOUNT=function(e,t,o){},exports.DCOUNTA=function(e,t,o){},exports.DGET=function(e,t,o){if(isNaN(t)&&"string"!==typeof t)return error.value;var r=findResultIndex(e,o),n=[];if("string"===typeof t){var i=exports.FINDFIELD(e,t);n=utils.rest(e[i])}else n=utils.rest(e[t]);return 0===r.length?error.value:r.length>1?error.num:n[r[0]]},exports.DMAX=function(e,t,o){if(isNaN(t)&&"string"!==typeof t)return error.value;var r=findResultIndex(e,o),n=[];if("string"===typeof t){var i=exports.FINDFIELD(e,t);n=utils.rest(e[i])}else n=utils.rest(e[t]);for(var s=n[r[0]],a=1;a<r.length;a++)s<n[r[a]]&&(s=n[r[a]]);return s},exports.DMIN=function(e,t,o){if(isNaN(t)&&"string"!==typeof t)return error.value;var r=findResultIndex(e,o),n=[];if("string"===typeof t){var i=exports.FINDFIELD(e,t);n=utils.rest(e[i])}else n=utils.rest(e[t]);for(var s=n[r[0]],a=1;a<r.length;a++)s>n[r[a]]&&(s=n[r[a]]);return s},exports.DPRODUCT=function(e,t,o){if(isNaN(t)&&"string"!==typeof t)return error.value;var r=findResultIndex(e,o),n=[];if("string"===typeof t){var i=exports.FINDFIELD(e,t);n=utils.rest(e[i])}else n=utils.rest(e[t]);for(var s=[],a=0;a<r.length;a++)s[a]=n[r[a]];s=compact(s);var l=1;for(a=0;a<s.length;a++)l*=s[a];return l},exports.DSTDEV=function(e,t,o){},exports.DSTDEVP=function(e,t,o){},exports.DSUM=function(e,t,o){},exports.DVAR=function(e,t,o){},exports.DVARP=function(e,t,o){},exports.MATCH=function(e,t,o){if(!e&&!t)return error.na;if(2===arguments.length&&(o=1),!(t instanceof Array))return error.na;if(-1!==o&&0!==o&&1!==o)return error.na;for(var r,n,i=0;i<t.length;i++)if(1===o){if(t[i]===e)return i+1;t[i]<e&&(n?t[i]>n&&(r=i+1,n=t[i]):(r=i+1,n=t[i]))}else if(0===o){if("string"===typeof e){if(e=e.replace(/\?/g,"."),t[i].toLowerCase().match(e.toLowerCase()))return i+1}else if(t[i]===e)return i+1}else if(-1===o){if(t[i]===e)return i+1;t[i]>e&&(n?t[i]<n&&(r=i+1,n=t[i]):(r=i+1,n=t[i]))}return r||error.na},exports}(),jexcel.methods.engineering=function(){var e={};function t(e){return/^[01]{1,10}$/.test(e)}return e.BESSELI=function(e,t){},e.BESSELJ=function(e,t){},e.BESSELK=function(e,t){},e.BESSELY=function(e,t){},e.BIN2DEC=function(e){if(!t(e))return error.num;var o=parseInt(e,2),r=e.toString();return 10===r.length&&"1"===r.substring(0,1)?parseInt(r.substring(1),2)-512:o},e.BIN2HEX=function(e,o){if(!t(e))return error.num;var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);var n=parseInt(e,2).toString(16);return void 0===o?n:isNaN(o)?error.value:o<0?error.num:(o=Math.floor(o),o>=n.length?REPT("0",o-n.length)+n:error.num)},e.BIN2OCT=function(e,o){if(!t(e))return error.num;var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(1073741312+parseInt(r.substring(1),2)).toString(8);var n=parseInt(e,2).toString(8);return void 0===o?n:isNaN(o)?error.value:o<0?error.num:(o=Math.floor(o),o>=n.length?REPT("0",o-n.length)+n:error.num)},e.BITAND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?error.num:e&t},e.BITLSHIFT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?error.num:t>=0?e<<t:e>>-t},e.BITOR=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?error.num:e|t},e.BITRSHIFT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?error.num:t>=0?e>>t:e<<-t},e.BITXOR=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?error.num:e^t},e.COMPLEX=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return e;if(o=void 0===o?"i":o,"i"!==o&&"j"!==o)return error.value;if(0===e&&0===t)return 0;if(0===e)return 1===t?o:t.toString()+o;if(0===t)return e.toString();var r=t>0?"+":"";return e.toString()+r+(1===t?o:t.toString()+o)},e.CONVERT=function(e,t,o){if(e=utils.parseNumber(e),e instanceof Error)return e;for(var r,n=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},a=null,l=null,u=t,c=o,d=1,p=1,h=0;h<n.length;h++)r=null===n[h][2]?[]:n[h][2],(n[h][1]===u||r.indexOf(u)>=0)&&(a=n[h]),(n[h][1]===c||r.indexOf(c)>=0)&&(l=n[h]);if(null===a){var f=i[t.substring(0,2)],b=s[t.substring(0,1)];"da"===t.substring(0,2)&&(b=["dekao",10,"da"]),f?(d=f[2],u=t.substring(2)):b&&(d=b[1],u=t.substring(b[2].length));for(var m=0;m<n.length;m++)r=null===n[m][2]?[]:n[m][2],(n[m][1]===u||r.indexOf(u)>=0)&&(a=n[m])}if(null===l){var g=i[o.substring(0,2)],j=s[o.substring(0,1)];"da"===o.substring(0,2)&&(j=["dekao",10,"da"]),g?(p=g[2],c=o.substring(2)):j&&(p=j[1],c=o.substring(j[2].length));for(var v=0;v<n.length;v++)r=null===n[v][2]?[]:n[v][2],(n[v][1]===c||r.indexOf(c)>=0)&&(l=n[v])}return null===a||null===l||a[3]!==l[3]?error.na:e*a[6]*d/(l[6]*p)},e.DEC2BIN=function(e,t){if(e=utils.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return error.num;if(e<0)return"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var o=parseInt(e,10).toString(2);return"undefined"===typeof t?o:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t),t>=o.length?REPT("0",t-o.length)+o:error.num)},e.DEC2HEX=function(e,t){if(e=utils.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return error.num;if(e<0)return(1099511627776+e).toString(16);var o=parseInt(e,10).toString(16);return"undefined"===typeof t?o:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t),t>=o.length?REPT("0",t-o.length)+o:error.num)},e.DEC2OCT=function(e,t){if(e=utils.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return error.num;if(e<0)return(1073741824+e).toString(8);var o=parseInt(e,10).toString(8);return"undefined"===typeof t?o:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t),t>=o.length?REPT("0",t-o.length)+o:error.num)},e.DELTA=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e===t?1:0},e.ERF=function(e,t){},e.ERF.PRECISE=function(){},e.ERFC=function(e){},e.ERFC.PRECISE=function(){},e.GESTEP=function(e,t){return t=t||0,e=utils.parseNumber(e),utils.anyIsError(t,e)?e:e>=t?1:0},e.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var o=10===e.length&&"f"===e.substring(0,1).toLowerCase(),r=o?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<-512||r>511)return error.num;if(o)return"1"+REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var n=r.toString(2);return void 0===t?n:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:error.num)},e.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},e.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var o=parseInt(e,16);if(o>536870911&&o<0xffe0000000)return error.num;if(o>=0xffe0000000)return(o-0xffc0000000).toString(8);var r=o.toString(8);return void 0===t?r:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t),t>=r.length?REPT("0",t-r.length)+r:error.num)},e.IMABS=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);return utils.anyIsError(o,r)?error.value:Math.sqrt(Math.pow(o,2)+Math.pow(r,2))},e.IMAGINARY=function(e){if(void 0===e||!0===e||!1===e)return error.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var t=e.indexOf("+"),o=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===o&&(o=e.indexOf("-",1));var r=e.substring(e.length-1,e.length),n="i"===r||"j"===r;return t>=0||o>=0?n?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?error.num:-Number(e.substring(o+1,e.length-1)):error.num:n?isNaN(e.substring(0,e.length-1))?error.num:e.substring(0,e.length-1):isNaN(e)?error.num:0},e.IMARGUMENT=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);return utils.anyIsError(o,r)?error.value:0===o&&0===r?error.div0:0===o&&r>0?Math.PI/2:0===o&&r<0?-Math.PI/2:0===r&&o>0?0:0===r&&o<0?-Math.PI:o>0?Math.atan(r/o):o<0&&r>=0?Math.atan(r/o)+Math.PI:Math.atan(r/o)-Math.PI},e.IMCONJUGATE=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);return n="i"===n||"j"===n?n:"i",0!==r?e.COMPLEX(o,-r,n):t},e.IMCOS=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);return n="i"===n||"j"===n?n:"i",e.COMPLEX(Math.cos(o)*(Math.exp(r)+Math.exp(-r))/2,-Math.sin(o)*(Math.exp(r)-Math.exp(-r))/2,n)},e.IMCOSH=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);return n="i"===n||"j"===n?n:"i",e.COMPLEX(Math.cos(r)*(Math.exp(o)+Math.exp(-o))/2,Math.sin(r)*(Math.exp(o)-Math.exp(-o))/2,n)},e.IMCOT=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);return utils.anyIsError(o,r)?error.value:e.IMDIV(e.IMCOS(t),e.IMSIN(t))},e.IMDIV=function(t,o){var r=e.IMREAL(t),n=e.IMAGINARY(t),i=e.IMREAL(o),s=e.IMAGINARY(o);if(utils.anyIsError(r,n,i,s))return error.value;var a=t.substring(t.length-1),l=o.substring(o.length-1),u="i";if(("j"===a||"j"===l)&&(u="j"),0===i&&0===s)return error.num;var c=i*i+s*s;return e.COMPLEX((r*i+n*s)/c,(n*i-r*s)/c,u)},e.IMEXP=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);n="i"===n||"j"===n?n:"i";var i=Math.exp(o);return e.COMPLEX(i*Math.cos(r),i*Math.sin(r),n)},e.IMLN=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);return n="i"===n||"j"===n?n:"i",e.COMPLEX(Math.log(Math.sqrt(o*o+r*r)),Math.atan(r/o),n)},e.IMLOG10=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);return n="i"===n||"j"===n?n:"i",e.COMPLEX(Math.log(Math.sqrt(o*o+r*r))/Math.log(10),Math.atan(r/o)/Math.log(10),n)},e.IMLOG2=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);return n="i"===n||"j"===n?n:"i",e.COMPLEX(Math.log(Math.sqrt(o*o+r*r))/Math.log(2),Math.atan(r/o)/Math.log(2),n)},e.IMPOWER=function(t,o){o=utils.parseNumber(o);var r=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,r,n))return error.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var s=Math.pow(e.IMABS(t),o),a=e.IMARGUMENT(t);return e.COMPLEX(s*Math.cos(o*a),s*Math.sin(o*a),i)},e.IMPRODUCT=function(){for(var t=arguments[0],o=1;o<arguments.length;o++){var r=e.IMREAL(t),n=e.IMAGINARY(t),i=e.IMREAL(arguments[o]),s=e.IMAGINARY(arguments[o]);if(utils.anyIsError(r,n,i,s))return error.value;t=e.COMPLEX(r*i-n*s,r*s+n*i)}return t},e.IMREAL=function(e){if(void 0===e||!0===e||!1===e)return error.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),o=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===o&&(o=e.indexOf("-",1));var r=e.substring(e.length-1,e.length),n="i"===r||"j"===r;return t>=0||o>=0?n?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:Number(e.substring(0,t)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?error.num:Number(e.substring(0,o)):error.num:n?isNaN(e.substring(0,e.length-1))?error.num:0:isNaN(e)?error.num:e},e.IMSEC=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),r=e.IMAGINARY(t);return utils.anyIsError(o,r)?error.value:e.IMDIV("1",e.IMCOS(t))},e.IMSECH=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);return utils.anyIsError(o,r)?error.value:e.IMDIV("1",e.IMCOSH(t))},e.IMSIN=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);return n="i"===n||"j"===n?n:"i",e.COMPLEX(Math.sin(o)*(Math.exp(r)+Math.exp(-r))/2,Math.cos(o)*(Math.exp(r)-Math.exp(-r))/2,n)},e.IMSINH=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);return n="i"===n||"j"===n?n:"i",e.COMPLEX(Math.cos(r)*(Math.exp(o)-Math.exp(-o))/2,Math.sin(r)*(Math.exp(o)+Math.exp(-o))/2,n)},e.IMSQRT=function(t){var o=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,r))return error.value;var n=t.substring(t.length-1);n="i"===n||"j"===n?n:"i";var i=Math.sqrt(e.IMABS(t)),s=e.IMARGUMENT(t);return e.COMPLEX(i*Math.cos(s/2),i*Math.sin(s/2),n)},e.IMCSC=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),r=e.IMAGINARY(t);return utils.anyIsError(o,r)?error.num:e.IMDIV("1",e.IMSIN(t))},e.IMCSCH=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),r=e.IMAGINARY(t);return utils.anyIsError(o,r)?error.num:e.IMDIV("1",e.IMSINH(t))},e.IMSUB=function(e,t){var o=this.IMREAL(e),r=this.IMAGINARY(e),n=this.IMREAL(t),i=this.IMAGINARY(t);if(utils.anyIsError(o,r,n,i))return error.value;var s=e.substring(e.length-1),a=t.substring(t.length-1),l="i";return("j"===s||"j"===a)&&(l="j"),this.COMPLEX(o-n,r-i,l)},e.IMSUM=function(){for(var e=utils.flatten(arguments),t=e[0],o=1;o<e.length;o++){var r=this.IMREAL(t),n=this.IMAGINARY(t),i=this.IMREAL(e[o]),s=this.IMAGINARY(e[o]);if(utils.anyIsError(r,n,i,s))return error.value;t=this.COMPLEX(r+i,n+s)}return t},e.IMTAN=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),r=e.IMAGINARY(t);return utils.anyIsError(o,r)?error.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},e.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return error.num;var o=10===e.length&&"7"===e.substring(0,1),r=o?parseInt(e,8)-1073741824:parseInt(e,8);if(r<-512||r>511)return error.num;if(o)return"1"+REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var n=r.toString(2);return"undefined"===typeof t?n:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:error.num)},e.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return error.num;var t=parseInt(e,8);return t>=536870912?t-1073741824:t},e.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return error.num;var o=parseInt(e,8);if(o>=536870912)return"ff"+(o+3221225472).toString(16);var r=o.toString(16);return void 0===t?r:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t),t>=r.length?REPT("0",t-r.length)+r:error.num)},e}(),jexcel.methods.financial=function(){var e={};function t(e){return e&&e.getTime&&!isNaN(e.getTime())}function o(e){return e instanceof Date?e:new Date(e)}return e.ACCRINT=function(e,r,n,i,s,a,l){return e=o(e),r=o(r),n=o(n),t(e)&&t(r)&&t(n)?i<=0||s<=0||-1===[1,2,4].indexOf(a)||-1===[0,1,2,3,4].indexOf(l)||n<=e?"#NUM!":(s=s||0,l=l||0,s*i*YEARFRAC(e,n,l)):"#VALUE!"},e.ACCRINTM=null,e.AMORDEGRC=null,e.AMORLINC=null,e.COUPDAYBS=null,e.COUPDAYS=null,e.COUPDAYSNC=null,e.COUPNCD=null,e.COUPNUM=null,e.COUPPCD=null,e.CUMIPMT=function(t,o,r,n,i,s){if(t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),utils.anyIsError(t,o,r))return error.value;if(t<=0||o<=0||r<=0)return error.num;if(n<1||i<1||n>i)return error.num;if(0!==s&&1!==s)return error.num;var a=e.PMT(t,o,r,0,s),l=0;1===n&&0===s&&(l=-r,n++);for(var u=n;u<=i;u++)l+=1===s?e.FV(t,u-2,a,r,1)-a:e.FV(t,u-1,a,r,0);return l*=t,l},e.CUMPRINC=function(t,o,r,n,i,s){if(t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),utils.anyIsError(t,o,r))return error.value;if(t<=0||o<=0||r<=0)return error.num;if(n<1||i<1||n>i)return error.num;if(0!==s&&1!==s)return error.num;var a=e.PMT(t,o,r,0,s),l=0;1===n&&(l=0===s?a+r*t:a,n++);for(var u=n;u<=i;u++)l+=s>0?a-(e.FV(t,u-2,a,r,1)-a)*t:a-e.FV(t,u-1,a,r,0)*t;return l},e.DB=function(e,t,o,r,n){if(n=void 0===n?12:n,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),n=utils.parseNumber(n),utils.anyIsError(e,t,o,r,n))return error.value;if(e<0||t<0||o<0||r<0)return error.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(n))return error.num;if(r>o)return error.num;if(t>=e)return 0;for(var i=(1-Math.pow(t/e,1/o)).toFixed(3),s=e*i*n/12,a=s,l=0,u=r===o?o-1:r,c=2;c<=u;c++)l=(e-a)*i,a+=l;return 1===r?s:r===o?(e-a)*i:l},e.DDB=function(e,t,o,r,n){if(n=void 0===n?2:n,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),n=utils.parseNumber(n),utils.anyIsError(e,t,o,r,n))return error.value;if(e<0||t<0||o<0||r<0||n<=0)return error.num;if(r>o)return error.num;if(t>=e)return 0;for(var i=0,s=0,a=1;a<=r;a++)s=Math.min(n/o*(e-i),e-t-i),i+=s;return s},e.DISC=null,e.DOLLARDE=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(t<0)return error.num;if(t>=0&&t<1)return error.div0;t=parseInt(t,10);var o=parseInt(e,10);o+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var r=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return o=Math.round(o*r)/r,o},e.DOLLARFR=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(t<0)return error.num;if(t>=0&&t<1)return error.div0;t=parseInt(t,10);var o=parseInt(e,10);return o+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,o},e.DURATION=null,e.EFFECT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<=0||t<1?error.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},e.FV=function(e,t,o,r,n){if(r=r||0,n=n||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),n=utils.parseNumber(n),utils.anyIsError(e,t,o,r,n))return error.value;var i;if(0===e)i=r+o*t;else{var s=Math.pow(1+e,t);i=1===n?r*s+o*(1+e)*(s-1)/e:r*s+o*(s-1)/e}return-i},e.FVSCHEDULE=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=t.length,r=e,n=0;n<o;n++)r*=1+t[n];return r},e.INTRATE=null,e.IPMT=function(t,o,r,n,i,s){if(i=i||0,s=s||0,t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),n=utils.parseNumber(n),i=utils.parseNumber(i),s=utils.parseNumber(s),utils.anyIsError(t,o,r,n,i,s))return error.value;var a,l=e.PMT(t,r,n,i,s);return a=1===o?1===s?0:-n:1===s?e.FV(t,o-2,l,n,1)-l:e.FV(t,o-1,l,n,0),a*t},e.IRR=function(e,t){if(t=t||0,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;for(var o=function(e,t,o){for(var r=o+1,n=e[0],i=1;i<e.length;i++)n+=e[i]/Math.pow(r,(t[i]-t[0])/365);return n},r=function(e,t,o){for(var r=o+1,n=0,i=1;i<e.length;i++){var s=(t[i]-t[0])/365;n-=s*e[i]/Math.pow(r,s+1)}return n},n=[],i=!1,s=!1,a=0;a<e.length;a++)n[a]=0===a?0:n[a-1]+365,e[a]>0&&(i=!0),e[a]<0&&(s=!0);if(!i||!s)return error.num;t=void 0===t?.1:t;var l,u,c,d=t,p=1e-10,h=!0;do{c=o(e,n,d),l=d-c/r(e,n,d),u=Math.abs(l-d),d=l,h=u>p&&Math.abs(c)>p}while(h);return d},e.ISPMT=function(e,t,o,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),utils.anyIsError(e,t,o,r)?error.value:r*e*(t/o-1)},e.MDURATION=null,e.MIRR=function(t,o,r){if(t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseNumber(o),r=utils.parseNumber(r),utils.anyIsError(t,o,r))return error.value;for(var n=t.length,i=[],s=[],a=0;a<n;a++)t[a]<0?i.push(t[a]):s.push(t[a]);var l=-e.NPV(r,s)*Math.pow(1+r,n-1),u=e.NPV(o,i)*(1+o);return Math.pow(l/u,1/(n-1))-1},e.NOMINAL=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<=0||t<1?error.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},e.NPER=function(e,t,o,r,n){if(n=void 0===n?0:n,r=void 0===r?0:r,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),n=utils.parseNumber(n),utils.anyIsError(e,t,o,r,n))return error.value;var i=t*(1+e*n)-r*e,s=o*e+t*(1+e*n);return Math.log(i/s)/Math.log(1+e)},e.NPV=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],o=0,r=1;r<e.length;r++)o+=e[r]/Math.pow(1+t,r);return o},e.ODDFPRICE=null,e.ODDFYIELD=null,e.ODDLPRICE=null,e.ODDLYIELD=null,e.PDURATION=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<=0?error.num:(Math.log(o)-Math.log(t))/Math.log(1+e)},e.PMT=function(e,t,o,r,n){if(r=r||0,n=n||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),n=utils.parseNumber(n),utils.anyIsError(e,t,o,r,n))return error.value;var i;if(0===e)i=(o+r)/t;else{var s=Math.pow(1+e,t);i=1===n?(r*e/(s-1)+o*e/(1-1/s))/(1+e):r*e/(s-1)+o*e/(1-1/s)}return-i},e.PPMT=function(t,o,r,n,i,s){return i=i||0,s=s||0,t=utils.parseNumber(t),r=utils.parseNumber(r),n=utils.parseNumber(n),i=utils.parseNumber(i),s=utils.parseNumber(s),utils.anyIsError(t,r,n,i,s)?error.value:e.PMT(t,r,n,i,s)-e.IPMT(t,o,r,n,i,s)},e.PRICE=null,e.PRICEDISC=null,e.PRICEMAT=null,e.PV=function(e,t,o,r,n){return r=r||0,n=n||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),n=utils.parseNumber(n),utils.anyIsError(e,t,o,r,n)?error.value:0===e?-o*t-r:((1-Math.pow(1+e,t))/e*o*(1+e*n)-r)/Math.pow(1+e,t)},e.RATE=function(e,t,o,r,n,i){if(i=void 0===i?.01:i,r=void 0===r?0:r,n=void 0===n?0:n,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(e,t,o,r,n,i))return error.value;var s=1e-6,a=100,l=0,u=!1,c=i;while(l<a&&!u){var d=Math.pow(c+1,e),p=Math.pow(c+1,e-1),h=r+d*o+t*(d-1)*(c*n+1)/c,f=e*p*o-t*(d-1)*(c*n+1)/Math.pow(c,2),b=e*t*p*(c*n+1)/c+t*(d-1)*n/c,m=c-h/(f+b);Math.abs(m-c)<s&&(u=!0),l++,c=m}return u?c:Number.NaN+c},e.RECEIVED=null,e.RRI=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===e||0===t?error.num:Math.pow(o/t,1/e)-1},e.SLN=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===o?error.num:(e-t)/o},e.SYD=function(e,t,o,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumber(r),utils.anyIsError(e,t,o,r)?error.value:0===o||r<1||r>o?error.num:(r=parseInt(r,10),(e-t)*(o-r+1)*2/(o*(o+1)))},e.TBILLEQ=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||e>t||t-e>31536e6?error.num:365*o/(360-o*DAYS360(e,t,!1))},e.TBILLPRICE=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||e>t||t-e>31536e6?error.num:100*(1-o*DAYS360(e,t,!1)/360)},e.TBILLYIELD=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||e>t||t-e>31536e6?error.num:360*(100-o)/(o*DAYS360(e,t,!1))},e.VDB=null,e.XIRR=function(e,t,o){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseDateArray(utils.flatten(t)),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;for(var r=function(e,t,o){for(var r=o+1,n=e[0],i=1;i<e.length;i++)n+=e[i]/Math.pow(r,DAYS(t[i],t[0])/365);return n},n=function(e,t,o){for(var r=o+1,n=0,i=1;i<e.length;i++){var s=DAYS(t[i],t[0])/365;n-=s*e[i]/Math.pow(r,s+1)}return n},i=!1,s=!1,a=0;a<e.length;a++)e[a]>0&&(i=!0),e[a]<0&&(s=!0);if(!i||!s)return error.num;o=o||.1;var l,u,c,d=o,p=1e-10,h=!0;do{c=r(e,t,d),l=d-c/n(e,t,d),u=Math.abs(l-d),d=l,h=u>p&&Math.abs(c)>p}while(h);return d},e.XNPV=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseDateArray(utils.flatten(o)),utils.anyIsError(e,t,o))return error.value;for(var r=0,n=0;n<t.length;n++)r+=t[n]/Math.pow(1+e,DAYS(o[n],o[0])/365);return r},e.YIELD=null,e.YIELDDISC=null,e.YIELDMAT=null,e}(),jexcel.methods.information=function(){var e={CELL:null,ERROR:{}};return e.ERROR.TYPE=function(e){switch(e){case error.nil:return 1;case error.div0:return 2;case error.value:return 3;case error.ref:return 4;case error.name:return 5;case error.num:return 6;case error.na:return 7;case error.data:return 8}return error.na},e.INFO=null,e.ISBLANK=function(e){return null===e},e.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},e.ISERR=function(e){return[error.value,error.ref,error.div0,error.num,error.name,error.nil].indexOf(e)>=0||"number"===typeof e&&(isNaN(e)||!isFinite(e))},e.ISERROR=function(t){return e.ISERR(t)||t===error.na},e.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},e.ISFORMULA=null,e.ISLOGICAL=function(e){return!0===e||!1===e},e.ISNA=function(e){return e===error.na},e.ISNONTEXT=function(e){return"string"!==typeof e},e.ISNUMBER=function(e){return"number"===typeof e&&!isNaN(e)&&isFinite(e)},e.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},e.ISREF=null,e.ISTEXT=function(e){return"string"===typeof e},e.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:this.ISERROR(e)?e:0},e.NA=function(){return error.na},e.SHEET=null,e.SHEETS=null,e.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0},e}(),jexcel.methods.logical=function(){var e={AND:function(){for(var e=utils.flatten(arguments),t=!0,o=0;o<e.length;o++)e[o]||(t=!1);return t},CHOOSE:function(){if(arguments.length<2)return error.na;var e=arguments[0];return e<1||e>254||arguments.length<e+1?error.value:arguments[e]},FALSE:function(){return!1},IF:function(e,t,o){return e?t:o},IFERROR:function(e,t){return ISERROR(e)?t:e},IFNA:function(e,t){return e===error.na?t:e},NOT:function(e){return!e},OR:function(){for(var e=utils.flatten(arguments),t=!1,o=0;o<e.length;o++)e[o]&&(t=!0);return t},TRUE:function(){return!0},XOR:function(){for(var e=utils.flatten(arguments),t=0,o=0;o<e.length;o++)e[o]&&t++;return!!(1&Math.floor(Math.abs(t)))},SWITCH:function(){var e;if(arguments.length>0){var t=arguments[0],o=arguments.length-1,r=Math.floor(o/2),n=!1,i=o%2===0?null:arguments[arguments.length-1];if(r)for(var s=0;s<r;s++)if(t===arguments[2*s+1]){e=arguments[2*s+2],n=!0;break}!n&&i&&(e=i)}return e}};return e}(),jexcel.methods.math=function(){var exports={ABS:function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.abs(utils.parseNumber(e))},ACOS:function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.acos(e)},ACOSH:function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},ACOT:function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.atan(1/e)},ACOTH:function(e){return e=utils.parseNumber(e),e instanceof Error?e:.5*Math.log((e+1)/(e-1))},AGGREGATE:null,ARABIC:function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},ASIN:function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.asin(e)},ASINH:function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},ATAN:function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.atan(e)},ATAN2:function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.atan2(e,t)},ATANH:function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},BASE:function(e,t,o){if(o=o||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;o=void 0===o?0:o;var r=e.toString(t);return new Array(Math.max(o+1-r.length,0)).join("0")+r},CEILING:function(e,t,o){return t=void 0===t?1:t,o=void 0===o?0:o,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===t?0:(t=Math.abs(t),e>=0?Math.ceil(e/t)*t:0===o?-1*Math.floor(Math.abs(e)/t)*t:-1*Math.ceil(Math.abs(e)/t)*t)}};exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))},exports.COMBINA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===e&&0===t?1:exports.COMBIN(e+t-1,e-1)},exports.COS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.exp(2*e);return(t+1)/(t-1)},exports.CSC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,t){return arguments.length<1?error.value:parseInt(e,t)},exports.DEGREES=function(e){return e=utils.parseNumber(e),e instanceof Error?e:180*e/Math.PI},exports.EVEN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];return exports.FACT=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.floor(e);return 0===t||1===t?1:(MEMOIZED_FACT[t]>0||(MEMOIZED_FACT[t]=exports.FACT(t-1)*t),MEMOIZED_FACT[t])},exports.FACTDOUBLE=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.floor(e);return t<=0?1:t*exports.FACTDOUBLE(t-2)},exports.FLOOR=function(e,t,o){return t=void 0===t?1:t,o=void 0===o?0:o,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===t?0:(t=Math.abs(t),e>=0?Math.floor(e/t)*t:0===o?-1*Math.ceil(Math.abs(e)/t)*t:-1*Math.floor(Math.abs(e)/t)*t)},exports.FLOOR.MATH=exports.FLOOR,exports.GCD=null,exports.INT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.floor(e)},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,o,r,n,i=1;void 0!==(r=e.pop());)while(r>1){if(r%2){for(t=3,o=Math.floor(Math.sqrt(r));t<=o&&r%t;t+=2);n=t<=o?t:r}else n=2;for(r/=n,i*=n,t=e.length;t;e[--t]%n===0&&1===(e[t]/=n)&&e.splice(t,1));}return i},exports.LN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)},exports.LOG=function(e,t){return e=utils.parseNumber(e),t=void 0===t?10:utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.log(e)/Math.log(t)},exports.LOG10=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)/Math.log(10)},exports.MDETERM=null,exports.MINVERSE=null,exports.MMULT=null,exports.MOD=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return error.div0;var o=Math.abs(e%t);return t>0?o:-o},exports.MROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t<0?error.num:Math.round(e/t)*t},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,o=1,r=0;r<e.length;r++)t+=e[r],o*=exports.FACT(e[r]);return exports.FACT(t)/o},exports.MUNIT=null,exports.ODD=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},exports.PI=function(){return Math.PI},exports.POWER=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=Math.pow(e,t);return isNaN(o)?error.num:o},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=1,o=0;o<e.length;o++)t*=e[o];return t},exports.QUOTIENT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:parseInt(e/t,10)},exports.RADIANS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+Math.ceil((t-e+1)*Math.random())-1},exports.ROMAN=null,exports.ROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.round(e*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDDOWN=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=e>0?1:-1;return o*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDUP=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=e>0?1:-1;return o*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.SEC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,t,o,r){if(e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),r=utils.parseNumberArray(r),utils.anyIsError(e,t,o,r))return error.value;for(var n=r[0]*Math.pow(e,t),i=1;i<r.length;i++)n+=r[i]*Math.pow(e,t+i*o);return n},exports.SIGN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SUBTOTAL=null,exports.ADD=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+t)},exports.MINUS=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e-t)},exports.DIVIDE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===t?error.div0:e/t)},exports.MULTIPLY=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t)},exports.GTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e>=t)},exports.LT=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<t)},exports.LTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<=t)},exports.EQ=function(e,t){return 2!==arguments.length?error.na:e===t},exports.NE=function(e,t){return 2!==arguments.length?error.na:e!==t},exports.POW=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:exports.POWER(e,t))},exports.SUM=function(){for(var e=0,t=Object.keys(arguments),o=0;o<t.length;++o){var r=arguments[t[o]];if("number"===typeof r)e+=r;else if("string"===typeof r){var n=parseFloat(r);!isNaN(n)&&(e+=n)}else Array.isArray(r)&&(e+=exports.SUM.apply(null,r))}return e},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=null,exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,o=e.length,r=0;r<o;r++)t+=ISNUMBER(e[r])?e[r]*e[r]:0;return t},exports.SUMX2MY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=0,r=0;r<e.length;r++)o+=e[r]*e[r]-t[r]*t[r];return o},exports.SUMX2PY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var o=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var r=0;r<e.length;r++)o+=e[r]*e[r]+t[r]*t[r];return o},exports.SUMXMY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var o=0;e=utils.flatten(e),t=utils.flatten(t);for(var r=0;r<e.length;r++)o+=Math.pow(e[r]-t[r],2);return o},exports.TAN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.TRUNC=function(e,t){if(t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=e>0?1:-1;return o*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports}(),jexcel.methods.misc=function(){var e={UNIQUE:function(){for(var e=[],t=0;t<arguments.length;++t){for(var o=!1,r=arguments[t],n=0;n<e.length;++n)if(o=e[n]===r,o)break;o||e.push(r)}return e}};return e.FLATTEN=utils.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(e,t){try{for(var o=t.split("."),r=e,n=0;n<o.length;++n){var i=o[n];if("]"===i[i.length-1]){var s=i.indexOf("["),a=i.substring(s+1,i.length-1);r=r[i.substring(0,s)][a]}else r=r[i]}return r}catch(error){}},e.JOIN=function(e,t){return e.join(t)},e.NUMBERS=function(){var e=utils.flatten(arguments);return e.filter((function(e){return"number"===typeof e}))},e.NUMERAL=null,e}(),jexcel.methods.text=function(){var e={ASC:null,BAHTTEXT:null,CHAR:function(e){return e=utils.parseNumber(e),e instanceof Error?e:String.fromCharCode(e)},CLEAN:function(e){e=e||"";var t=/[\0-\x1F]/g;return e.replace(t,"")},CODE:function(e){return e=e||"",e.charCodeAt(0)},CONCATENATE:function(){var e=utils.flatten(arguments),t=0;while((t=e.indexOf(!0))>-1)e[t]="TRUE";var o=0;while((o=e.indexOf(!1))>-1)e[o]="FALSE";return e.join("")},DBCS:null,DOLLAR:null,EXACT:function(e,t){return e===t},FIND:function(e,t,o){return o=void 0===o?0:o,t?t.indexOf(e,o-1)+1:null},FIXED:null,HTML2TEXT:function(e){var t="";return e&&(e instanceof Array?e.forEach((function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},LEFT:function(e,t){return t=void 0===t?1:t,t=utils.parseNumber(t),t instanceof Error||"string"!==typeof e?error.value:e?e.substring(0,t):null},LEN:function(e){return 0===arguments.length?error.error:"string"===typeof e?e?e.length:0:e.length?e.length:error.value},LOWER:function(e){return"string"!==typeof e?error.value:e?e.toLowerCase():e},MID:function(e,t,o){if(t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(t,o)||"string"!==typeof e)return o;var r=t-1,n=r+o;return e.substring(r,n)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(e){return void 0===e||0===e.length?error.value:(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"===typeof e?error.value:("number"===typeof e&&(e=""+e),e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))))},REGEXEXTRACT:function(e,t){var o=e.match(new RegExp(t));return o?o[o.length>1?o.length-1:0]:null},REGEXMATCH:function(e,t,o){var r=e.match(new RegExp(t));return o?r:!!r},REGEXREPLACE:function(e,t,o){return e.replace(new RegExp(t),o)},REPLACE:function(e,t,o,r){return t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(t,o)||"string"!==typeof e||"string"!==typeof r?error.value:e.substr(0,t-1)+r+e.substr(t-1+o)},REPT:function(e,t){return t=utils.parseNumber(t),t instanceof Error?t:new Array(t+1).join(e)},RIGHT:function(e,t){return t=void 0===t?1:t,t=utils.parseNumber(t),t instanceof Error?t:e?e.substring(e.length-t):null},SEARCH:function(e,t,o){var r;return"string"!==typeof e||"string"!==typeof t?error.value:(o=void 0===o?0:o,r=t.toLowerCase().indexOf(e.toLowerCase(),o-1)+1,0===r?error.value:r)},SPLIT:function(e,t){return e.split(t)},SUBSTITUTE:function(e,t,o,r){if(!(e&&t&&o))return e;if(void 0===r)return e.replace(new RegExp(t,"g"),o);var n=0,i=0;while(e.indexOf(t,n)>0)if(n=e.indexOf(t,n+1),i++,i===r)return e.substring(0,n)+o+e.substring(n+t.length)},T:function(e){return"string"===typeof e?e:""},TEXT:null,TRIM:function(e){return"string"!==typeof e?error.value:e.replace(/ +/g," ").trim()}};return e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(e){return"string"!==typeof e?error.value:e.toUpperCase()},e.VALUE=null,e}(),jexcel.methods.stats=function(){var exports={},SQRT2PI=2.5066282746310002;return exports.AVEDEV=null,exports.AVERAGE=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,r=0,n=0;n<t;n++)o+=e[n],r+=1;return o/r},exports.AVERAGEA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,r=0,n=0;n<t;n++){var i=e[n];"number"===typeof i&&(o+=i),!0===i&&o++,null!==i&&r++}return o/r},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=null,exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)},exports.COUNTIN=function(e,t){for(var o=0,r=0;r<e.length;r++)e[r]===t&&o++;return o},exports.COUNTBLANK=function(){for(var e,t=utils.flatten(arguments),o=0,r=0;r<t.length;r++)e=t[r],null!==e&&""!==e||o++;return o},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!==typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!==typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return UNIQUE.apply(null,utils.flatten(arguments)).length},exports.FISHER=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.FISHERINV=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.FREQUENCY=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=e.length,r=t.length,n=[],i=0;i<=r;i++){n[i]=0;for(var s=0;s<o;s++)0===i?e[s]<=t[0]&&(n[0]+=1):i<r?e[s]>t[i-1]&&e[s]<=t[i]&&(n[i]+=1):i===r&&e[s]>t[r-1]&&(n[r]+=1)}return n},exports.LARGE=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort((function(e,t){return t-e}))[t-1]},exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MODE={},exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,o=e.length,r={},n=[],i=0,s=0;s<o;s++)t=e[s],r[t]=r[t]?r[t]+1:1,r[t]>i&&(i=r[t],n=[]),r[t]===i&&(n[n.length]=t);return n},exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:exports.MODE.MULT(e).sort((function(e,t){return e-t}))[0]},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;e=e.sort((function(e,t){return e-t}));var o=e.length;if(t<1/(o+1)||t>1-1/(o+1))return error.num;var r=t*(o+1)-1,n=Math.floor(r);return utils.cleanFloat(r===n?e[r]:e[n]+(r-n)*(e[n+1]-e[n]))},exports.PERCENTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;e=e.sort((function(e,t){return e-t}));var o=e.length,r=t*(o-1),n=Math.floor(r);return utils.cleanFloat(r===n?e[r]:e[n]+(r-n)*(e[n+1]-e[n]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(e,t,o){if(o=void 0===o?3:o,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;e=e.sort((function(e,t){return e-t}));var r=UNIQUE.apply(null,e),n=e.length,i=r.length,s=Math.pow(10,o),a=0,l=!1,u=0;while(!l&&u<i)t===r[u]?(a=(e.indexOf(r[u])+1)/(n+1),l=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(a=(e.indexOf(r[u])+1+(t-r[u])/(r[u+1]-r[u]))/(n+1),l=!0),u++;return Math.floor(a*s)/s},exports.PERCENTRANK.INC=function(e,t,o){if(o=void 0===o?3:o,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;e=e.sort((function(e,t){return e-t}));var r=UNIQUE.apply(null,e),n=e.length,i=r.length,s=Math.pow(10,o),a=0,l=!1,u=0;while(!l&&u<i)t===r[u]?(a=e.indexOf(r[u])/(n-1),l=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(a=(e.indexOf(r[u])+(t-r[u])/(r[u+1]-r[u]))/(n-1),l=!0),u++;return Math.floor(a*s)/s},exports.PERMUT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:FACT(e)/FACT(e-t)},exports.PERMUTATIONA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.pow(e,t)},exports.PHI=function(e){return e=utils.parseNumber(e),e instanceof Error?error.value:Math.exp(-.5*e*e)/SQRT2PI},exports.PROB=function(e,t,o,r){if(void 0===o)return 0;if(r=void 0===r?o:r,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseNumber(o),r=utils.parseNumber(r),utils.anyIsError(e,t,o,r))return error.value;if(o===r)return e.indexOf(o)>=0?t[e.indexOf(o)]:0;for(var n=e.sort((function(e,t){return e-t})),i=n.length,s=0,a=0;a<i;a++)n[a]>=o&&n[a]<=r&&(s+=t[e.indexOf(n[a])]);return s},exports.QUARTILE={},exports.QUARTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}},exports.QUARTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;t=utils.flatten(t),o=o||!1;var r=o?function(e,t){return e-t}:function(e,t){return t-e};t=t.sort(r);for(var n=t.length,i=0,s=0;s<n;s++)t[s]===e&&i++;return i>1?(2*t.indexOf(e)+i+1)/2:t.indexOf(e)+1},exports.RANK.EQ=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;o=o||!1;var r=o?function(e,t){return e-t}:function(e,t){return t-e};return t=t.sort(r),t.indexOf(e)+1},exports.RSQ=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:Math.pow(exports.PEARSON(e,t),2)},exports.SMALL=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort((function(e,t){return e-t}))[t-1]},exports.STANDARDIZE=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:(e-t)/o},exports.STDEV={},exports.STDEV.P=function(){var e=exports.VAR.P.apply(this,arguments);return Math.sqrt(e)},exports.STDEV.S=function(){var e=exports.VAR.S.apply(this,arguments);return Math.sqrt(e)},exports.STDEVA=function(){var e=exports.VARA.apply(this,arguments);return Math.sqrt(e)},exports.STDEVPA=function(){var e=exports.VARPA.apply(this,arguments);return Math.sqrt(e)},exports.VAR={},exports.VAR.P=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,r=exports.AVERAGE(e),n=0;n<t;n++)o+=Math.pow(e[n]-r,2);return o/t},exports.VAR.S=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,r=exports.AVERAGE(e),n=0;n<t;n++)o+=Math.pow(e[n]-r,2);return o/(t-1)},exports.VARA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,r=0,n=exports.AVERAGEA(e),i=0;i<t;i++){var s=e[i];o+="number"===typeof s?Math.pow(s-n,2):!0===s?Math.pow(1-n,2):Math.pow(0-n,2),null!==s&&r++}return o/(r-1)},exports.VARPA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,r=0,n=exports.AVERAGEA(e),i=0;i<t;i++){var s=e[i];o+="number"===typeof s?Math.pow(s-n,2):!0===s?Math.pow(1-n,2):Math.pow(0-n,2),null!==s&&r++}return o/r},exports.WEIBULL={},exports.WEIBULL.DIST=function(e,t,o,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:r?1-Math.exp(-Math.pow(e/o,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/o,t))*t/Math.pow(o,t)},exports.Z={},exports.Z.TEST=function(e,t,o){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;o=o||exports.STDEV.S(e);var r=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-t)/(o/Math.sqrt(r)),!0)},exports}(),jexcel.methods.utils=function(){var e={PROGRESS:function(e,t){var o=t||"red",r=e||"0";return'<div style="width:'+r+"%;height:4px;background-color:"+o+';margin-top:1px;"></div>'},RATING:function(e){for(var t='<div class="jrating">',o=0;o<5;o++)t+=o<e?'<div class="jrating-selected"></div>':"<div></div>";return t+="</div>",t}};return e}();for(var i=0;i<Object.keys(jexcel.methods).length;i++)for(var methods=jexcel.methods[Object.keys(jexcel.methods)[i]],j=0;j<Object.keys(methods).length;j++)"function"==typeof methods[Object.keys(methods)[j]]?window[Object.keys(methods)[j]]=methods[Object.keys(methods)[j]]:window[Object.keys(methods)[j]]=function(){return Object.keys(methods)[j]+"Not implemented"};return jexcel}))},"0bc6":function(e,t,o){},"169a":function(e,t,o){"use strict";var r=o("5530"),n=o("2909"),i=o("ade3"),s=(o("a9e3"),o("498a"),o("caad"),o("2532"),o("7db0"),o("368e"),o("480e")),a=o("4ad4"),l=o("b848"),u=o("75eb"),c=o("e707"),d=o("e4d3"),p=o("21be"),h=o("f2e7"),f=o("a293"),b=o("58df"),m=o("d9bd"),g=o("80d2"),j=Object(b["a"])(a["a"],l["a"],u["a"],c["a"],d["a"],p["a"],h["a"]);t["a"]=j.extend({name:"v-dialog",directives:{ClickOutside:f["a"]},props:{dark:Boolean,disabled:Boolean,fullscreen:Boolean,light:Boolean,maxWidth:{type:[String,Number],default:"none"},noClickAnimation:Boolean,origin:{type:String,default:"center center"},persistent:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,transition:{type:[String,Boolean],default:"dialog-transition"},width:{type:[String,Number],default:"auto"}},data:function(){return{activatedBy:null,animate:!1,animateTimeout:-1,isActive:!!this.value,stackMinZIndex:200,previousActiveElement:null}},computed:{classes:function(){var e;return e={},Object(i["a"])(e,"v-dialog ".concat(this.contentClass).trim(),!0),Object(i["a"])(e,"v-dialog--active",this.isActive),Object(i["a"])(e,"v-dialog--persistent",this.persistent),Object(i["a"])(e,"v-dialog--fullscreen",this.fullscreen),Object(i["a"])(e,"v-dialog--scrollable",this.scrollable),Object(i["a"])(e,"v-dialog--animated",this.animate),e},contentClasses:function(){return{"v-dialog__content":!0,"v-dialog__content--active":this.isActive}},hasActivator:function(){return Boolean(!!this.$slots.activator||!!this.$scopedSlots.activator)}},watch:{isActive:function(e){var t;e?(this.show(),this.hideScroll()):(this.removeOverlay(),this.unbind(),null==(t=this.previousActiveElement)||t.focus())},fullscreen:function(e){this.isActive&&(e?(this.hideScroll(),this.removeOverlay(!1)):(this.showScroll(),this.genOverlay()))}},created:function(){this.$attrs.hasOwnProperty("full-width")&&Object(m["e"])("full-width",this)},beforeMount:function(){var e=this;this.$nextTick((function(){e.isBooted=e.isActive,e.isActive&&e.show()}))},beforeDestroy:function(){"undefined"!==typeof window&&this.unbind()},methods:{animateClick:function(){var e=this;this.animate=!1,this.$nextTick((function(){e.animate=!0,window.clearTimeout(e.animateTimeout),e.animateTimeout=window.setTimeout((function(){return e.animate=!1}),150)}))},closeConditional:function(e){var t=e.target;return!(this._isDestroyed||!this.isActive||this.$refs.content.contains(t)||this.overlay&&t&&!this.overlay.$el.contains(t))&&this.activeZIndex>=this.getMaxZIndex()},hideScroll:function(){this.fullscreen?document.documentElement.classList.add("overflow-y-hidden"):c["a"].options.methods.hideScroll.call(this)},show:function(){var e=this;!this.fullscreen&&!this.hideOverlay&&this.genOverlay(),this.$nextTick((function(){e.$nextTick((function(){e.previousActiveElement=document.activeElement,e.$refs.content.focus(),e.bind()}))}))},bind:function(){window.addEventListener("focusin",this.onFocusin)},unbind:function(){window.removeEventListener("focusin",this.onFocusin)},onClickOutside:function(e){this.$emit("click:outside",e),this.persistent?this.noClickAnimation||this.animateClick():this.isActive=!1},onKeydown:function(e){if(e.keyCode===g["w"].esc&&!this.getOpenDependents().length)if(this.persistent)this.noClickAnimation||this.animateClick();else{this.isActive=!1;var t=this.getActivator();this.$nextTick((function(){return t&&t.focus()}))}this.$emit("keydown",e)},onFocusin:function(e){if(e&&this.retainFocus){var t=e.target;if(t&&![document,this.$refs.content].includes(t)&&!this.$refs.content.contains(t)&&this.activeZIndex>=this.getMaxZIndex()&&!this.getOpenDependentElements().some((function(e){return e.contains(t)}))){var o=this.$refs.content.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),r=Object(n["a"])(o).find((function(e){return!e.hasAttribute("disabled")}));r&&r.focus()}}},genContent:function(){var e=this;return this.showLazyContent((function(){return[e.$createElement(s["a"],{props:{root:!0,light:e.light,dark:e.dark}},[e.$createElement("div",{class:e.contentClasses,attrs:Object(r["a"])({role:"document",tabindex:e.isActive?0:void 0},e.getScopeIdAttrs()),on:{keydown:e.onKeydown},style:{zIndex:e.activeZIndex},ref:"content"},[e.genTransition()])])]}))},genTransition:function(){var e=this.genInnerContent();return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,appear:!0}},[e]):e},genInnerContent:function(){var e={class:this.classes,ref:"dialog",directives:[{name:"click-outside",value:{handler:this.onClickOutside,closeConditional:this.closeConditional,include:this.getOpenDependentElements}},{name:"show",value:this.isActive}],style:{transformOrigin:this.origin}};return this.fullscreen||(e.style=Object(r["a"])(Object(r["a"])({},e.style),{},{maxWidth:"none"===this.maxWidth?void 0:Object(g["g"])(this.maxWidth),width:"auto"===this.width?void 0:Object(g["g"])(this.width)})),this.$createElement("div",e,this.getContentSlot())}},render:function(e){return e("div",{staticClass:"v-dialog__container",class:{"v-dialog__container--attached":""===this.attach||!0===this.attach||"attach"===this.attach},attrs:{role:"dialog"}},[this.genActivator(),this.genContent()])}})},"16b7":function(e,t,o){"use strict";o("a9e3");var r=o("2b0e");t["a"]=r["a"].extend().extend({name:"delayable",props:{openDelay:{type:[Number,String],default:0},closeDelay:{type:[Number,String],default:0}},data:function(){return{openTimeout:void 0,closeTimeout:void 0}},methods:{clearDelay:function(){clearTimeout(this.openTimeout),clearTimeout(this.closeTimeout)},runDelay:function(e,t){var o=this;this.clearDelay();var r=parseInt(this["".concat(e,"Delay")],10);this["".concat(e,"Timeout")]=setTimeout(t||function(){o.isActive={open:!0,close:!1}[e]},r)}}})},"1b2c":function(e,t,o){},"21be":function(e,t,o){"use strict";var r=o("2909"),n=(o("99af"),o("caad"),o("2532"),o("2b0e")),i=o("80d2");t["a"]=n["a"].extend().extend({name:"stackable",data:function(){return{stackElement:null,stackExclude:null,stackMinZIndex:0,isActive:!1}},computed:{activeZIndex:function(){if("undefined"===typeof window)return 0;var e=this.stackElement||this.$refs.content,t=this.isActive?this.getMaxZIndex(this.stackExclude||[e])+2:Object(i["t"])(e);return null==t?t:parseInt(t)}},methods:{getMaxZIndex:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.$el,o=[this.stackMinZIndex,Object(i["t"])(t)],n=[].concat(Object(r["a"])(document.getElementsByClassName("v-menu__content--active")),Object(r["a"])(document.getElementsByClassName("v-dialog__content--active"))),s=0;s<n.length;s++)e.includes(n[s])||o.push(Object(i["t"])(n[s]));return Math.max.apply(Math,o)}}})},"297c":function(e,t,o){"use strict";o("a9e3");var r=o("2b0e"),n=o("37c6");t["a"]=r["a"].extend().extend({name:"loadable",props:{loading:{type:[Boolean,String],default:!1},loaderHeight:{type:[Number,String],default:2}},methods:{genProgress:function(){return!1===this.loading?null:this.$slots.progress||this.$createElement(n["a"],{props:{absolute:!0,color:!0===this.loading||""===this.loading?this.color||"primary":this.loading,height:this.loaderHeight,indeterminate:!0}})}}})},"368e":function(e,t,o){},"37c6":function(e,t,o){"use strict";var r=o("8e36");t["a"]=r["a"]},"38cb":function(e,t,o){"use strict";var r=o("53ca"),n=(o("a9e3"),o("fb6a"),o("a9ad")),i=o("7560"),s=o("3206"),a=o("80d2"),l=o("d9bd"),u=o("58df"),c=Object(u["a"])(n["a"],Object(s["a"])("form"),i["a"]);t["a"]=c.extend({name:"validatable",props:{disabled:Boolean,error:Boolean,errorCount:{type:[Number,String],default:1},errorMessages:{type:[String,Array],default:function(){return[]}},messages:{type:[String,Array],default:function(){return[]}},readonly:Boolean,rules:{type:Array,default:function(){return[]}},success:Boolean,successMessages:{type:[String,Array],default:function(){return[]}},validateOnBlur:Boolean,value:{required:!1}},data:function(){return{errorBucket:[],hasColor:!1,hasFocused:!1,hasInput:!1,isFocused:!1,isResetting:!1,lazyValue:this.value,valid:!1}},computed:{computedColor:function(){if(!this.isDisabled)return this.color?this.color:this.isDark&&!this.appIsDark?"white":"primary"},hasError:function(){return this.internalErrorMessages.length>0||this.errorBucket.length>0||this.error},hasSuccess:function(){return this.internalSuccessMessages.length>0||this.success},externalError:function(){return this.internalErrorMessages.length>0||this.error},hasMessages:function(){return this.validationTarget.length>0},hasState:function(){return!this.isDisabled&&(this.hasSuccess||this.shouldValidate&&this.hasError)},internalErrorMessages:function(){return this.genInternalMessages(this.errorMessages)},internalMessages:function(){return this.genInternalMessages(this.messages)},internalSuccessMessages:function(){return this.genInternalMessages(this.successMessages)},internalValue:{get:function(){return this.lazyValue},set:function(e){this.lazyValue=e,this.$emit("input",e)}},isDisabled:function(){return this.disabled||!!this.form&&this.form.disabled},isInteractive:function(){return!this.isDisabled&&!this.isReadonly},isReadonly:function(){return this.readonly||!!this.form&&this.form.readonly},shouldValidate:function(){return!!this.externalError||!this.isResetting&&(this.validateOnBlur?this.hasFocused&&!this.isFocused:this.hasInput||this.hasFocused)},validations:function(){return this.validationTarget.slice(0,Number(this.errorCount))},validationState:function(){if(!this.isDisabled)return this.hasError&&this.shouldValidate?"error":this.hasSuccess?"success":this.hasColor?this.computedColor:void 0},validationTarget:function(){return this.internalErrorMessages.length>0?this.internalErrorMessages:this.successMessages&&this.successMessages.length>0?this.internalSuccessMessages:this.messages&&this.messages.length>0?this.internalMessages:this.shouldValidate?this.errorBucket:[]}},watch:{rules:{handler:function(e,t){Object(a["i"])(e,t)||this.validate()},deep:!0},internalValue:function(){this.hasInput=!0,this.validateOnBlur||this.$nextTick(this.validate)},isFocused:function(e){e||this.isDisabled||(this.hasFocused=!0,this.validateOnBlur&&this.$nextTick(this.validate))},isResetting:function(){var e=this;setTimeout((function(){e.hasInput=!1,e.hasFocused=!1,e.isResetting=!1,e.validate()}),0)},hasError:function(e){this.shouldValidate&&this.$emit("update:error",e)},value:function(e){this.lazyValue=e}},beforeMount:function(){this.validate()},created:function(){this.form&&this.form.register(this)},beforeDestroy:function(){this.form&&this.form.unregister(this)},methods:{genInternalMessages:function(e){return e?Array.isArray(e)?e:[e]:[]},reset:function(){this.isResetting=!0,this.internalValue=Array.isArray(this.internalValue)?[]:null},resetValidation:function(){this.isResetting=!0},validate:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,o=[];t=t||this.internalValue,e&&(this.hasInput=this.hasFocused=!0);for(var n=0;n<this.rules.length;n++){var i=this.rules[n],s="function"===typeof i?i(t):i;!1===s||"string"===typeof s?o.push(s||""):"boolean"!==typeof s&&Object(l["b"])("Rules should return a string or boolean, received '".concat(Object(r["a"])(s),"' instead"),this)}return this.errorBucket=o,this.valid=0===o.length,this.valid}}})},"3d8a":function(e){e.exports=JSON.parse('{"alphabet":["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","aa","ab","ac","ad","ae","af","ag","ah","ai","aj","ak","al","am","an","ao","ap","aq","ar","as","at","au","av","aw","ax","ay","az"]}')},"480e":function(e,t,o){"use strict";o("7db0");var r=o("7560");t["a"]=r["a"].extend({name:"v-theme-provider",props:{root:Boolean},computed:{isDark:function(){return this.root?this.rootIsDark:r["a"].options.computed.isDark.call(this)}},render:function(){return this.$slots.default&&this.$slots.default.find((function(e){return!e.isComment&&" "!==e.text}))}})},"4ad4":function(e,t,o){"use strict";var r=o("53ca"),n=(o("caad"),o("b64b"),o("b0c0"),o("16b7")),i=o("f2e7"),s=o("58df"),a=o("80d2"),l=o("d9bd"),u=Object(s["a"])(n["a"],i["a"]);t["a"]=u.extend({name:"activatable",props:{activator:{default:null,validator:function(e){return["string","object"].includes(Object(r["a"])(e))}},disabled:Boolean,internalActivator:Boolean,openOnHover:Boolean,openOnFocus:Boolean},data:function(){return{activatorElement:null,activatorNode:[],events:["click","mouseenter","mouseleave","focus"],listeners:{}}},watch:{activator:"resetActivator",openOnFocus:"resetActivator",openOnHover:"resetActivator"},mounted:function(){var e=Object(a["s"])(this,"activator",!0);e&&["v-slot","normal"].includes(e)&&Object(l["b"])('The activator slot must be bound, try \'<template v-slot:activator="{ on }"><v-btn v-on="on">\'',this),this.addActivatorEvents()},beforeDestroy:function(){this.removeActivatorEvents()},methods:{addActivatorEvents:function(){if(this.activator&&!this.disabled&&this.getActivator()){this.listeners=this.genActivatorListeners();for(var e=Object.keys(this.listeners),t=0,o=e;t<o.length;t++){var r=o[t];this.getActivator().addEventListener(r,this.listeners[r])}}},genActivator:function(){var e=Object(a["r"])(this,"activator",Object.assign(this.getValueProxy(),{on:this.genActivatorListeners(),attrs:this.genActivatorAttributes()}))||[];return this.activatorNode=e,e},genActivatorAttributes:function(){return{role:"button","aria-haspopup":!0,"aria-expanded":String(this.isActive)}},genActivatorListeners:function(){var e=this;if(this.disabled)return{};var t={};return this.openOnHover?(t.mouseenter=function(t){e.getActivator(t),e.runDelay("open")},t.mouseleave=function(t){e.getActivator(t),e.runDelay("close")}):t.click=function(t){var o=e.getActivator(t);o&&o.focus(),t.stopPropagation(),e.isActive=!e.isActive},this.openOnFocus&&(t.focus=function(t){e.getActivator(t),t.stopPropagation(),e.isActive=!e.isActive}),t},getActivator:function(e){if(this.activatorElement)return this.activatorElement;var t=null;if(this.activator){var o=this.internalActivator?this.$el:document;t="string"===typeof this.activator?o.querySelector(this.activator):this.activator.$el?this.activator.$el:this.activator}else if(1===this.activatorNode.length||this.activatorNode.length&&!e){var r=this.activatorNode[0].componentInstance;t=r&&r.$options.mixins&&r.$options.mixins.some((function(e){return e.options&&["activatable","menuable"].includes(e.options.name)}))?r.getActivator():this.activatorNode[0].elm}else e&&(t=e.currentTarget||e.target);return this.activatorElement=t,this.activatorElement},getContentSlot:function(){return Object(a["r"])(this,"default",this.getValueProxy(),!0)},getValueProxy:function(){var e=this;return{get value(){return e.isActive},set value(t){e.isActive=t}}},removeActivatorEvents:function(){if(this.activator&&this.activatorElement){for(var e=Object.keys(this.listeners),t=0,o=e;t<o.length;t++){var r=o[t];this.activatorElement.removeEventListener(r,this.listeners[r])}this.listeners={}}},resetActivator:function(){this.removeActivatorEvents(),this.activatorElement=null,this.getActivator(),this.addActivatorEvents()}}})},"615b":function(e,t,o){},"67ca":function(e,t,o){(function(t,o){e.exports=o()})(0,(function(){"use strict";var e=function(e){var t={init:function(){}};return t};return e.ajax=function(t,o){if(Array.isArray(t)){var r={instance:[],complete:o};if(t.length>0)for(var n=0;n<t.length;n++)t[n].multiple=r,r.instance.push(e.ajax(t[n]));return r}if(t.data||(t.data={}),t.type&&(t.method=t.type),t.data){var i=function(e,t){var o=[],r=Object.keys(e);if(r.length)for(var n=0;n<r.length;n++){if(t)var s=t+"["+r[n]+"]";else s=r[n];if("object"==typeof e[r[n]])for(var a=i(e[r[n]],s),l=Object.keys(a),u=0;u<l.length;u++)o[l[u]]=a[l[u]];else o[s]=e[r[n]]}return o},s=[],a=i(t.data),l=Object.keys(a);for(n=0;n<l.length;n++)s.push(l[n]+"="+encodeURIComponent(a[l[n]]));"GET"==t.method&&s.length>0&&(t.url.indexOf("?")<0&&(t.url+="?"),t.url+=s.join("&"))}var u=new XMLHttpRequest;return u.open(t.method,t.url,!0),u.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"==t.method?(u.setRequestHeader("Accept","application/json"),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):"json"==t.dataType&&u.setRequestHeader("Content-Type","text/json"),1!=t.cache&&(u.setRequestHeader("pragma","no-cache"),u.setRequestHeader("cache-control","no-cache")),1==t.withCredentials&&(u.withCredentials=!0),"function"==typeof t.beforeSend&&t.beforeSend(u),u.onload=function(){if(200===u.status)if("json"==t.dataType)try{var o=JSON.parse(u.responseText);t.success&&"function"==typeof t.success&&t.success(o)}catch(n){t.error&&"function"==typeof t.error&&t.error(n,o)}else{o=u.responseText;t.success&&"function"==typeof t.success&&t.success(o)}else t.error&&"function"==typeof t.error&&t.error(u.responseText);if(e.ajax.queue&&e.ajax.queue.length>0&&e.ajax.send(e.ajax.queue.shift()),e.ajax.requests&&e.ajax.requests.length){var r=e.ajax.requests.indexOf(u);if(e.ajax.requests.splice(r,1),e.ajax.requests.length||t.complete&&"function"==typeof t.complete&&t.complete(o),t.multiple&&t.multiple.instance){r=t.multiple.instance.indexOf(u);t.multiple.instance.splice(r,1),t.multiple.instance.length||t.multiple.complete&&"function"==typeof t.multiple.complete&&t.multiple.complete(o)}}},u.data=s,1==t.queue&&e.ajax.requests.length>0?e.ajax.queue.push(u):e.ajax.send(u),u},e.ajax.send=function(t){t.data?t.send(t.data.join("&")):t.send(),e.ajax.requests.push(t)},e.ajax.exists=function(e,t){var o=new XMLHttpRequest;o.open("HEAD",e,!1),o.send(),o.status&&t(o.status)},e.ajax.requests=[],e.ajax.queue=[],e.alert=function(t){e.getWindowWidth()<800&&e.dialog?e.dialog.open({title:"Alert",message:t}):alert(t)},e.animation={},e.animation.slideLeft=function(e,t,o){1==t?(e.classList.add("slide-left-in"),setTimeout((function(){e.classList.remove("slide-left-in"),"function"==typeof o&&o()}),400)):(e.classList.add("slide-left-out"),setTimeout((function(){e.classList.remove("slide-left-out"),"function"==typeof o&&o()}),400))},e.animation.slideRight=function(e,t,o){1==t?(e.classList.add("slide-right-in"),setTimeout((function(){e.classList.remove("slide-right-in"),"function"==typeof o&&o()}),400)):(e.classList.add("slide-right-out"),setTimeout((function(){e.classList.remove("slide-right-out"),"function"==typeof o&&o()}),400))},e.animation.slideTop=function(e,t,o){1==t?(e.classList.add("slide-top-in"),setTimeout((function(){e.classList.remove("slide-top-in"),"function"==typeof o&&o()}),400)):(e.classList.add("slide-top-out"),setTimeout((function(){e.classList.remove("slide-top-out"),"function"==typeof o&&o()}),400))},e.animation.slideBottom=function(e,t,o){1==t?(e.classList.add("slide-bottom-in"),setTimeout((function(){e.classList.remove("slide-bottom-in"),"function"==typeof o&&o()}),400)):(e.classList.add("slide-bottom-out"),setTimeout((function(){e.classList.remove("slide-bottom-out"),"function"==typeof o&&o()}),100))},e.animation.fadeIn=function(e,t){e.classList.add("fade-in"),setTimeout((function(){e.classList.remove("fade-in"),"function"==typeof t&&t()}),2e3)},e.animation.fadeOut=function(e,t){e.classList.add("fade-out"),setTimeout((function(){e.classList.remove("fade-out"),"function"==typeof t&&t()}),1e3)},e.calendar=function(t,o){var r={options:{}};e.calendar.current||(e.calendar.current=null);var n={data:null,type:null,validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdays_short:["S","M","T","W","T","F","S"],textDone:"Done",textReset:"Reset",textUpdate:"Update",value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,mode:null,position:null};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];if(r.options.value||"INPUT"==t.tagName&&t.value&&(r.options.value=t.value),r.options.format=r.options.format.toUpperCase(),r.date=null,r.options.value){var s=r.options.value.split(" "),a=s[1],l=(s=s[0].split("-"),parseInt(s[0])),u=parseInt(s[1]),c=parseInt(s[2]);if(a){a=a.split(":");var d=parseInt(a[0]),p=parseInt(a[1])}else d=0,p=0;r.date=[l,u,c,d,p,0]}else if(r.options.today){s=new Date,l=s.getFullYear(),u=s.getMonth()+1,c=s.getDate(),d=s.getHours(),p=s.getMinutes();r.date=[l,u,c,d,p,0]}var h=function(e){return e=""+e,1==e.length&&(e="0"+e),e},f=document.createElement("div");f.className="jcalendar-reset",f.innerHTML=r.options.textReset;var b=document.createElement("div");b.className="jcalendar-confirm",b.innerHTML=r.options.textDone;var m=document.createElement("div");m.className="jcalendar-controls",r.options.resetButton&&m.appendChild(f),m.appendChild(b);var g=document.createElement("div");g.className="jcalendar-container";var j=document.createElement("div");j.className="jcalendar-content",j.appendChild(m),g.appendChild(j);var v=document.createElement("div");if(v.className="jcalendar-table",j.appendChild(v),"INPUT"==t.tagName)var y=document.createElement("div");else y=t;y.className="jcalendar",y.appendChild(g);var x=document.createElement("td");x.setAttribute("colspan","2"),x.className="jcalendar-prev";var C=document.createElement("span");C.className="jcalendar-year";var w=document.createElement("span");w.className="jcalendar-month";var E=document.createElement("td");E.className="jcalendar-header",E.setAttribute("colspan","3"),E.appendChild(w),E.appendChild(C);var A=document.createElement("td");A.setAttribute("colspan","2"),A.className="jcalendar-next";var N=document.createElement("tr");N.appendChild(x),N.appendChild(E),N.appendChild(A);var I=document.createElement("thead");I.appendChild(N);var L=document.createElement("tbody"),M=document.createElement("tfoot"),T=document.createElement("table");T.setAttribute("cellpadding","0"),T.setAttribute("cellspacing","0"),T.appendChild(I),T.appendChild(L),T.appendChild(M),v.appendChild(T);var D=document.createElement("select");D.className="jcalendar-select",D.onchange=function(){r.date[3]=this.value};for(p=0;p<24;p++){var S=document.createElement("option");S.value=p,S.innerHTML=h(p),D.appendChild(S)}var O=document.createElement("select");O.className="jcalendar-select",O.onchange=function(){r.date[4]=this.value};for(p=0;p<60;p++){S=document.createElement("option");S.value=p,S.innerHTML=h(p),O.appendChild(S)}var R=document.createElement("div");R.className="jcalendar-controls";var F=document.createElement("div");F.className="jcalendar-time",F.style.maxWidth="140px",F.appendChild(D),F.appendChild(O);var k=document.createElement("input");k.setAttribute("type","button"),k.className="jcalendar-update",k.value=r.options.textUpdate;var H=document.createElement("div");H.style.flexGrow="10",H.appendChild(k),R.appendChild(F),R.appendChild(H),j.appendChild(R);var B=document.createElement("div");B.className="jcalendar-backdrop",y.appendChild(B);var P=function(){var e=y.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(k.setAttribute("disabled","disabled"),D.setAttribute("disabled","disabled"),O.setAttribute("disabled","disabled")):(k.removeAttribute("disabled"),D.removeAttribute("disabled"),O.removeAttribute("disabled"))};r.open=function(o){if(!y.classList.contains("jcalendar-focus")){if(e.calendar.current&&e.calendar.current.close(),e.calendar.current=r,y.classList.add("jcalendar-focus"),r.getDays(),r.options.time&&(D.value=r.date[3],O.value=r.date[4]),e.getWindowWidth()<800||r.options.fullscreen)y.classList.add("jcalendar-fullsize"),e.animation.slideBottom(j,1);else{const e=t.getBoundingClientRect(),o=j.getBoundingClientRect();r.options.position?(g.style.position="fixed",window.innerHeight<e.bottom+o.height?g.style.top=e.top-(o.height+2)+"px":g.style.top=e.top+e.height+2+"px",g.style.left=e.left+"px"):window.innerHeight<e.bottom+o.height?g.style.bottom=1*e.height+o.height+2+"px":g.style.top="2px"}"function"==typeof r.options.onopen&&r.options.onopen(t)}},r.close=function(o,n){if(e.calendar.current){if(e.calendar.current=null,!1!==n){var i=y.querySelector(".jcalendar-selected");if("string"==typeof n)var s=n;else if(i&&i.classList.contains("jcalendar-disabled"))s=r.options.value;else s=r.getValue();r.setValue(s)}o||"function"!=typeof r.options.onclose||r.options.onclose(t),y.classList.remove("jcalendar-focus")}return r.options.value},r.prev=function(){"years"==r.options.mode?(r.date[0]=r.date[0]-12,r.getYears()):(r.date[1]<2?(r.date[0]=r.date[0]-1,r.date[1]=12):r.date[1]=r.date[1]-1,r.getDays())},r.next=function(){"years"==r.options.mode?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):(r.date[1]>11?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},r.setValue=function(e){e||(e=""+e);var o=e,n=r.options.value,i=(r.setLabel(o,r.options.format),o.split(" "));i[1]||(i[1]="00:00:00");var s=i[1].split(":"),a=(i=i[0].split("-"),parseInt(i[0])),l=parseInt(i[1]),u=parseInt(i[2]),c=parseInt(s[0]),d=parseInt(s[1]);r.date=[a,l,u,c,d,0];e=r.setLabel(o,r.options.format);n!=o&&("INPUT"==t.tagName&&(t.value=e),r.options.value=o,"function"==typeof r.options.onchange&&r.options.onchange(t,o,n)),r.getDays()},r.getValue=function(){return r.date?r.options.time?h(r.date[0])+"-"+h(r.date[1])+"-"+h(r.date[2])+" "+h(r.date[3])+":"+h(r.date[4])+":"+h(0):h(r.date[0])+"-"+h(r.date[1])+"-"+h(r.date[2])+" "+h(0)+":"+h(0)+":"+h(0):""},r.update=function(e){if(e.classList.contains("jcalendar-disabled"));else{r.date[2]=e.innerText,r.options.time?(r.date[3]=D.value,r.date[4]=O.value):r.close();var t=y.querySelector(".jcalendar-selected");t&&t.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected")}P()},r.reset=function(){r.setValue(""),r.close(!1,!1)},r.getDays=function(){r.options.mode="days";var t=new Date,o=r.date&&r.date[0]?r.date[0]:parseInt(t.getFullYear()),n=r.date&&r.date[1]?r.date[1]:parseInt(t.getMonth())+1,i=r.date&&r.date[2]?r.date[2]:parseInt(t.getDate()),s=r.date&&r.date[3]?r.date[3]:parseInt(t.getHours()),a=r.date&&r.date[4]?r.date[4]:parseInt(t.getMinutes());r.date=[o,n,i,s,a,0],C.innerHTML=o,w.innerHTML=r.options.months[n-1];var l=t.getMonth()==n-1&&t.getFullYear()==o,u=t.getDate(),c=(t=new Date(o,n,0,0,0),t.getDate()),d=(t=new Date(o,n-1,0,0,0),t.getDay()+1),p=r.options.startingDay||0;d-=p,L.innerHTML="";var h=document.createElement("tr");h.setAttribute("align","center"),L.appendChild(h);for(var f=0;f<7;f++){var b=document.createElement("td");b.classList.add("jcalendar-weekday"),b.innerHTML=r.options.weekdays_short[p],h.appendChild(b),p++,p>6&&(p=0)}p=0;for(var m=0,g=0;g<6;g++){h=document.createElement("tr");h.setAttribute("align","center");var j=!0;for(f=0;f<7;f++){b=document.createElement("td");if(b.classList.add("jcalendar-set-day"),p>=d&&p<d+c){m++,b.innerHTML=m,m==i&&b.classList.add("jcalendar-selected"),l&&u==m&&(b.style.fontWeight="bold");var v=e.calendar.now(new Date(o,n-1,m),!0);if(r.options.validRange){if(!r.options.validRange[0]||v>=r.options.validRange[0])var y=!0;else y=!1;if(!r.options.validRange[1]||v<=r.options.validRange[1])var x=!0;else x=!1;y&&x||b.classList.add("jcalendar-disabled")}j=!1}h.appendChild(b),p++}0==j&&L.appendChild(h)}r.options.time?F.style.display="":F.style.display="none",P()},r.getMonths=function(){r.options.mode="months";var e=r.options.months;C.innerHTML=r.date[0],w.innerHTML="";var t='<td colspan="7"><table width="100%"><tr align="center">';for(p=0;p<12;p++){p>0&&!(p%4)&&(t+='</tr><tr align="center">');var o=parseInt(p)+1;t+='<td class="jcalendar-set-month" data-value="'+o+'">'+e[p]+"</td>"}t+="</tr></table></td>",L.innerHTML=t},r.getYears=function(){r.options.mode="years";var e=[];for(p=0;p<25;p++)e[p]=parseInt(r.date[0])+(p-12);var t='<td colspan="7"><table width="100%"><tr align="center">';for(p=0;p<25;p++)p>0&&!(p%5)&&(t+='</tr><tr align="center">'),t+='<td class="jcalendar-set-year">'+e[p]+"</td>";t+="</tr></table></td>",L.innerHTML=t},r.setLabel=function(t,o){return e.calendar.getDateString(t,o)},r.fromFormatted=function(t,o){return e.calendar.extractDateFromString(t,o)};var V=function(e){var t=e.target.className;"jcalendar-prev"==t?(r.prev(),e.stopPropagation(),e.preventDefault()):"jcalendar-next"==t?(r.next(),e.stopPropagation(),e.preventDefault()):"jcalendar-month"==t?(r.getMonths(),e.stopPropagation(),e.preventDefault()):"jcalendar-year"==t?(r.getYears(),e.stopPropagation(),e.preventDefault()):"jcalendar-set-year"==t?(r.date[0]=e.target.innerText,r.getDays(),e.stopPropagation(),e.preventDefault()):"jcalendar-set-month"==t?(r.date[1]=parseInt(e.target.getAttribute("data-value")),r.getDays(),e.stopPropagation(),e.preventDefault()):"jcalendar-confirm"==t||"jcalendar-update"==t||"jcalendar-close"==t?(r.close(),e.stopPropagation(),e.preventDefault()):"jcalendar-backdrop"==t?(r.close(!1,!1),e.stopPropagation(),e.preventDefault()):"jcalendar-reset"==t?(r.reset(),e.stopPropagation(),e.preventDefault()):e.target.classList.contains("jcalendar-set-day")&&e.target.innerText&&(r.update(e.target),e.stopPropagation(),e.preventDefault())},_=function(t){if(t.target.value&&t.target.value.length>3){var o=e.calendar.extractDateFromString(t.target.value,r.options.format);o&&"true"==t.target.getAttribute("data-completed")&&r.setValue(o)}};return t.addEventListener("keyup",_),y.addEventListener("swipeleft",(function(t){e.animation.slideLeft(T,0,(function(){r.next(),e.animation.slideRight(T,1)})),t.preventDefault(),t.stopPropagation()})),y.addEventListener("swiperight",(function(t){e.animation.slideRight(T,0,(function(){r.prev(),e.animation.slideLeft(T,1)})),t.preventDefault(),t.stopPropagation()})),"ontouchend"in document.documentElement===!0?(y.addEventListener("touchend",V),t.addEventListener("touchend",(function(e){r.open()}))):(y.addEventListener("mouseup",V),t.addEventListener("mouseup",(function(e){r.open()}))),e.calendar.hasEvents||("ontouchstart"in document.documentElement===!0?document.addEventListener("touchstart",e.calendar.isOpen):document.addEventListener("mousedown",e.calendar.isOpen),document.addEventListener("keydown",(function(t){13==t.which?e.calendar.current&&e.calendar.current.close(!1,!0):27==t.which&&e.calendar.current&&e.calendar.current.close(!1,!1)})),e.calendar.hasEvents=!0),"INPUT"==t.tagName&&(t.parentNode.insertBefore(y,t.nextSibling),t.setAttribute("autocomplete","off"),t.setAttribute("data-mask",r.options.format.toLowerCase()),r.options.readonly&&t.setAttribute("readonly","readonly"),r.options.placeholder&&t.setAttribute("placeholder",r.options.placeholder),t.classList.add("jcalendar-input"),t.value=r.setLabel(r.getValue(),r.options.format)),t.calendar=r,1==r.options.opened&&r.open(),r},e.calendar.prettify=function(e,t){if(!t)t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};var o=new Date,r=new Date(e),n=parseInt((o-r)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==n)var i=t.justNow;else if(n<90)i=t.xMinutesAgo.format(n);else if(n<1440)i=t.xHoursAgo.format(Math.round(n/60));else if(n<20160)i=t.xDaysAgo.format(Math.round(n/1440));else if(n<43200)i=t.xWeeksAgo.format(Math.round(n/10080));else if(n<1036800)i=t.xMonthsAgo.format(Math.round(n/43200));else i=t.xYearsAgo.format(Math.round(n/525600));return i},e.calendar.prettifyAll=function(){for(var t=document.querySelectorAll(".prettydate"),o=0;o<t.length;o++)t[o].getAttribute("data-date")?t[o].innerHTML=e.calendar.prettify(t[o].getAttribute("data-date")):(t[o].setAttribute("data-date",t[o].innerHTML),t[o].innerHTML=e.calendar.prettify(t[o].innerHTML))},e.calendar.now=function(e,t){if(!e)e=new Date;var o=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),i=e.getHours(),s=e.getMinutes(),a=e.getSeconds(),l=function(e){return e=""+e,1==e.length&&(e="0"+e),e};return 1==t?l(o)+"-"+l(r)+"-"+l(n):l(o)+"-"+l(r)+"-"+l(n)+" "+l(i)+":"+l(s)+":"+l(a)},e.calendar.extractDateFromString=function(e,t){var o=""+e,r=t.replace(/[0-9]/g,""),n=1,i=r.search("YYYY");i=o.substr(i,4),parseInt(i)!=i&&(n=0);var s=r.search("MM");s=o.substr(s,2),(parseInt(s)!=s||a>12)&&(n=0);var a=r.search("DD");a=o.substr(a,2),(parseInt(a)!=a||a>31)&&(n=0);var l=r.search("HH");l>=0?(l=o.substr(l,2),(!parseInt(l)||l>23)&&(l="00")):l="00";var u=r.search("MI");u>=0?(u=o.substr(u,2),(!parseInt(u)||u>59)&&(u="00")):u="00";var c=r.search("SS");if(c>=0?(c=o.substr(c,2),(!parseInt(c)||c>59)&&(c="00")):c="00",1==n&&e.length==r.length){var d=i+"-"+s+"-"+a+" "+l+":"+u+":"+c;return d}return""},e.calendar.getDateString=function(e,t){if(!t)t="DD/MM/YYYY";if(e){var o=""+e;o=o.split(" ");var r="",n="",i="";if(o[1]?(r=o[1].split(":"),n=r[1]?r[1]:"00",i=r[2]?r[2]:"00",r=r[0]?r[0]:"00"):(r="00",n="00",i="00"),o=o[0].split("-"),o[0]&&o[1]&&o[2]&&o[0]>0&&o[1]>0&&o[1]<13&&o[2]>0&&o[2]<32){var s=new Date(o[0],o[1]-1,o[2]),a=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),l=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");o[1]=(o[1].length<2?"0":"")+o[1],o[2]=(o[2].length<2?"0":"")+o[2],r=(r.length<2?"0":"")+r,n=(n.length<2?"0":"")+n,i=(i.length<2?"0":"")+i,e=t,e=e.replace("WD",a[s.getDay()]),e=e.replace("DD",o[2]),e=e.replace("MM",o[1]),e=e.replace("YYYY",o[0]),e=e.replace("YY",o[0].substring(2,4)),e=e.replace("MON",l[parseInt(o[1])-1].toUpperCase()),r&&(e=e.replace("HH24",r)),r>12?(e=e.replace("HH12",r-12),e=e.replace("HH",r)):(e=e.replace("HH12",r),e=e.replace("HH",r)),e=e.replace("MI",n),e=e.replace("MM",n),e=e.replace("SS",i)}else e=""}return e},e.calendar.isOpen=function(t){e.calendar.current&&(t.target.className&&-1!=t.target.className.indexOf("jcalendar")||e.calendar.current.close(!1,!1))},e.color=function(t,o){var r={options:{},values:[]};e.color.current||(e.color.current=null);var n={placeholder:"",value:null,onclose:null,onchange:null,closeOnChange:!0,palette:null};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];r.options.palette||(r.options.palette=[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]]),r.options.value&&(t.value=r.options.value);var s=document.createElement("div");s.className="jcolor";var a=document.createElement("div");a.className="jcolor-backdrop",s.appendChild(a);var l=document.createElement("div");l.className="jcolor-content";var u=document.createElement("div");u.className="jcolor-close",u.innerHTML="Done",u.onclick=function(){r.close()},l.appendChild(u);var c=document.createElement("table");c.setAttribute("cellpadding","7"),c.setAttribute("cellspacing","0");for(var d=0;d<r.options.palette.length;d++){for(var p=document.createElement("tr"),h=0;h<r.options.palette[d].length;h++){var f=document.createElement("td");f.style.backgroundColor=r.options.palette[d][h],f.setAttribute("data-value",r.options.palette[d][h]),f.innerHTML="",p.appendChild(f),r.options.value==r.options.palette[d][h]&&f.classList.add("jcolor-selected"),r.values[r.options.palette[d][h]]=f}c.appendChild(p)}return r.open=function(){if(e.color.current&&e.color.current!=r&&e.color.current.close(),!e.color.current){e.color.current=r,s.classList.add("jcolor-focus");const o=l.getBoundingClientRect();if(e.getWindowWidth()<800)l.style.top="",l.classList.add("jcolor-fullscreen"),e.animation.slideBottom(l,1),a.style.display="block";else{l.classList.contains("jcolor-fullscreen")&&(l.classList.remove("jcolor-fullscreen"),a.style.display="");const e=t.getBoundingClientRect();window.innerHeight<e.bottom+o.height?l.style.top=-1*(o.height+e.height+2)+"px":l.style.top="2px"}s.focus()}},r.close=function(o){return e.color.current&&(e.color.current=null,o||"function"!=typeof r.options.onclose||r.options.onclose(t),s.classList.remove("jcolor-focus")),a.style.display="",r.options.value},r.setValue=function(e){e&&(t.value=e,r.options.value=e);var o=s.querySelector(".jcolor-selected");o&&o.classList.remove("jcolor-selected"),r.values[e]&&r.values[e].classList.add("jcolor-selected"),"function"==typeof r.options.onchange&&r.options.onchange(t,e),1==r.options.closeOnChange&&r.close()},r.getValue=function(){return r.options.value},t.addEventListener("focus",(function(e){r.open()})),t.addEventListener("mousedown",(function(t){e.color.current||setTimeout((function(){r.open(),t.preventDefault()}),200)})),s.addEventListener("mouseup",(function(t){"TD"==t.target.tagName&&(e.color.current.setValue(t.target.getAttribute("data-value")),e.color.current&&e.color.current.close())})),document.addEventListener("mousedown",(function(t){if(e.color.current){var o=e.findElement(t.target,"jcolor");o||e.color.current.close()}})),s.setAttribute("tabindex","900"),r.options.placeholder&&t.setAttribute("placeholder",r.options.placeholder),l.appendChild(c),s.appendChild(l),"INPUT"==t.tagName?t.parentNode.insertBefore(s,t.nextSibling):t.appendChild(s),t.color=r,r},e.contextmenu=function(t,o){var r={options:{}},n={items:null,onclick:null};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];return t.classList.add("jcontextmenu"),t.setAttribute("tabindex","900"),r.open=function(e,o){if(o&&(r.options.items=o,r.create(o)),r.options.items&&r.options.items.length>0||t.children.length){if(e.target)var n=e.clientX,i=e.clientY;else n=e.x,i=e.y;t.classList.add("jcontextmenu-focus"),t.focus();const o=t.getBoundingClientRect();window.innerHeight<i+o.height?t.style.top=i-o.height+"px":t.style.top=i+"px",window.innerWidth<n+o.width?n-o.width>0?t.style.left=n-o.width+"px":t.style.left="10px":t.style.left=n+"px"}},r.close=function(){t.classList.contains("jcontextmenu-focus")&&t.classList.remove("jcontextmenu-focus")},r.create=function(e){t.innerHTML="";for(var o=0;o<e.length;o++){if(!e[o].type||"line"!=e[o].type&&"divisor"!=e[o].type){i=document.createElement("div");var r=document.createElement("a");if(r.innerHTML=e[o].title,e[o].disabled?i.className="jcontextmenu-disabled":e[o].onclick&&(i.method=e[o].onclick,i.addEventListener("mouseup",(function(){this.method(this)}))),i.appendChild(r),e[o].shortcut){var n=document.createElement("span");n.innerHTML=e[o].shortcut,i.appendChild(n)}}else var i=document.createElement("hr");t.appendChild(i)}},"function"==typeof r.options.onclick&&t.addEventListener("click",(function(e){r.options.onclick(r)})),r.options.items&&r.create(r.options.items),t.addEventListener("blur",(function(e){setTimeout((function(){r.close()}),120)})),e.contextmenu.hasEvents||(window.addEventListener("mousewheel",(function(){r.close()})),document.addEventListener("contextmenu",(function(t){var o=e.contextmenu.getElement(t.target);if(o){var r=document.querySelector("#"+o);r?(r.contextmenu.open(t),t.preventDefault()):console.error("JSUITES: Contextmenu id not found")}})),e.contextmenu.hasEvents=!0),t.contextmenu=r,r},e.contextmenu.getElement=function(e){var t=0;function o(e){e.parentNode&&e.getAttribute("aria-contextmenu-id")?t=e.getAttribute("aria-contextmenu-id"):e.parentNode&&o(e.parentNode)}return o(e),t},e.dropdown=function(t,o){var r={options:{}};if("SELECT"==t.tagName){var n=e.dropdown.extractFromDom(t,o);t=n.el,o=n.options}var i={url:null,data:[],multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null};for(var s in i)o&&o.hasOwnProperty(s)?r.options[s]=o[s]:r.options[s]=i[s];e.dropdown.current||(e.dropdown.current=null),1==r.options.remoteSearch&&(r.options.autocomplete=!0),r.items=[],r.groups=[],r.value=[],r.search="",r.results=null,r.numOfItems=0,t.classList.add("jdropdown"),"searchbar"==r.options.type?t.classList.add("jdropdown-searchbar"):"list"==r.options.type?t.classList.add("jdropdown-list"):"picker"==r.options.type?t.classList.add("jdropdown-picker"):e.getWindowWidth()<800?(t.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width&&(t.style.width=r.options.width,t.style.minWidth=r.options.width),t.classList.add("jdropdown-default"),r.options.type="default");var a=document.createElement("div");a.className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header",r.header.setAttribute("autocomplete","off"),"function"==typeof r.options.onfocus&&(r.header.onfocus=function(){r.options.onfocus(t)}),"function"==typeof r.options.onblur&&(r.header.onblur=function(){r.options.onblur(t)});var l=document.createElement("div");l.className="jdropdown-container";var u=document.createElement("div");u.className="jdropdown-content";var c=document.createElement("div");c.className="jdropdown-create-option",c.innerHTML="New option";var d=document.createElement("div");d.className="jdropdown-close",d.innerHTML="Done";var p=document.createElement("div");p.className="jdropdown-reset",p.innerHTML="x",p.onclick=function(){r.reset(),r.close()};var h=document.createElement("div");if(h.className="jdropdown-backdrop",1==r.options.autocomplete){t.setAttribute("data-autocomplete",!0);var f=null;r.header.addEventListener("keyup",(function(e){f||(r.search!=r.header.value.trim()&&(f=setTimeout((function(){r.find(r.header.value.trim()),f=null}),400)),t.classList.contains("jdropdown-focus")||r.open())}))}else r.header.setAttribute("readonly","readonly");!r.options.placeholder&&t.getAttribute("placeholder")&&(r.options.placeholder=t.getAttribute("placeholder")),r.options.placeholder&&r.header.setAttribute("placeholder",r.options.placeholder),a.appendChild(r.header),"searchbar"==r.options.type?a.appendChild(d):l.appendChild(d),!r.options.type||r.options.type,l.appendChild(u),t.appendChild(a),t.appendChild(l),t.appendChild(h);return r.init=function(){if(r.options.url&&!r.options.data.length)e.ajax({url:r.options.url,method:"GET",dataType:"json",success:function(e){e&&(r.setData(e),null!=r.options.value&&r.setValue(r.options.value),"function"==typeof r.options.onload&&r.options.onload(t,r,e))}});else{var o=[];if(r.options.data.length)for(var n=0;n<r.options.data.length;n++)o.push(r.options.data[n]);r.setData(o),null!=r.options.value&&r.setValue(r.options.value),"function"==typeof r.options.onload&&r.options.onload(t,r,r.options.data)}1==r.options.opened&&r.open()},r.getUrl=function(){return r.options.url},r.setUrl=function(t){r.options.url=t,e.ajax({url:r.options.url,method:"GET",dataType:"json",success:function(e){r.setData(e)}})},r.createItem=function(e,t){var o=e.text||"";!o&&e.name&&(o=e.name),o.trim()||(o="&nbsp;");var n=e.value||"";!n&&e.id&&(n=e.id);var i={};if(i.element=document.createElement("div"),i.element.className="jdropdown-item",i.element.indexValue=r.items.length,i.value=n,i.text=o,i.textLowerCase=i.text.toLowerCase(),e.id&&i.element.setAttribute("id",e.id),t&&(i.group=t),e.image){var s=document.createElement("img");s.className="jdropdown-image",s.src=e.image,e.title||s.classList.add("jdropdown-image-small"),i.element.appendChild(s)}var a=document.createElement("div");if(a.className="jdropdown-description",a.innerHTML=o||"&nbsp;",e.title){var l=document.createElement("div");l.className="jdropdown-title",l.innerHTML=e.title,a.appendChild(l)}return r.value&&r.value[e.value]&&(i.element.classList.add("jdropdown-selected"),i.selected=!0),r.items.push(i),i.element.appendChild(a),i},r.appendData=function(e){if(e.length){r.numOfItems=0;for(var t=[],o=[],n=0;n<e.length;n++)e[n].group?(o[e[n].group]||(o[e[n].group]=[]),o[e[n].group].push(n)):t.push(n);var i=Object.keys(o);if(i.length>0)for(n=0;n<i.length;n++){var s=document.createElement("div");s.className="jdropdown-group";var a=document.createElement("div");a.className="jdropdown-group-name",a.innerHTML=i[n];var l=document.createElement("i");l.className="jdropdown-group-arrow jdropdown-group-arrow-down",a.appendChild(l);var c=document.createElement("div");c.className="jdropdown-group-items";for(var d=0;d<o[i[n]].length;d++){var p=r.createItem(e[o[i[n]][d]],s);(0==r.options.lazyLoading||r.numOfItems<200)&&(c.appendChild(p.element),r.numOfItems++)}s.appendChild(a),s.appendChild(l),s.appendChild(c),r.groups.push(s),c.children.length>0&&u.appendChild(s)}if(t.length)for(n=0;n<t.length;n++){p=r.createItem(e[t[n]]);(0==r.options.lazyLoading||r.numOfItems<200)&&(u.appendChild(p.element),r.numOfItems++)}}},r.setData=function(e){if(e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(e[t]={value:e[t],text:e[t]});u.innerHTML="",r.reset(),r.items=[],r.appendData(e)}r.options.data=e},r.getPosition=function(e){for(var t=0;t<r.items.length;t++)if(r.items[t].value==e)return t;return 0},r.getText=function(e){for(var t=[],o=Object.keys(r.value),n=0;n<o.length;n++)t.push(r.value[o[n]]);return e?t:t.join("; ")},r.getValue=function(e){return e?Object.keys(r.value):Object.keys(r.value).join(";")},r.setValue=function(e){for(var o=function(e,t){r.items[e].value==t&&(r.items[e].element&&r.items[e].element.classList.add("jdropdown-selected"),r.items[e].selected=!0,r.value[t]=r.items[e].text)},n=r.getValue(),i=0;i<r.items.length;i++)1==r.items[i].selected&&(r.items[i].element&&r.items[i].element.classList.remove("jdropdown-selected"),r.items[i].selected=null);if(r.value=[],null!=e)if(Array.isArray(e))for(i=0;i<r.items.length;i++)for(var s=0;s<e.length;s++)o(i,e[s]);else for(var i=0;i<r.items.length;i++)o(i,e);r.header.value=r.getText(),"function"==typeof r.options.onchange&&r.options.onchange(t,null,n,r.getValue())},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(e){e=parseInt(e);if(r.items&&r.items[e]){var o=r.getValue();r.setCursor(e,!1),r.options.multiple?(r.items[e].selected?(r.items[e].element.classList.remove("jdropdown-selected"),r.items[e].selected=!1,delete r.value[r.items[e].value]):(r.items[e].element.classList.add("jdropdown-selected"),r.items[e].selected=!0,r.value[r.items[e].value]=r.items[e].text),r.options.autocomplete||(r.header.value=r.getText()),"function"==typeof r.options.onchange&&r.options.onchange(t,e,o,r.getValue())):(r.value[r.items[e].value]?r.setValue(null):r.setValue(r.items[e].value),r.close())}},r.selectItem=function(t){e.dropdown.current&&r.selectIndex(t.indexValue)},r.find=function(t){if(r.search==t.trim())return!1;r.numOfItems=0,r.search=t;t=t?t.toLowerCase():"";if(1==r.options.remoteSearch)r.currentIndex=null,r.results=null,e.ajax({url:r.options.url+"?q="+t,method:"GET",dataType:"json",success:function(e){r.items=[],u.innerHTML="",r.appendData(e),e.length?u.style.display="":u.style.display="none"}});else{r.results=[];for(var o=0;o<r.items.length;o++)if((null==t||-1!=r.items[o].textLowerCase.indexOf(t)||void 0!=r.value[r.items[o].value])&&(r.results.push(r.items[o]),r.items[o].group&&r.items[o].group.children[2].children[0]))while(r.items[o].group.children[2].children[0])r.items[o].group.children[2].removeChild(r.items[o].group.children[2].children[0]);while(u.children[0])u.removeChild(u.children[0]);var n=r.results.length||0;1==r.options.lazyLoading&&n>200&&(n=200);for(o=0;o<n;o++)r.results[o].group?(r.results[o].group.parentNode||u.appendChild(r.results[o].group),r.results[o].group.children[2].appendChild(r.results[o].element)):u.appendChild(r.results[o].element),r.numOfItems++;r.results.length?u.style.display="":u.style.display="none"}},r.open=function(){if(e.dropdown.current!=t&&(e.dropdown.current&&e.dropdown.current.dropdown.close(),e.dropdown.current=t),!t.classList.contains("jdropdown-focus")){t.classList.add("jdropdown-focus"),e.getWindowWidth()<800&&(null!=r.options.type&&"picker"!=r.options.type||e.animation.slideBottom(l,1)),1==r.options.autocomplete&&(r.header.value=r.search,r.header.focus());var o=Object.keys(r.value);if(o[0]){var n=r.getPosition(o[0]);n&&r.setCursor(n)}if(!r.options.type||"default"==r.options.type){const e=t.getBoundingClientRect(),o=l.getBoundingClientRect();r.options.position?(l.style.position="fixed",window.innerHeight<e.bottom+o.height?(l.style.top="",l.style.bottom=window.innerHeight-e.top+1+"px"):(l.style.top=e.bottom+"px",l.style.bottom=""),l.style.left=e.left+"px"):window.innerHeight<e.bottom+o.height?(l.style.top="",l.style.bottom=e.height+1+"px"):(l.style.top="",l.style.bottom=""),l.style.minWidth=e.width+"px",r.options.maxWidth&&(l.style.maxWidth=r.options.maxWidth),r.items.length||1!=r.options.autocomplete?u.style.display="":u.style.display="none"}}"function"==typeof r.options.onopen&&r.options.onopen(t)},r.close=function(o){return e.dropdown.current&&(e.dropdown.current=null,r.setCursor(),r.header.value=r.getText(),o||"function"!=typeof r.options.onclose||r.options.onclose(t),r.header.blur&&r.header.blur(),t.classList.remove("jdropdown-focus")),r.getValue()},r.setCursor=function(e,t){if(null!=r.currentIndex&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),void 0==e)r.currentIndex=null;else if(parseInt(e),r.items[e].element.classList.add("jdropdown-cursor"),r.currentIndex=e,!1!==t&&r.items[r.currentIndex].element){u.scrollTop;var o=r.items[r.currentIndex].element;u.scrollTop=o.offsetTop-o.scrollTop+o.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.firstVisible=function(){for(var e=null,t=0;t<r.items.length;t++)if("none"!=r.items[t].element.style.display){e=t;break}if(null==e)return!1;r.setCursor(e)},r.first=function(){for(var e=null,t=r.currentIndex-1;t>=0;t--)r.items&&r.items[t]&&"none"!=r.items[t].element.style.display&&(e=t);if(null==e)return!1;r.setCursor(e)},r.last=function(){for(var e=null,t=r.currentIndex+1;t<r.items.length;t++)r.items&&r.items[t]&&"none"!=r.items[t].element.style.display&&(e=t);if(null==e)return!1;r.setCursor(e)},r.next=function(){for(var e=null,t=r.currentIndex+1;t<r.items.length;t++)if(r.items&&r.items[t]&&r.items[t].element.parentNode){e=t;break}if(null==e)return!1;r.setCursor(e)},r.prev=function(){for(var e=null,t=r.currentIndex-1;t>=0;t--)if(r.items&&r.items[t]&&r.items[t].element.parentNode){e=t;break}if(null==e)return!1;r.setCursor(e)},r.loadUp=function(){return!1},r.loadDown=function(){var e=!1;if(r.results)var t=r.results;else t=r.items;if(t.length>r.numOfItems){var o=r.numOfItems,n=t.length-o;n>200&&(n=200);for(var i=o;i<o+n;i++)t[i].group?(t[i].group.parentNode||u.appendChild(t[i].group),t[i].group.children[2].appendChild(t[i].element)):u.appendChild(t[i].element),r.numOfItems++;e=!0}return e},e.dropdown.hasEvents||("ontouchsend"in document.documentElement===!0?document.addEventListener("touchsend",e.dropdown.mouseup):document.addEventListener("mouseup",e.dropdown.mouseup),document.addEventListener("keydown",e.dropdown.onkeydown),e.dropdown.hasEvents=!0),1==r.options.lazyLoading&&e.lazyLoading(u,{loadUp:r.loadUp,loadDown:r.loadDown}),r.init(),t.dropdown=r,r},e.dropdown.hasEvents=!1,e.dropdown.mouseup=function(t){var o=e.findElement(t.target,"jdropdown");if(o){var r=o.dropdown;if(t.target.classList.contains("jdropdown-header"))if(o.classList.contains("jdropdown-focus")&&o.classList.contains("jdropdown-default"))if(0==r.options.autocomplete)r.close();else{var n=o.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var i=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else i=t.clientX,t.clientY;n.width-(i-n.left)<30&&r.close()}else r.open();else if(t.target.classList.contains("jdropdown-group-name")){var s=t.target.nextSibling.children;if("none"!=t.target.nextSibling.style.display)for(var a=0;a<s.length;a++)"none"!=s[a].style.display&&r.selectItem(s[a])}else t.target.classList.contains("jdropdown-group-arrow")?t.target.classList.contains("jdropdown-group-arrow-down")?(t.target.classList.remove("jdropdown-group-arrow-down"),t.target.classList.add("jdropdown-group-arrow-up"),t.target.parentNode.nextSibling.style.display="none"):(t.target.classList.remove("jdropdown-group-arrow-up"),t.target.classList.add("jdropdown-group-arrow-down"),t.target.parentNode.nextSibling.style.display=""):t.target.classList.contains("jdropdown-item")?r.selectItem(t.target):t.target.classList.contains("jdropdown-image")||t.target.classList.contains("jdropdown-description")?r.selectItem(t.target.parentNode):t.target.classList.contains("jdropdown-title")?r.selectItem(t.target.parentNode.parentNode):(t.target.classList.contains("jdropdown-close")||t.target.classList.contains("jdropdown-backdrop"))&&r.close();t.stopPropagation(),t.preventDefault()}else e.dropdown.current&&e.dropdown.current.dropdown.close()},e.dropdown.onkeydown=function(t){if(e.dropdown.current){var o=e.dropdown.current.dropdown,r=o.currentIndex;t.shiftKey||13!=t.which&&27!=t.which&&35!=t.which&&36!=t.which&&38!=t.which&&40!=t.which||(13==t.which?o.selectIndex(r):38==t.which?null==r?o.firstVisible():r>0&&o.prev():40==t.which?null==r?o.firstVisible():r+1<o.items.length&&o.next():36==t.which?o.first():35==t.which?o.last():27==t.which&&o.close(),t.stopPropagation(),t.preventDefault())}},e.dropdown.extractFromDom=function(e,t){var o=e;if(t||(t={}),!e.getAttribute("multiple")||t&&void 0!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&void 0!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&void 0!=t.autocomplete||(t.autocomplete=!0),t&&void 0!=t.width||(t.width=e.offsetWidth),!e.value||t&&void 0!=t.value||(t.value=e.value),!t||void 0==t.data){t.data=[];for(var r=0;r<e.children.length;r++)if("OPTGROUP"==e.children[r].tagName)for(var n=0;n<e.children[r].children.length;n++)t.data.push({value:e.children[r].children[n].value,text:e.children[r].children[n].innerHTML,group:e.children[r].getAttribute("label")});else t.data.push({value:e.children[r].value,text:e.children[r].innerHTML})}t&&void 0!=t.onchange||(t.onchange=function(e,r,n,i){1==t.multiple?obj.items[r].classList.contains("jdropdown-selected")?o.options[r].setAttribute("selected","selected"):o.options[r].removeAttribute("selected"):o.value=i});var i=document.createElement("div");return e.parentNode.insertBefore(i,e),e.style.display="none",e=i,{el:e,options:t}},e.editor=function(t,o){var r={options:{}},n={value:null,snippet:null,toolbar:null,remoteParser:null,parseURL:!1,dropZone:!1,dropAsAttachment:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,border:!0,padding:!0,maxHeight:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];var s=null,a=null;t.innerHTML="","function"==typeof r.options.onclick&&(t.onclick=function(e){r.options.onclick(t,r,e)}),t.classList.add("jeditor-container"),1==r.options.padding&&t.classList.add("jeditor-padding"),0==r.options.border&&(t.style.border="0px");var l=document.createElement("div");l.className="jsnippet",l.setAttribute("contenteditable",!1);var u=document.createElement("div");u.className="jeditor-toolbar";var c=document.createElement("div");if(c.setAttribute("contenteditable",!0),c.setAttribute("spellcheck",!1),c.className="jeditor",r.options.maxHeight&&(c.style.overflowY="auto",c.style.maxHeight=r.options.maxHeight),r.options.value)var d=r.options.value;else d=t.innerHTML?t.innerHTML:"";if(!d)d="<br>";var p=function(e){var t=document.createElement("div");t.innerHTML=e;var o=t.querySelectorAll("img");if(o.length)for(var n=0;n<o.length;n++)r.addImage(o[n].src)},h=function(e){var t,o;if(window.getSelection&&(t=window.getSelection(),t.rangeCount)){o=t.getRangeAt(0);o.toString();o.deleteContents(),o.insertNode(e),o.setStartAfter(e),o.setEndAfter(e),t.removeAllRanges(),t.addRange(o)}},f=function(e){if(l.innerHTML="",e.image){var t=document.createElement("div");t.className="jsnippet-image",t.setAttribute("data-k","image"),l.appendChild(t);var o=document.createElement("img");o.src=e.image,t.appendChild(o)}t=document.createElement("div");t.className="jsnippet-title",t.setAttribute("data-k","title"),t.innerHTML=e.title,l.appendChild(t);t=document.createElement("div");t.className="jsnippet-description",t.setAttribute("data-k","description"),t.innerHTML=e.description,l.appendChild(t);t=document.createElement("div");t.className="jsnippet-host",t.setAttribute("data-k","host"),t.innerHTML=e.host,l.appendChild(t);t=document.createElement("div");t.className="jsnippet-url",t.setAttribute("data-k","url"),t.innerHTML=e.url,l.appendChild(t),c.appendChild(l)},b=function(){clearTimeout(s),s=setTimeout((function(){var o=c.querySelector(".jsnippet"),n=t.querySelector(".jeditor-thumbs-container");if(!o&&!n){var i=c.innerHTML.replace(/\n/g," "),s=document.createElement("div");s.innerHTML=i;n=s.querySelector(".jeditor-thumbs-container");n&&n.remove();var a=s.innerText,l=e.editor.detectUrl(a);if(l)if("jpg"==l[0].substr(-3)||"png"==l[0].substr(-3)||"gif"==l[0].substr(-3))e.editor.getDomain(l[0])==window.location.hostname?r.importImage(l[0],""):r.importImage(r.options.remoteParser+l[0],"");else{var u=e.editor.youtubeParser(l[0]);r.parseWebsite(l[0],u)}}}),1e3)};r.parseContent=function(){b()},r.parseWebsite=function(t,o){if(r.options.remoteParser){if(o)t="https://www.youtube.com/watch?v="+o;var n={title:"",description:"",image:"",host:t.split("/")[2],url:t};e.ajax({url:r.options.remoteParser+encodeURI(t.trim()),method:"GET",dataType:"json",success:function(e){e.title&&(n.title=e.title),e.description&&(n.description=e.description),e.image?n.image=e.image:e["og:image"]&&(n.image=e["og:image"]),e.host&&(n.host=e.host),e.url&&(n.url=e.url),f(n)}})}else console.log("The remoteParser is not defined")},r.setData=function(t){c.innerHTML=t,e.editor.setCursor(c,!0)},r.getText=function(){return c.innerText},r.getData=function(e){if(e){s={content:""};var t=c.querySelectorAll(".post-tag");if(t.length){s.users=[];for(var o=0;o<t.length;o++){var r=t[o].getAttribute("data-user");r&&s.users.push(r)}s.users=s.users.join(",")}if(l.innerHTML){s.snippet={};for(o=0;o<l.children.length;o++){var n=l.children[o].getAttribute("data-k");n&&("image"==n?s.snippet.image=l.children[o].children[0].getAttribute("src"):s.snippet[n]=l.children[o].innerHTML)}l.innerHTML="",l.remove()}var i=c.innerHTML;i=i.replace(/<br>/g,"\n"),i=i.replace(/<\/div>/g,"</div>\n"),i=i.replace(/<(?:.|\n)*?>/gm,""),s.content=i.trim(),s=JSON.stringify(s)}else var s=c.innerHTML;return s},r.reset=function(){c.innerHTML=""},r.addPdf=function(t){if("data"!=t.result.substr(0,4))console.error("Invalid source");else{var o=document.createElement("canvas");o.width=60,o.height=60;var r=new Image,n=o.getContext("2d");n.drawImage(r,0,0,o.width,o.height),o.toBlob((function(o){var r=document.createElement("img");r.src=window.URL.createObjectURL(o),r.setAttribute("data-extension","pdf"),t.name&&r.setAttribute("data-name",t.name),t.size&&r.setAttribute("data-size",t.size),t.date&&r.setAttribute("data-date",t.date),r.className="jfile pdf",h(r),e.files[r.src]=t.result.substr(t.result.indexOf(",")+1)}))}},r.addImage=function(t,o,n,i){if("data"==t.substr(0,4)||r.options.remoteParser){if("data"==t.substr(0,4)){var s=t.split(";");s=s[0].split("/"),s=s[1]}else{s=t.substr(t.lastIndexOf(".")+1);t=r.options.remoteParser+t}var a=new Image;a.onload=function(){var t=document.createElement("canvas");t.width=a.width,t.height=a.height;var r=t.getContext("2d");r.drawImage(a,0,0,t.width,t.height),t.toBlob((function(r){var a=document.createElement("img");a.src=window.URL.createObjectURL(r),a.setAttribute("tabindex","900"),a.setAttribute("data-extension",s),o&&a.setAttribute("data-name",o),n&&a.setAttribute("data-size",n),i&&a.setAttribute("data-date",i),a.className="jfile";var l=t.toDataURL();h(a),e.files[a.src]=l.substr(l.indexOf(",")+1)}))},a.src=t}else console.error("remoteParser not defined in your initialization")},r.addFile=function(e){for(var t=[],o=0;o<e.length;o++)if(e[o].size>r.options.maxFileSize)alert("The file is too big");else{var n=e[o].type.split("/");n="image"==n[0]?1:"pdf"==n[1]?2:0,n?(t[o]=new FileReader,t[o].index=o,t[o].type=n,t[o].name=e[o].name,t[o].date=e[o].lastModified,t[o].size=e[o].size,t[o].addEventListener("load",(function(e){2==e.target.type?1==r.options.acceptFiles&&r.addPdf(e.target):r.addImage(e.target.result,e.target.name,e.total,e.target.lastModified)}),!1),t[o].readAsDataURL(e[o])):alert("The extension is not allowed")}},r.destroy=function(){c.removeEventListener("mouseup",m),c.removeEventListener("mousedown",g),c.removeEventListener("mousemove",j),c.removeEventListener("keyup",v),c.removeEventListener("keydown",y),c.removeEventListener("dragstart",C),c.removeEventListener("dragenter",w),c.removeEventListener("dragover",E),c.removeEventListener("drop",A),c.removeEventListener("paste",x),"function"==typeof r.options.onblur&&c.removeEventListener("blur",N),"function"==typeof r.options.onfocus&&c.removeEventListener("focus",I),t.editor=null,t.classList.remove("jeditor-container"),u.remove(),l.remove(),c.remove()};var m=function(e){a=!1},g=function(e){var t=function(t){var o=t.getBoundingClientRect();o.width-(e.clientX-o.left)<40&&e.clientY-o.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var o=e.target.getBoundingClientRect();a={e:e.target,x:e.clientX,y:e.clientY,w:o.width,h:o.height,d:e.target.style.cursor},e.target.style.width||(e.target.style.width=o.width+"px"),e.target.style.height||(e.target.style.height=o.height+"px");var r=window.getSelection();if(r.rangeCount)for(var n=0;n<r.rangeCount;n++)r.removeRange(r.getRangeAt(n))}else a=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),a=!0},j=function(e){if("IMG"==e.target.tagName&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""}if(1==e.which&&a&&a.d){if("e-resize"==a.d||"ne-resize"==a.d||"se-resize"==a.d)if(a.e.style.width=a.w+(e.clientX-a.x)+"px",e.shiftKey){var o=(e.clientX-a.x)*(a.h/a.w);a.e.style.height=a.h+o+"px"}else o=null;o||"s-resize"!=a.d&&"se-resize"!=a.d&&"sw-resize"!=a.d||e.shiftKey||(a.e.style.height=a.h+(e.clientY-a.y)+"px")}},v=function(e){c.innerHTML||(c.innerHTML="<div><br></div>"),"function"==typeof r.options.onkeyup&&r.options.onkeyup(t,r,e)},y=function(e){1==r.options.parseURL&&b(),"function"==typeof r.options.onkeydown&&r.options.onkeydown(t,r,e)},x=function(e){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),o=(e.originalEvent||e).clipboardData.getData("text/plain"),n=(e.originalEvent||e).clipboardData.files;else if(window.clipboardData)t=window.clipboardData.getData("Html"),o=window.clipboardData.getData("Text"),n=window.clipboardData.files;if(n.length)r.addFile(n);else{o=o.split("\r\n");var i="";if("DIV"==e.target.nodeName&&e.target.classList.contains("jeditor"))for(var s=0;s<o.length;s++){var a=document.createElement("div");o[s]?a.innerHTML=o[s]:a.innerHTML="<br/>",e.target.appendChild(a)}else{for(s=0;s<o.length;s++)o[s]&&(i+="<div>"+o[s]+"</div>\r\n");document.execCommand("insertHtml",!1,i)}1==r.options.acceptImages&&p(t)}e.preventDefault()},C=function(e){a&&a.e&&e.preventDefault()},w=function(e){a||0==r.options.dropZone||t.classList.add("jeditor-dragging")},E=function(e){a||0==r.options.dropZone||(s&&clearTimeout(s),s=setTimeout((function(){t.classList.remove("jeditor-dragging")}),100))},A=function(e){if(a||0==r.options.dropZone);else{var o=null;document.caretRangeFromPoint?o=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(o=document.createRange(),o.setStart(e.rangeParent,e.rangeOffset));var n=window.getSelection();n.removeAllRanges(),n.addRange(o),n.anchorNode.parentNode.focus();var i=(e.originalEvent||e).dataTransfer.getData("text/html"),s=(e.originalEvent||e).dataTransfer.getData("text/plain"),l=(e.originalEvent||e).dataTransfer.files;l.length?r.addFile(l):s&&p(i),t.classList.remove("jeditor-dragging"),e.preventDefault()}},N=function(e){r.options.onblur(t,r,e)},I=function(e){r.options.onfocus(t,r,e)};return c.addEventListener("mouseup",m),c.addEventListener("mousedown",g),c.addEventListener("mousemove",j),c.addEventListener("keyup",v),c.addEventListener("keydown",y),c.addEventListener("dragstart",C),c.addEventListener("dragenter",w),c.addEventListener("dragover",E),c.addEventListener("drop",A),c.addEventListener("paste",x),"function"==typeof r.options.onblur&&c.addEventListener("blur",N),"function"==typeof r.options.onfocus&&c.addEventListener("focus",I),"function"==typeof r.options.onload&&r.options.onload(t,r,c),c.innerHTML=d,t.appendChild(c),r.options.snippet&&f(r.options.snippet),null==r.options.toolbar&&(r.options.toolbar=e.editor.getDefaultToolbar()),r.options.toolbar&&(e.toolbar(u,{items:r.options.toolbar}),t.appendChild(u)),r.options.focus&&e.editor.setCursor(c,"initial"==r.options.focus),t.editor=r,r},e.editor.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var o=window.getSelection(),r=o.getRangeAt(0);if(1==t)var n=r.startContainer,i=0;else n=r.endContainer,i=n.length;r.setStart(n,i),r.setEnd(n,i),o.removeAllRanges(),o.addRange(r)},e.editor.getDomain=function(e){return e.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},e.editor.detectUrl=function(e){var t=/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi,o=e.match(t);return o&&"www"==o[0].substr(0,3)&&(o[0]="http://"+o[0]),o},e.editor.youtubeParser=function(e){var t=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,o=e.match(t);return!(!o||11!=o[7].length)&&o[7]},e.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(e,t,o){document.execCommand("bold"),document.queryCommandState("bold")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_italic",onclick:function(e,t,o){document.execCommand("italic"),document.queryCommandState("italic")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_underline",onclick:function(e,t,o){document.execCommand("underline"),document.queryCommandState("underline")?o.classList.add("selected"):o.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(e,t,o){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(e,t,o){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(e,t,o){document.execCommand("indent",!0,null),document.queryCommandState("indent")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},e.files=function(e){e||console.error("No element defined in the arguments of your method");var t={files:[],get:function(){return t.files},set:function(){var o=e.querySelectorAll(".jfile");if(o.length>0){for(var r=[],n=0;n<o.length;n++){var i={},s=o[n].getAttribute("src");o[n].classList.contains("jremove")?i.remove=1:("data"==s.substr(0,4)?(i.content=s.substr(s.indexOf(",")+1),i.extension=o[n].getAttribute("data-extension")):(i.file=s,i.extension=o[n].getAttribute("data-extension"),i.extension||(i.extension=s.substr(s.lastIndexOf(".")+1)),t.files[i.file]&&(i.content=t.files[i.file])),o[n].getAttribute("data-name")&&(i.name=o[n].getAttribute("data-name")),o[n].getAttribute("data-file")&&(i.file=o[n].getAttribute("data-file")),o[n].getAttribute("data-size")&&(i.size=o[n].getAttribute("data-size")),o[n].getAttribute("data-date")&&(i.date=o[n].getAttribute("data-date")),o[n].getAttribute("data-cover")&&(i.cover=o[n].getAttribute("data-cover"))),r[n]=i}return r}}};return t.set(),t},e.form=function(t,o){var r={options:{}},n={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onload:null,onbeforesave:null,onsave:null,onerror:function(t,o){e.alert(o)}};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];r.options.validations||(r.options.validations={}),r.options.submitButton&&r.options.url&&(r.options.submitButton.onclick=function(){r.save()}),r.options.validations.email||(r.options.validations.email=function(e){var t=new RegExp(/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/);return!(!e||!t.test(e))}),r.options.validations.length||(r.options.validations.length=function(e,t){var o=t.getAttribute("data-length")||5;return e.length>=o}),r.options.validations.required||(r.options.validations.required=function(e){return!!e.trim()}),r.setUrl=function(e){r.options.url=e},r.load=function(){e.ajax({url:r.options.url,method:"GET",dataType:"json",success:function(o){e.form.setElements(t,o),"function"==typeof r.options.onload&&r.options.onload(t,o)}})},r.save=function(){var o=r.validate();if(o)r.options.onerror(t,o);else{var n=e.form.getElements(t,!0);if("function"==typeof r.options.onbeforesave){n=r.options.onbeforesave(t,n);if(!1===n)return void console.log("Onbeforesave returned false")}e.ajax({url:r.options.url,method:"POST",dataType:"json",data:n,success:function(e){"function"==typeof r.options.onsave&&r.options.onsave(t,n,e),r.reset()}})}};var s=function(e){e.classList.add("error"),r.options.submitButton&&r.options.submitButton.setAttribute("disabled",!0);var t=e.getAttribute("data-error")||"There is an error in the form";return e.setAttribute("title",t),t},a=function(e){var o=!1;e.classList.remove("error"),e.removeAttribute("title");for(var n=t.querySelectorAll("input, select, textarea"),i=0;i<n.length;i++)n[i].getAttribute("data-validation")&&n[i].classList.contains("error")&&(o=!0);r.options.submitButton&&(o?r.options.submitButton.setAttribute("disabled",!0):r.options.submitButton.removeAttribute("disabled"))};return r.validateElement=function(e){var t=!1,o=e.getAttribute("data-validation");return"function"!=typeof r.options.validations[o]||r.options.validations[o](e.value,e)?e.classList.contains("error")&&a(e):t=s(e),t},r.reset=function(){for(var e=t.querySelectorAll("input, select, textarea"),o=0;o<e.length;o++)"INPUT"==e[o].tagName&&"checkbox"==e[o].type?e[o].removeAttribute("checked"):e[o].value=""},r.validate=function(){for(var e=[],o=t.querySelectorAll("input, select, textarea"),n=0;n<o.length;n++)if(o[n].getAttribute("data-validation")){var i=r.validateElement(o[n]);i&&e.push(i)}return e.length>0&&e.join("<br>")},r.getError=function(){return!!r.validation()},r.setHash=function(){return r.getHash(e.form.getElements(t))},r.getHash=function(e){var t,o,r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)o=e.charCodeAt(t),r=(r<<5)-r+o,r|=0;return r},r.isChanged=function(){var e=r.setHash();return r.options.currentHash!=e},r.resetTracker=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.reset=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.setIgnore=function(e){r.options.ignore=!!e},setTimeout((function(){r.options.currentHash=r.setHash()}),1e3),t.addEventListener("keyup",(function(e){e.target.getAttribute("data-validation")&&r.validateElement(e.target)})),e.form.hasEvents||(window.addEventListener("beforeunload",(function(e){if(r.isChanged()&&0==r.options.ignore){var t=r.options.message?r.options.message:"o/";return t?("undefined"==typeof e&&(e=window.event),e&&(e.returnValue=t),t):void 0}})),e.form.hasEvents=!0),t.form=r,r},e.form.getElements=function(e,t){for(var o={},r=e.querySelectorAll("input, select, textarea"),n=0;n<r.length;n++){var i=r[n],s=i.name,a=i.value;s&&("checkbox"!=r[n].type&&"radio"!=r[n].type||(a=r[n].checked),o[s]=a)}return 1==t?o:JSON.stringify(o)},e.form.setElements=function(e,t){for(var o=e.querySelectorAll("input, select, textarea"),r=0;r<o.length;r++){var n=o[r].getAttribute("name");t[n]&&(o[r].value=t[n])}},e.tracker=e.form,e.guid=function(){for(var e="",t=0;t<32;t++)e+=Math.floor(15*Math.random()).toString(15);return e},e.getWindowWidth=function(){var e=window,t=document,o=t.documentElement,r=t.getElementsByTagName("body")[0],n=e.innerWidth||o.clientWidth||r.clientWidth;return n},e.getWindowHeight=function(){var e=window,t=document,o=t.documentElement,r=t.getElementsByTagName("body")[0],n=e.innerHeight||o.clientHeight||r.clientHeight;return n},e.getPosition=function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,o=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),o=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,o]},e.click=function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},e.findElement=function(e,t){var o=!1;function r(e){e&&!o&&("function"==typeof t?o=t(e):"string"==typeof t&&e.classList&&e.classList.contains(t)&&(o=e)),e.parentNode&&!o&&r(e.parentNode)}return r(e),o},e.sha512=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var o,r,n,i,s,a,l,u,c,d,p=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],h=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],f=new Array(64),b=8;function m(e){return unescape(encodeURIComponent(e))}function g(e){for(var t=[],o=(1<<b)-1,r=e.length*b,n=0;n<r;n+=b)t[n>>5]|=(e.charCodeAt(n/b)&o)<<32-b-n%32;return t}function j(e){for(var t,o="0123456789abcdef",r="",n=4*e.length,i=0;i<n;i+=1)t=e[i>>2]>>8*(3-i%4),r+=o.charAt(t>>4&15)+o.charAt(15&t);return r}function v(e,o){var r,n,i,s;return r=(65535&e.lowOrder)+(65535&o.lowOrder),n=(e.lowOrder>>>16)+(o.lowOrder>>>16)+(r>>>16),i=(65535&n)<<16|65535&r,r=(65535&e.highOrder)+(65535&o.highOrder)+(n>>>16),n=(e.highOrder>>>16)+(o.highOrder>>>16)+(r>>>16),s=(65535&n)<<16|65535&r,new t(s,i)}function y(e,o,r,n){var i,s,a,l;return i=(65535&e.lowOrder)+(65535&o.lowOrder)+(65535&r.lowOrder)+(65535&n.lowOrder),s=(e.lowOrder>>>16)+(o.lowOrder>>>16)+(r.lowOrder>>>16)+(n.lowOrder>>>16)+(i>>>16),a=(65535&s)<<16|65535&i,i=(65535&e.highOrder)+(65535&o.highOrder)+(65535&r.highOrder)+(65535&n.highOrder)+(s>>>16),s=(e.highOrder>>>16)+(o.highOrder>>>16)+(r.highOrder>>>16)+(n.highOrder>>>16)+(i>>>16),l=(65535&s)<<16|65535&i,new t(l,a)}function x(e,o,r,n,i){var s,a,l,u;return s=(65535&e.lowOrder)+(65535&o.lowOrder)+(65535&r.lowOrder)+(65535&n.lowOrder)+(65535&i.lowOrder),a=(e.lowOrder>>>16)+(o.lowOrder>>>16)+(r.lowOrder>>>16)+(n.lowOrder>>>16)+(i.lowOrder>>>16)+(s>>>16),l=(65535&a)<<16|65535&s,s=(65535&e.highOrder)+(65535&o.highOrder)+(65535&r.highOrder)+(65535&n.highOrder)+(65535&i.highOrder)+(a>>>16),a=(e.highOrder>>>16)+(o.highOrder>>>16)+(r.highOrder>>>16)+(n.highOrder>>>16)+(i.highOrder>>>16)+(s>>>16),u=(65535&a)<<16|65535&s,new t(u,l)}function C(e,o,r){return new t(e.highOrder&o.highOrder^e.highOrder&r.highOrder^o.highOrder&r.highOrder,e.lowOrder&o.lowOrder^e.lowOrder&r.lowOrder^o.lowOrder&r.lowOrder)}function w(e,o,r){return new t(e.highOrder&o.highOrder^~e.highOrder&r.highOrder,e.lowOrder&o.lowOrder^~e.lowOrder&r.lowOrder)}function E(e,o){return o<=32?new t(e.highOrder>>>o|e.lowOrder<<32-o,e.lowOrder>>>o|e.highOrder<<32-o):new t(e.lowOrder>>>o|e.highOrder<<32-o,e.highOrder>>>o|e.lowOrder<<32-o)}function A(e){var o=E(e,28),r=E(e,34),n=E(e,39);return new t(o.highOrder^r.highOrder^n.highOrder,o.lowOrder^r.lowOrder^n.lowOrder)}function N(e){var o=E(e,14),r=E(e,18),n=E(e,41);return new t(o.highOrder^r.highOrder^n.highOrder,o.lowOrder^r.lowOrder^n.lowOrder)}function I(e){var o=E(e,1),r=E(e,8),n=M(e,7);return new t(o.highOrder^r.highOrder^n.highOrder,o.lowOrder^r.lowOrder^n.lowOrder)}function L(e){var o=E(e,19),r=E(e,61),n=M(e,6);return new t(o.highOrder^r.highOrder^n.highOrder,o.lowOrder^r.lowOrder^n.lowOrder)}function M(e,o){return o<=32?new t(e.highOrder>>>o,e.lowOrder>>>o|e.highOrder<<32-o):new t(0,e.highOrder<<32-o)}e=m(e);var T=e.length*b;e=g(e),e[T>>5]|=128<<24-T%32,e[31+(T+128>>10<<5)]=T;for(var D=0;D<e.length;D+=32){o=p[0],r=p[1],n=p[2],i=p[3],s=p[4],a=p[5],l=p[6],u=p[7];for(var S=0;S<80;S++)f[S]=S<16?new t(e[2*S+D],e[2*S+D+1]):y(L(f[S-2]),f[S-7],I(f[S-15]),f[S-16]),c=x(u,N(s),w(s,a,l),h[S],f[S]),d=v(A(o),C(o,r,n)),u=l,l=a,a=s,s=v(i,c),i=n,n=r,r=o,o=v(c,d);p[0]=v(o,p[0]),p[1]=v(r,p[1]),p[2]=v(n,p[2]),p[3]=v(i,p[3]),p[4]=v(s,p[4]),p[5]=v(a,p[5]),p[6]=v(l,p[6]),p[7]=v(u,p[7])}var O=[];for(D=0;D<p.length;D++)O.push(p[D].highOrder),O.push(p[D].lowOrder);return j(O)},e.login||(e.login={},e.login.sha512=e.sha512),e.image=function(t,o){var r={options:{}},n={minWidth:!1,onchange:null,singleFile:!0,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed",imageTooSmall:"The resolution is too low, try a image with a better resolution. width > 800px"}};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];t.classList.add("jupload"),r.addImage=function(e){e.date||(e.date="");var t=document.createElement("img");return t.setAttribute("data-date",e.lastmodified?e.lastmodified:e.date),t.setAttribute("data-name",e.name),t.setAttribute("data-size",e.size),t.setAttribute("data-small",e.small?e.small:""),t.setAttribute("data-cover",e.cover?1:0),t.setAttribute("data-extension",e.extension),t.setAttribute("src",e.file),t.className="jfile",t.style.width="100%",t},r.addImages=function(e){1==r.options.singleFile&&(t.innerHTML="");for(var o=0;o<e.length;o++)t.appendChild(r.addImage(e[o]))},r.addFromFile=function(e){var o=e.type.split("/");if("image"==o[0]){1==r.options.singleFile&&(t.innerHTML="");var n=new FileReader;n.addEventListener("load",(function(o){var n=new Image;n.onload=function(){var o=document.createElement("canvas");o.width=n.width,o.height=n.height;var i=o.getContext("2d");i.drawImage(n,0,0,o.width,o.height);var s={file:o.toDataURL(),extension:e.name.substr(e.name.lastIndexOf(".")+1),name:e.name,size:e.size,lastmodified:e.lastModified},a=r.addImage(s);t.appendChild(a),"function"==typeof r.options.onchange&&r.options.onchange(a)},n.src=o.srcElement.result})),n.readAsDataURL(e)}else alert(text.extentionNotAllowed)},r.addFromUrl=function(o){if("data"==o.substr(0,4)||r.options.remoteParser){if("data"==o.substr(0,4)){var n=o.split(";");n=n[0].split("/"),n=n[1]}else{n=o.substr(o.lastIndexOf(".")+1);o=r.options.remoteParser+o}var i=new Image;i.onload=function(){var o=document.createElement("canvas");o.width=i.width,o.height=i.height;var s=o.getContext("2d");s.drawImage(i,0,0,o.width,o.height),o.toBlob((function(i){var s={file:window.URL.createObjectURL(i),extension:n},a=r.addImage(s);t.appendChild(a);var l=o.toDataURL();e.files[s.file]=l.substr(l.indexOf(",")+1),"function"==typeof r.options.onchange&&r.options.onchange(a)}))},i.src=o}else console.error("remoteParser not defined in your initialization")};var s=document.createElement("input");return s.type="file",s.setAttribute("accept","image/*"),s.onchange=function(){for(var e=0;e<this.files.length;e++)r.addFromFile(this.files[e])},t.addEventListener("dblclick",(function(t){e.click(s)})),t.addEventListener("dragenter",(function(e){t.style.border="1px dashed #000"})),t.addEventListener("dragleave",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragstop",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragover",(function(e){e.preventDefault()})),t.addEventListener("drop",(function(e){e.preventDefault(),e.stopPropagation();var o=(e.originalEvent||e).dataTransfer.getData("text/html"),n=(e.originalEvent||e).dataTransfer.files;if(n.length)for(var i=0;i<e.dataTransfer.files.length;i++)r.addFromFile(e.dataTransfer.files[i]);else if(o){1==r.options.singleFile&&(t.innerHTML="");var s=document.createElement("div");s.innerHTML=o;var a=s.querySelectorAll("img");if(a.length)for(i=0;i<a.length;i++)r.addFromUrl(a[i].src)}return t.style.border="1px solid #eee",!1})),t.image=r,r},e.lazyLoading=function(e,t){var o={};t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var r=null,n=function(o){if(null==r){var n=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&n==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight):e.scrollTop<=e.clientHeight&&t.loadUp()&&n==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),r=setTimeout((function(){r=null}),t.timer)}};return e.onscroll=function(e){n(e)},e.onwheel=function(e){n(e)},o},e.loading=function(){var e={},t=null;return e.show=function(){t||(t=document.createElement("div"),t.className="jloading"),document.body.appendChild(t)},e.hide=function(){t&&document.body.removeChild(t)},e}(),e.mask=function(){var t={},o=0,r=[],n=[];return t.run=function(e,n,i){if(e&&n){if(i||(i="."),e==Number(e))var s=(""+e).split("."),a=(e=s[0],s[1]);else e=""+e;o=0,r=[],t.prepare(n);var l=e;if(l)for(var u=0;u<l.length;u++)null!=l[u]&&t.process(l[u]);if(a){t.process(i);l=a;if(l)for(u=0;u<l.length;u++)null!=l[u]&&t.process(l[u])}return r.join("")}return""},t.apply=function(e){if(e.target&&!e.target.getAttribute("readonly")){var i=e.target.getAttribute("data-mask");if(i){if(o=0,r=[],t.prepare(i),e.target.selectionStart<e.target.selectionEnd)var s=e.target.value.substring(0,e.target.selectionStart);else s=e.target.value;if(s)for(var a=0;a<s.length;a++)null!=s[a]&&t.process(s[a]);e.keyCode>46&&(t.process(t.fromKeyCode(e)),e.preventDefault()),e.target.value=r.join(""),n.length==r.length&&n[n.length-1].length==r[r.length-1].length?e.target.setAttribute("data-completed","true"):e.target.setAttribute("data-completed","false")}}},t.process=function(e){do{if("mm"==n[o])return null==r[o]||""==r[o]?parseInt(e)>1&&parseInt(e)<10?(r[o]="0"+e,o++,!0):parseInt(e)<10&&(r[o]=e,!0):(1==r[o]&&r[o]<2&&parseInt(e)<3||0==r[o]&&r[o]<10)&&(r[o]+=e,o++,!0);if("dd"==n[o])return null==r[o]||""==r[o]?parseInt(e)>3&&parseInt(e)<10?(r[o]="0"+e,o++,!0):parseInt(e)<10&&(r[o]=e,!0):(3==r[o]&&parseInt(e)<2||r[o]<3&&parseInt(e)<10)&&(r[o]+=e,o++,!0);if("hh24"==n[o])return null==r[o]||""==r[o]?parseInt(e)>2&&parseInt(e)<10?(r[o]="0"+e,o++,!0):parseInt(e)<10&&(r[o]=e,!0):(2==r[o]&&parseInt(e)<4||r[o]<2&&parseInt(e)<10)&&(r[o]+=e,o++,!0);if("hh"==n[o])return null==r[o]||""==r[o]?parseInt(e)>1&&parseInt(e)<10?(r[o]="0"+e,o++,!0):parseInt(e)<10&&(r[o]=e,!0):(1==r[o]&&parseInt(e)<3||r[o]<1&&parseInt(e)<10)&&(r[o]+=e,o++,!0);if("mi"==n[o]||"ss"==n[o])return null==r[o]||""==r[o]?parseInt(e)>5&&parseInt(e)<10?(r[o]="0"+e,o++,!0):parseInt(e)<10&&(r[o]=e,!0):parseInt(e)<10&&(r[o]+=e,o++,!0);if("yy"==n[o]||"yyyy"==n[o])return parseInt(e)<10&&(null==r[o]||""==r[o]?r[o]=e:r[o]+=e,r[o].length==n[o].length&&o++,!0);if("#"==n[o]||"#.##"==n[o]||"#,##"==n[o]||"# ##"==n[o]){if(e.match(/[0-9]/g)){if("#.##"==n[o])var t=".";else if("#,##"==n[o])t=",";else if("# ##"==n[o])t=" ";else t="";if(null==r[o]||""==r[o])r[o]=e;else if(r[o]+=e,t){r[o]=r[o].match(/[0-9]/g).join("");for(var i=[],s=0,a=r[o].length-1;a>=0;a--)i.push(r[o][a]),s++,s%3||i.push(t);i=i.reverse(),r[o]=i.join(""),r[o].substr(0,1)==t&&(r[o]=r[o].substr(1))}return!0}if("#.##"==n[o]&&"."==e);else if("#,##"==n[o]&&","==e);else if("# ##"==n[o]&&" "==e);else if(r[o]&&(o++,n[o])){if(n[o]==e)return r[o]=e,!0;if("0"==n[o]&&n[o+1]==e)return o++,r[o]=e,!0}return!1}if("0"==n[o])return!!e.match(/[0-9]/g)&&(r[o]=e,o++,!0);if("a"==n[o])return!!e.match(/[a-zA-Z]/g)&&(r[o]=e,o++,!0);if(null!=n[o]){if("\\a"==n[o])var l="a";else if("\\0"==n[o])l="0";else if("[-]"==n[o])if("-"==e||"+"==e)l=e;else l=" ";else l=n[o];if(r[o]=l,e==l)return o++,!0}o++}while(n[o])},t.prepare=function(e){n=[];for(var t=0;t<e.length;t++)e[t].match(/[0-9]|[a-z]|\\/g)?"y"==e[t]&&"y"==e[t+1]&&"y"==e[t+2]&&"y"==e[t+3]?(n.push("yyyy"),t+=3):"y"==e[t]&&"y"==e[t+1]?(n.push("yy"),t++):"m"==e[t]&&"m"==e[t+1]&&"m"==e[t+2]&&"m"==e[t+3]?(n.push("mmmm"),t+=3):"m"==e[t]&&"m"==e[t+1]&&"m"==e[t+2]?(n.push("mmm"),t+=2):"m"==e[t]&&"m"==e[t+1]?(n.push("mm"),t++):"d"==e[t]&&"d"==e[t+1]?(n.push("dd"),t++):"h"==e[t]&&"h"==e[t+1]&&"2"==e[t+2]&&"4"==e[t+3]?(n.push("hh24"),t+=3):"h"==e[t]&&"h"==e[t+1]?(n.push("hh"),t++):"m"==e[t]&&"i"==e[t+1]?(n.push("mi"),t++):"s"==e[t]&&"s"==e[t+1]?(n.push("ss"),t++):"a"==e[t]&&"m"==e[t+1]?(n.push("am"),t++):"p"==e[t]&&"m"==e[t+1]?(n.push("pm"),t++):"\\"==e[t]&&"0"==e[t+1]?(n.push("\\0"),t++):"\\"==e[t]&&"a"==e[t+1]?(n.push("\\a"),t++):n.push(e[t]):"#"==e[t]&&"."==e[t+1]&&"#"==e[t+2]&&"#"==e[t+3]?(n.push("#.##"),t+=3):"#"==e[t]&&","==e[t+1]&&"#"==e[t+2]&&"#"==e[t+3]?(n.push("#,##"),t+=3):"#"==e[t]&&" "==e[t+1]&&"#"==e[t+2]&&"#"==e[t+3]?(n.push("# ##"),t+=3):"["==e[t]&&"-"==e[t+1]&&"]"==e[t+2]?(n.push("[-]"),t+=2):n.push(e[t])},t.fromKeyCode=function(e){var t={188:"44",109:"45",190:"46",191:"47",192:"96",220:"92",222:"39",221:"93",219:"91",173:"45",187:"61",186:"59",189:"45"},o={96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",39:'"',44:"<",46:">",47:"?"},r=e.which;return t.hasOwnProperty(r)&&(r=t[r]),r=!e.shiftKey&&r>=65&&r<=90?String.fromCharCode(r+32):e.shiftKey&&o.hasOwnProperty(r)?o[r]:96<=r&&r<=105?String.fromCharCode(r-48):String.fromCharCode(r),r},"undefined"!==typeof document&&document.addEventListener("keydown",(function(t){e.mask&&e.mask.apply(t)})),t}(),e.modal=function(t,o){var r={options:{}},n={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];!r.options.title&&t.getAttribute("title")&&(r.options.title=t.getAttribute("title"));for(var s=document.createElement("div"),a=0;a<t.children.length;a++)s.appendChild(t.children[a]);r.content=document.createElement("div"),r.content.className="jmodal_content",r.content.innerHTML=t.innerHTML;for(a=0;a<s.children.length;a++)r.content.appendChild(s.children[a]);r.container=document.createElement("div"),r.container.className="jmodal",r.container.appendChild(r.content),r.options.width&&(r.container.style.width=r.options.width),r.options.height&&(r.container.style.height=r.options.height),r.options.title?r.container.setAttribute("title",r.options.title):r.container.classList.add("no-title"),t.innerHTML="",t.style.display="none",t.appendChild(r.container);var l=document.createElement("div");return l.className="jmodal_backdrop",t.appendChild(l),r.open=function(){t.style.display="block";const o=r.container.getBoundingClientRect();e.getWindowWidth()<o.width?(r.container.style.top="",r.container.style.left="",r.container.classList.add("jmodal_fullscreen"),e.animation.slideBottom(r.container,1)):l.style.display="block",e.modal.current=r,"function"==typeof r.options.onopen&&r.options.onopen(t,r)},r.resetPosition=function(){r.container.style.top="",r.container.style.left=""},r.isOpen=function(){return"none"!=t.style.display},r.close=function(){t.style.display="none",l.style.display="",e.modal.current=null,r.container.classList.remove("jmodal_fullscreen"),"function"==typeof r.options.onclose&&r.options.onclose(t,r)},e.modal.hasEvents||(e.modal.current=r,"ontouchstart"in document.documentElement===!0?document.addEventListener("touchstart",e.modal.mouseDownControls):(document.addEventListener("mousedown",e.modal.mouseDownControls),document.addEventListener("mousemove",e.modal.mouseMoveControls),document.addEventListener("mouseup",e.modal.mouseUpControls)),document.addEventListener("keydown",e.modal.keyDownControls),e.modal.hasEvents=!0),r.options.url?e.ajax({url:r.options.url,method:"GET",success:function(e){r.content.innerHTML=e,r.options.closed||r.open()}}):r.options.closed||r.open(),t.modal=r,r},e.modal.current=null,e.modal.position=null,e.modal.keyDownControls=function(t){27==t.which&&e.modal.current&&e.modal.current.close()},e.modal.mouseUpControls=function(t){e.modal.current&&(e.modal.current.container.style.cursor="auto"),e.modal.position=null},e.modal.mouseMoveControls=function(t){if(e.modal.current&&e.modal.position)if(1==t.which||3==t.which){var o=e.modal.position;e.modal.current.container.style.top=o[1]+(t.clientY-o[3])+o[5]/2+"px",e.modal.current.container.style.left=o[0]+(t.clientX-o[2])+o[4]/2+"px",e.modal.current.container.style.cursor="move"}else e.modal.current.container.style.cursor="auto"},e.modal.mouseDownControls=function(t){e.modal.position=[],t.target.classList.contains("jmodal")&&setTimeout((function(){var o=t.target.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var r=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY;else r=t.clientX,n=t.clientY;o.width-(r-o.left)<50&&n-o.top<50?setTimeout((function(){e.modal.current.close()}),100):t.target.getAttribute("title")&&n-o.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e.modal.position=[o.left,o.top,t.clientX,t.clientY,o.width,o.height])}),100)},e.notification=function(t){var o={options:{}},r={icon:null,name:"Notification",date:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var n in r)t&&t.hasOwnProperty(n)?o.options[n]=t[n]:o.options[n]=r[n];var i=document.createElement("div");i.className="jnotification";var s=document.createElement("div");s.className="jnotification-container",i.appendChild(s);var a=document.createElement("div");a.className="jnotification-header",s.appendChild(a);var l=document.createElement("div");if(l.className="jnotification-image",a.appendChild(l),o.options.icon){var u=document.createElement("img");u.src=o.options.icon,l.appendChild(u)}var c=document.createElement("div");if(c.className="jnotification-name",c.innerHTML=o.options.name,a.appendChild(c),1==o.options.closeable){var d=document.createElement("div");d.className="jnotification-close",d.onclick=function(){o.hide()},a.appendChild(d)}var p=document.createElement("div");p.className="jnotification-date",a.appendChild(p);var h=document.createElement("div");if(h.className="jnotification-content",s.appendChild(h),o.options.title){var f=document.createElement("div");f.className="jnotification-title",f.innerHTML=o.options.title,h.appendChild(f)}var b=document.createElement("div");if(b.className="jnotification-message",b.innerHTML=o.options.message,h.appendChild(b),o.show=function(){document.body.appendChild(i),e.getWindowWidth()>800?e.animation.fadeIn(i):e.animation.slideTop(i,1)},o.hide=function(){e.getWindowWidth()>800?e.animation.fadeOut(i,(function(){i.parentNode&&(i.parentNode.removeChild(i),m&&clearTimeout(m))})):e.animation.slideTop(i,0,(function(){i.parentNode&&(i.parentNode.removeChild(i),m&&clearTimeout(m))}))},o.show(),1==o.options.autoHide)var m=setTimeout((function(){o.hide()}),o.options.timeout);return e.getWindowWidth()<800&&i.addEventListener("swipeup",(function(e){o.hide(),e.preventDefault(),e.stopPropagation()})),o},e.notification.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e.progressbar=function(e,t){var o={options:{}},r={value:0,onchange:null,width:null};for(var n in r)t&&t.hasOwnProperty(n)?o.options[n]=t[n]:o.options[n]=r[n];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",o.options.value);var i=document.createElement("div");i.style.width=o.options.value+"%",i.style.color="#fff",e.appendChild(i),o.options.width&&(e.style.width=o.options.width),o.setValue=function(t){t=parseInt(t),o.options.value=t,i.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff","function"==typeof o.options.onchange&&o.options.onchange(e,t)},o.getValue=function(){return o.options.value};var s=function(t){if(t.which){var r=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var n=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else n=t.clientX,t.clientY;o.setValue(Math.round((n-r.left)/r.width*100))}};return"touchstart"in document.documentElement===!0?(e.addEventListener("touchstart",s),e.addEventListener("touchend",s)):(e.addEventListener("mousedown",s),e.addEventListener("mousemove",s)),e.progressbar=o,o},e.rating=function(e,t){var o={options:{}},r={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var n in r)t&&t.hasOwnProperty(n)?o.options[n]=t[n]:o.options[n]=r[n];e.classList.add("jrating");for(var i=0;i<o.options.number;i++){var s=document.createElement("div");s.setAttribute("data-index",i+1),s.setAttribute("title",o.options.tooltip[i]),e.appendChild(s)}if(o.setValue=function(t){for(var r=0;r<o.options.number;r++)r<t?e.children[r].classList.add("jrating-selected"):(e.children[r].classList.remove("jrating-over"),e.children[r].classList.remove("jrating-selected"));o.options.value=t,"function"==typeof o.options.onchange&&o.options.onchange(e,t)},o.getValue=function(){return o.options.value},o.options.value)for(i=0;i<o.options.number;i++)i<o.options.value&&e.children[i].classList.add("jrating-selected");return e.addEventListener("click",(function(e){var t=e.target.getAttribute("data-index");void 0!=t&&(t==o.options.value?o.setValue(0):o.setValue(t))})),e.addEventListener("mouseover",(function(t){for(var r=t.target.getAttribute("data-index"),n=0;n<o.options.number;n++)n<r?e.children[n].classList.add("jrating-over"):e.children[n].classList.remove("jrating-over")})),e.addEventListener("mouseout",(function(t){for(var r=0;r<o.options.number;r++)e.children[r].classList.remove("jrating-over")})),e.rating=o,o},e.slider=function(t,o){var r={options:{},currentImage:null};if(o&&(r.options=o),r.options.items=[],t.classList.contains("jslider"))n=t.querySelector("slider-container");else{t.classList.add("jslider");var n=document.createElement("div");if(n.className="jslider-container",t.children.length>0)for(var i=0;i<t.children.length;i++)r.options.items.push(t.children[i]);if(r.options.items.length>0)for(i=0;i<r.options.items.length;i++){r.options.items[i].classList.add("jfile");var s=r.options.items[i].src.lastIndexOf("/");s<0?r.options.items[i].setAttribute("data-name",r.options.items[i].src):r.options.items[i].setAttribute("data-name",r.options.items[i].src.substr(s+1));s=r.options.items[i].src.lastIndexOf("/");n.appendChild(r.options.items[i])}t.appendChild(n);var a=document.createElement("div");a.className="jslider-close",a.innerHTML="",a.onclick=function(){r.close()},t.appendChild(a)}if(r.show=function(e){if(!e)e=n.children[0];n.classList.contains("jslider-preview")||(n.classList.add("jslider-preview"),a.style.display="block");for(var t=0;t<n.children.length;t++)n.children[t].style.display="none";e.style.display="block",e.previousSibling?n.classList.add("jslider-left"):n.classList.remove("jslider-left"),e.nextSibling?n.classList.add("jslider-right"):n.classList.remove("jslider-right"),r.currentImage=e},r.open=function(){r.show(),"function"==typeof r.options.onopen&&r.options.onopen(t)},r.close=function(){n.classList.remove("jslider-preview"),n.classList.remove("jslider-left"),n.classList.remove("jslider-right");for(var e=0;e<n.children.length;e++)n.children[e].style.display="";a.style.display="",r.currentImage=null,"function"==typeof r.options.onclose&&r.options.onclose(t)},r.reset=function(){n.innerHTML=""},r.addFile=function(e,o){var i=document.createElement("img");i.setAttribute("data-lastmodified",e.lastmodified),i.setAttribute("data-name",e.name),i.setAttribute("data-size",e.size),i.setAttribute("data-extension",e.extension),i.setAttribute("data-cover",e.cover),i.setAttribute("src",e.file),i.className="jfile",n.appendChild(i),r.options.items.push(i),o||"function"==typeof r.options.onchange&&r.options.onchange(t,e)},r.addFiles=function(e){for(var t=0;t<e.length;t++)r.addFile(e[t])},r.next=function(){r.currentImage.nextSibling&&r.show(r.currentImage.nextSibling)},r.prev=function(){r.currentImage.previousSibling&&r.show(r.currentImage.previousSibling)},r.getData=function(){return e.files(n).get()},r.options.data&&r.options.data.length)for(i=0;i<r.options.data.length;i++)r.options.data[i]&&r.addFile(r.options.data[i]);if(r.options.allowAttachment){var l=document.createElement("input");l.type="file",l.className="slider-attachment",l.setAttribute("accept","image/*"),l.style.display="none",l.onchange=function(){for(var e=[],t=0;t<this.files.length;t++){var o=this.files[t].type.split("/");if("image"==o[0]){var n=this.files[t].name;n=n.split("."),n=n[n.length-1];var i={size:this.files[t].size,name:this.files[t].name,extension:n,cover:0,lastmodified:this.files[t].lastModified};e[t]=new FileReader,e[t].addEventListener("load",(function(e){i.file=e.target.result,r.addFile(i)}),!1),e[t].readAsDataURL(this.files[t])}else alert("The extension is not allowed")}};var u=document.createElement("i");u.innerHTML="attachment",u.className="jslider-attach material-icons",u.onclick=function(){e.click(l)},t.appendChild(l),t.appendChild(u)}var c=null,d=function(e){if("IMG"==e.target.tagName){e.target;c=setTimeout((function(){"data"==e.target.src.substr(0,4)?e.target.remove():e.target.classList.contains("jremove")?e.target.classList.remove("jremove"):e.target.classList.add("jremove"),"function"==typeof r.options.onchange&&r.options.onchange(t,e.target)}),1e3)}},p=function(e){c&&clearTimeout(c),"IMG"==e.target.tagName?e.target.classList.contains("jremove")||r.show(e.target):e.target.clientWidth-e.offsetX<40?r.next():e.offsetX<40&&r.prev()};return n.addEventListener("mousedown",d),n.addEventListener("touchstart",d),n.addEventListener("mouseup",p),n.addEventListener("touchend",p),t.addEventListener("swipeleft",(function(e){r.next(),e.preventDefault(),e.stopPropagation()})),t.addEventListener("swiperight",(function(e){r.prev(),e.preventDefault(),e.stopPropagation()})),e.slider.hasEvents||(document.addEventListener("keydown",(function(e){27==e.which&&r.close()})),e.slider.hasEvents=!0),t.slider=r,r},e.sorting=function(e,t){var o={options:{}},r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},n=null;for(var i in r)t&&t.hasOwnProperty(i)?o.options[i]=t[i]:o.options[i]=r[i];e.classList.add("jsorting"),e.addEventListener("dragstart",(function(t){var r=Array.prototype.indexOf.call(t.target.parentNode.children,t.target);n={element:t.target,o:r,d:r},t.target.style.opacity="0.25","function"==typeof o.options.ondragstart&&o.options.ondragstart(e,t.target,t)})),e.addEventListener("dragover",(function(e){if(e.preventDefault(),s(e.target)&&n&&"true"==e.target.getAttribute("draggable")&&n.element!=e.target){if(o.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;t?e.target.parentNode.insertBefore(n.element,e.target):e.target.parentNode.insertBefore(n.element,e.target.nextSibling),n.d=Array.prototype.indexOf.call(e.target.parentNode.children,n.element)}})),e.addEventListener("dragleave",(function(e){e.preventDefault()})),e.addEventListener("dragend",(function(t){t.preventDefault(),n&&("function"==typeof o.options.ondragend&&o.options.ondragend(e,n.element,t),n.o<n.d?t.target.parentNode.insertBefore(n.element,t.target.parentNode.children[n.o]):t.target.parentNode.insertBefore(n.element,t.target.parentNode.children[n.o].nextSibling),n.element.style.opacity="",n=null)})),e.addEventListener("drop",(function(t){t.preventDefault(),n&&n.o!=n.d&&"function"==typeof o.options.ondrop&&o.options.ondrop(e,n.o,n.d,n.element,t.target,t),n.element.style.opacity="",n=null}));for(var s=function(e){var t=!1;function o(e){e.className&&e.classList.contains("jsorting")&&(t=!0),t||o(e.parentNode)}return o(e),t},a=0;a<e.children.length;a++)e.children[a].hasAttribute("draggable")||e.children[a].setAttribute("draggable","true");return e},e.tabs=function(t,o){var r={options:{}},n={data:null,position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];if(t.classList.add("jtabs"),1==r.options.animation){var s=document.createElement("div");s.className="jtabs-border",t.appendChild(s);var a=function(e){var t=r.headers.children[e].getBoundingClientRect(),o=r.content.children[e].getBoundingClientRect();s.style.width=t.width+"px",s.style.left=t.left-o.left+"px",s.style.top=t.height+"px"}}if(r.open=function(e){for(var o=null,n=0;n<r.headers.children.length;n++)r.headers.children[n].classList.contains("jtabs-selected")&&(o=n,r.headers.children[n].classList.remove("jtabs-selected"),r.content.children[n]&&r.content.children[n].classList.remove("jtabs-selected"));r.headers.children[e].classList.add("jtabs-selected"),r.content.children[e]&&r.content.children[e].classList.add("jtabs-selected"),o!=e&&"function"==typeof r.options.onchange&&r.content.children[e]&&r.options.onchange(t,r,e,r.headers.children[e],r.content.children[e]),r.content.children[e]&&"function"==typeof r.options.onclick&&r.options.onclick(t,r,e,r.headers.children[e],r.content.children[e]),1==r.options.hideHeaders&&r.headers.children.length<2&&0==r.options.allowCreate?r.headers.style.display="none":(r.headers.style.display="",1==r.options.animation&&setTimeout((function(){a(e)}),100))},r.selectIndex=function(e){var t=Array.prototype.indexOf.call(r.headers.children,e);t>=0&&r.open(t)},r.create=function(e){if("function"==typeof r.options.onbeforecreate){var o=r.options.onbeforecreate();if(!1===o)return!1;e=o}var n=r.appendElement(e);return"function"==typeof r.options.oncreate&&r.options.oncreate(t,n),n},r.nextNumber=function(){for(var e=0,t=0;t<r.headers.children.length;t++){var o=r.headers.children[t].innerText.match(/[0-9].*/);o>e&&(e=parseInt(o))}return e?e++:e=1,e},r.deleteElement=function(e){if(!r.headers.children[e])return!1;r.headers.removeChild(r.headers.children[e]),r.content.removeChild(r.content.children[e]),r.open(0),"function"==typeof r.options.ondelete&&r.options.ondelete(t,e)},r.appendElement=function(e){if(!e)e=prompt("Title?","");if(e){var t=document.createElement("div");r.content.appendChild(t);var o=document.createElement("div");return o.innerHTML=e,o.content=t,r.options.allowCreate?r.headers.insertBefore(o,r.headers.lastChild):r.headers.appendChild(o),r.options.allowChangePosition&&o.setAttribute("draggable","true"),r.selectIndex(o),t}},r.init=function(){if(1==r.options.allowCreate){var t=document.createElement("i");t.className="jtabs-add",t.setAttribute("draggable","false"),r.headers.appendChild(t)}r.headers.addEventListener("click",(function(e){"DIV"==e.target.tagName?r.selectIndex(e.target):r.create()})),r.headers.addEventListener("contextmenu",(function(e){"DIV"==e.target.tagName&&r.selectIndex(e.target)})),r.headers.children.length&&r.open(0),1==r.options.allowChangePosition&&e.sorting(r.headers,{direction:1,ondrop:function(e,t,o,n,i,s){t>o?r.content.insertBefore(r.content.children[t],r.content.children[o]):r.content.insertBefore(r.content.children[t],r.content.children[o].nextSibling),r.open(o),"function"==typeof r.options.onchangeposition&&r.options.onchangeposition(e,t,o,n,i,s)}})},r.options.data){t.innerHTML="",r.headers=document.createElement("div"),r.content=document.createElement("div"),r.headers.classList.add("jtabs-headers"),r.content.classList.add("jtabs-content"),t.appendChild(r.headers),t.appendChild(r.content);for(var l=0;l<r.options.data.length;l++){var u=document.createElement("div");r.headers.appendChild(u);var c=document.createElement("div");r.content.appendChild(c),u.innerHTML=r.options.data[l].title,r.options.data[l].content?c.innerHTML=r.options.data[l].content:r.options.data[l].url&&e.ajax({url:r.options.data[l].url,type:"GET",success:function(e){c.innerHTML=e},complete:function(){"function"==typeof r.options.onload&&(r.options.onload(t),r.init(),r.open(0))}})}}else t.children[0]&&t.children[1]?(r.headers=t.children[0],r.content=t.children[1],r.headers.classList.add("jtabs-headers"),r.content.classList.add("jtabs-content"),r.init()):(t.innerHTML="",r.headers=document.createElement("div"),r.content=document.createElement("div"),r.headers.classList.add("jtabs-headers"),r.content.classList.add("jtabs-content"),t.appendChild(r.headers),t.appendChild(r.content),r.init());return t.tabs=r,r},e.tags=function(t,o){var r={options:{}},n={value:null,limit:null,limitMessage:"The limit of entries is: ",search:null,placeholder:null,validation:null,onbeforechange:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];var s=null,a=null,l=0,u=0;r.add=function(e,o){if("function"==typeof r.options.onbeforechange){var n=r.options.onbeforechange(t,r,e);null!=n&&(e=n)}if(s&&(s.style.display=""),r.options.limit>0&&t.children.length>=r.options.limit)alert(r.options.limitMessage+" "+r.options.limit);else{var i=p();if(e&&"string"!=typeof e){i&&i.parentNode.classList.contains("jtags")&&(i.innerText.replace("\n","")||t.removeChild(i));for(var a=0;a<=e.length;a++)if(!r.options.limit||t.children.length<r.options.limit){l=document.createElement("div");l.innerHTML=e[a]?e[a]:"<br>",t.appendChild(l)}}else{var l=document.createElement("div");l.innerHTML=e||"<br>",i&&i.parentNode.classList.contains("jtags")?t.insertBefore(l,i.nextSibling):t.appendChild(l)}o&&setTimeout((function(){d(l)}),0),c(),"function"==typeof r.options.onchange&&r.options.onchange(t,r,e||"")}},r.remove=function(e){e.parentNode.removeChild(e),t.children.length||r.add("")},r.getData=function(){for(var e=[],o=0;o<t.children.length;o++){var r=t.children[o].innerText.replace("\n",""),n=t.children[o].getAttribute("data-value");n||(n=r),(r||n)&&e.push({text:r,value:n})}return e},r.getValue=function(e){var o=null;if(null!=e)o=t.children[e].getAttribute("data-value"),o||(o=t.children[e].innerText.replace("\n",""));else{for(var n=[],i=0;i<t.children.length;i++)o=t.children[i].innerText.replace("\n",""),o&&n.push(r.getValue(i));o=n.join(",")}return o},r.setValue=function(e){if(e=e.trim(),e){var t=h(e);r.add(t)}},r.reset=function(){t.innerHTML="<div><br></div>"},r.isValid=function(){for(var e=0,o=0;o<t.children.length;o++)t.children[o].classList.contains("jtags_error")&&e++;return 0==e},r.selectIndex=function(e){a="";var t=p();t.innerText=e.children[1].innerText,e.children[1].getAttribute("data-value")&&t.setAttribute("data-value",e.children[1].getAttribute("data-value")),s&&(s.style.display="",s.innerHTML=""),t.classList.remove("jtags_error"),r.add()},r.search=function(o){if(!s){var n=document.createElement("div");n.style.position="relative",t.parentNode.insertBefore(n,t.nextSibling),s=document.createElement("div"),s.classList.add("jtags_search"),n.appendChild(s)}var i=o.anchorNode.nodeValue;o.anchorNode.nodeValue&&i!=a&&(a=o.anchorNode.nodeValue,l=0,e.ajax({url:r.options.search+a,method:"GET",dataType:"json",success:function(e){if(s.innerHTML="",e.length){s.style.display="block";for(var t=e.length<11?e.length:10,o=0;o<t;o++){var n=e[o].text;!n&&e[o].name&&(n=e[o].name);var i=e[o].value;!i&&e[o].id&&(i=e[o].id);var a=document.createElement("div");0==o&&a.classList.add("selected");var l=document.createElement("img");e[o].image?l.src=e[o].image:l.style.display="none",a.appendChild(l);var u=document.createElement("div");u.setAttribute("data-value",i),u.innerHTML=n,a.onclick=function(){r.selectIndex(this)},a.appendChild(u),s.appendChild(a)}}else s.style.display=""}}))},r.destroy=function(){t.removeEventListener("mouseup",j),t.removeEventListener("keydown",b),t.removeEventListener("keyup",m),t.removeEventListener("paste",g),t.removeEventListener("focus",v),t.removeEventListener("blur",y),t.parentNode.removeChild(t)};var c=function(){for(var e=0;e<t.children.length;e++)r.getValue(e)?(t.children[e].classList.add("jtags_label"),"function"==typeof r.options.validation&&(r.getValue(e)?r.options.validation(t.children[e],t.children[e].innerText,t.children[e].getAttribute("data-value"))?t.children[e].classList.remove("jtags_error"):t.children[e].classList.add("jtags_error"):t.children[e].classList.remove("jtags_error"))):t.children[e].classList.remove("jtags_label")},d=function(e){var t=document.createRange(),o=window.getSelection();t.setStart(e,e.innerText.length),t.collapse(!0),o.removeAllRanges(),o.addRange(t)},p=function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},h=function(e){var t=[],o="";if(e=e.trim(),e){for(var r=0;r<e.length;r++)","==e[r]||";"==e[r]||"\r\n"==e[r]?o&&(t.push(o),o=""):o+=e[r];o&&t.push(o)}return t},f=0,b=function(e){if(f=window.getSelection().anchorOffset,!t.children.length){var o=document.createElement("div");o.innerHTML="<br>",t.appendChild(o)}if(9==e.which||186==e.which||188==e.which){var n=window.getSelection().anchorOffset;n>1&&(!r.options.limit||t.children.length<r.options.limit)&&r.add("",!0),e.preventDefault()}else if(13==e.which){if(s&&""!=s.style.display)r.selectIndex(s.children[l]);else{n=window.getSelection().anchorOffset;n>1&&(!r.options.limit||t.children.length<r.options.limit)&&r.add("",!0)}e.preventDefault()}else 38==e.which?s&&""!=s.style.display&&(s.children[l].classList.remove("selected"),l>0&&l--,s.children[l].classList.add("selected"),e.preventDefault()):40==e.which&&s&&""!=s.style.display&&(s.children[l].classList.remove("selected"),l<9&&l++,s.children[l].classList.add("selected"),e.preventDefault())},m=function(e){if(39==e.which){var t=window.getSelection().anchorOffset;t>1&&t==f&&r.add("",!0)}else 13==e.which||38==e.which||40==e.which?e.preventDefault():(u&&clearTimeout(u),u=setTimeout((function(){var e=window.getSelection();r.options.search&&r.search(e),u=null}),300));c()},g=function(e){if(e.clipboardData||e.originalEvent.clipboardData){(e.originalEvent||e).clipboardData.getData("text/html");var t=(e.originalEvent||e).clipboardData.getData("text/plain")}else if(window.clipboardData)window.clipboardData.getData("Html"),t=window.clipboardData.getData("Text");r.setValue(t),e.preventDefault()},j=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){const t=e.target.getBoundingClientRect();t.width-(e.clientX-t.left)<16&&r.remove(e.target)}s&&(s.style.display="")},v=function(e){if((!t.children.length||r.getValue(t.children.length-1))&&(!r.options.limit||t.children.length<r.options.limit)){var o=document.createElement("div");o.innerHTML="<br>",t.appendChild(o)}"function"==typeof r.options.onfocus&&r.options.onfocus(t,r,r.getValue())},y=function(e){s&&setTimeout((function(){s.style.display=""}),200);for(var o=0;o<t.children.length-1;o++)r.getValue(o)||t.removeChild(t.children[o]);"function"==typeof r.options.onblur&&r.options.onblur(t,r,r.getValue())};return t.addEventListener("mouseup",j),t.addEventListener("keydown",b),t.addEventListener("keyup",m),t.addEventListener("paste",g),t.addEventListener("focus",v),t.addEventListener("blur",y),t.classList.add("jtags"),t.setAttribute("contenteditable",!0),t.setAttribute("spellcheck",!1),r.options.placeholder&&(t.placeholder=r.options.placeholder),r.options.value?r.setValue(r.options.value):t.innerHTML="<div><br></div>","function"==typeof r.options.onload&&r.options.onload(t,r),t.tags=r,r},e.toolbar=function(t,o){var r={options:{}},n={app:null,badge:!1,title:!1,items:[]};for(var i in n)o&&o.hasOwnProperty(i)?r.options[i]=o[i]:r.options[i]=n[i];!t&&o.app&&o.app.el&&(t=document.createElement("div"),o.app.el.appendChild(t)),r.selectItem=function(e){for(var t=s.children,o=0;o<t.length;o++)e!=t[o]&&t[o].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},r.hide=function(){e.animation.slideBottom(t,0,(function(){t.style.display="none"}))},r.show=function(){t.style.display="",e.animation.slideBottom(t,1)},r.get=function(){return t},r.setBadge=function(e,t){s.children[e].children[1].firstChild.innerHTML=t},r.destroy=function(){toolbar.remove(),t.innerHTML=""},r.create=function(e){s.innerHTML="";for(var n=0;n<e.length;n++){var i=document.createElement("div");if(i.classList.add("jtoolbar-item"),e[n].width&&(i.style.width=parseInt(e[n].width)+"px"),e[n].k&&(i.k=e[n].k),e[n].tooltip&&i.setAttribute("title",e[n].tooltip),e[n].id&&i.setAttribute("id",e[n].id),e[n].type&&"i"!=e[n].type)if("select"==e[n].type||"dropdown"==e[n].type){if(e[n].options){if(i.classList.add("jtoolbar-dropdown"),i.setAttribute("tabindex","0"),i.onblur=function(){this.classList.remove("jtoolbar-focus")},e[n].content){var a=document.createElement("div");a.innerHTML='<i class="material-icons">'+e[n].content+"</i>"}else{a=document.createElement("div");a.innerHTML=""}a.classList.add("jtoolbar-dropdown-header"),a.onclick=function(e){if(this.parentNode.classList.contains("jtoolbar-focus"))this.parentNode.classList.remove("jtoolbar-focus");else{e=this.parentNode.parentNode.querySelectorAll(".jtoolbar-item");for(var t=0;t<e.length;t++)e[t].classList.remove("jtoolbar-focus");this.parentNode.classList.add("jtoolbar-focus");const o=this.getBoundingClientRect(),r=this.nextSibling.getBoundingClientRect();window.innerHeight<o.bottom+r.height?(this.nextSibling.style.top="",this.nextSibling.style.bottom=o.height+1+"px"):(this.nextSibling.style.top="",this.nextSibling.style.bottom="")}};var l=document.createElement("div");l.classList.add("jtoolbar-dropdown-content"),i.appendChild(a),i.appendChild(l);for(var u=0;u<e[n].options.length;u++){var c=document.createElement("div");if("function"==typeof e[n].render)var d=e[n].render(e[n].options[u]);else d=e[n].options[u];c.p=i,c.k=u,c.v=e[n].options[u],c.innerHTML=d,c.onchange=e[n].onchange,e[n].content?c.onclick=function(){this.onchange(t,r,this.p,this.v,this.k),this.p.classList.remove("jtoolbar-focus")}:c.onclick=function(){this.parentNode.parentNode.firstChild.innerHTML=this.innerHTML,this.onchange(t,r,this.p,this.v,this.k),this.p.classList.remove("jtoolbar-focus")},l.appendChild(c),e[n].content||0!=u||(a.innerHTML=d)}}e[n].onclick&&(i.onclick=function(o){var n=o;return function(){e[n].onclick(t,r,this)}}(n))}else"color"==e[n].type||"divisor"==e[n].type&&i.classList.add("jtoolbar-divisor");else{var p=document.createElement("i");if(p.classList.add("material-icons"),p.innerHTML=e[n].content?e[n].content:"",i.appendChild(p),1==r.options.badge){var h=document.createElement("div");h.classList.add("jbadge");var f=document.createElement("div");f.innerHTML=e[n].badge?e[n].badge:"",h.appendChild(f),i.appendChild(h)}if(e[n].title)if(1==r.options.title){var b=document.createElement("span");b.innerHTML=e[n].title,i.appendChild(b)}else i.setAttribute("title",e[n].title);r.options.app&&e[n].route?(i.route=e[n].route,i.onclick=function(){o.app.pages(this.route)},r.options.app.pages(e[n].route,{toolbarItem:i,closed:!0,onenter:function(){r.selectItem(this.toolbarItem)}})):e[n].onclick&&(i.onclick=function(o){var n=o;return function(){e[n].onclick(t,r,this)}}(n))}s.appendChild(i)}},t.classList.add("jtoolbar"),t.innerHTML="",t.onclick=function(t){var o=e.findElement(t.target,"jtoolbar-item");o&&r.selectItem(o)};var s=document.createElement("div");return t.appendChild(s),r.options.app&&t.classList.add("jtoolbar-mobile"),r.create(r.options.items),t.toolbar=r,r},e}))},"6ece":function(e,t,o){},"75eb":function(e,t,o){"use strict";var r=o("ade3"),n=o("53ca"),i=(o("159b"),o("9d65")),s=o("80d2"),a=o("58df"),l=o("d9bd");function u(e){var t=Object(n["a"])(e);return"boolean"===t||"string"===t||e.nodeType===Node.ELEMENT_NODE}t["a"]=Object(a["a"])(i["a"]).extend({name:"detachable",props:{attach:{default:!1,validator:u},contentClass:{type:String,default:""}},data:function(){return{activatorNode:null,hasDetached:!1}},watch:{attach:function(){this.hasDetached=!1,this.initDetach()},hasContent:function(){this.$nextTick(this.initDetach)}},beforeMount:function(){var e=this;this.$nextTick((function(){if(e.activatorNode){var t=Array.isArray(e.activatorNode)?e.activatorNode:[e.activatorNode];t.forEach((function(t){if(t.elm&&e.$el.parentNode){var o=e.$el===e.$el.parentNode.firstChild?e.$el:e.$el.nextSibling;e.$el.parentNode.insertBefore(t.elm,o)}}))}}))},mounted:function(){this.hasContent&&this.initDetach()},deactivated:function(){this.isActive=!1},beforeDestroy:function(){try{if(this.$refs.content&&this.$refs.content.parentNode&&this.$refs.content.parentNode.removeChild(this.$refs.content),this.activatorNode){var e=Array.isArray(this.activatorNode)?this.activatorNode:[this.activatorNode];e.forEach((function(e){e.elm&&e.elm.parentNode&&e.elm.parentNode.removeChild(e.elm)}))}}catch(t){console.log(t)}},methods:{getScopeIdAttrs:function(){var e=Object(s["o"])(this.$vnode,"context.$options._scopeId");return e&&Object(r["a"])({},e,"")},initDetach:function(){var e;this._isDestroyed||!this.$refs.content||this.hasDetached||""===this.attach||!0===this.attach||"attach"===this.attach||(e=!1===this.attach?document.querySelector("[data-app]"):"string"===typeof this.attach?document.querySelector(this.attach):this.attach,e?(e.appendChild(this.$refs.content),this.hasDetached=!0):Object(l["c"])("Unable to locate target ".concat(this.attach||"[data-app]"),this))}}})},8547:function(e,t,o){"use strict";var r=o("2b0e"),n=o("80d2");t["a"]=r["a"].extend({name:"comparable",props:{valueComparator:{type:Function,default:n["i"]}}})},"8ce9":function(e,t,o){},"8e36":function(e,t,o){"use strict";var r=o("5530"),n=o("ade3"),i=(o("a9e3"),o("c7cd"),o("6ece"),o("0789")),s=o("90a2"),a=o("a9ad"),l=o("fe6c"),u=o("a452"),c=o("7560"),d=o("80d2"),p=o("58df"),h=Object(p["a"])(a["a"],Object(l["b"])(["absolute","fixed","top","bottom"]),u["a"],c["a"]);t["a"]=h.extend({name:"v-progress-linear",directives:{intersect:s["a"]},props:{active:{type:Boolean,default:!0},backgroundColor:{type:String,default:null},backgroundOpacity:{type:[Number,String],default:null},bufferValue:{type:[Number,String],default:100},color:{type:String,default:"primary"},height:{type:[Number,String],default:4},indeterminate:Boolean,query:Boolean,reverse:Boolean,rounded:Boolean,stream:Boolean,striped:Boolean,value:{type:[Number,String],default:0}},data:function(){return{internalLazyValue:this.value||0,isVisible:!0}},computed:{__cachedBackground:function(){return this.$createElement("div",this.setBackgroundColor(this.backgroundColor||this.color,{staticClass:"v-progress-linear__background",style:this.backgroundStyle}))},__cachedBar:function(){return this.$createElement(this.computedTransition,[this.__cachedBarType])},__cachedBarType:function(){return this.indeterminate?this.__cachedIndeterminate:this.__cachedDeterminate},__cachedBuffer:function(){return this.$createElement("div",{staticClass:"v-progress-linear__buffer",style:this.styles})},__cachedDeterminate:function(){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-progress-linear__determinate",style:{width:Object(d["g"])(this.normalizedValue,"%")}}))},__cachedIndeterminate:function(){return this.$createElement("div",{staticClass:"v-progress-linear__indeterminate",class:{"v-progress-linear__indeterminate--active":this.active}},[this.genProgressBar("long"),this.genProgressBar("short")])},__cachedStream:function(){return this.stream?this.$createElement("div",this.setTextColor(this.color,{staticClass:"v-progress-linear__stream",style:{width:Object(d["g"])(100-this.normalizedBuffer,"%")}})):null},backgroundStyle:function(){var e,t=null==this.backgroundOpacity?this.backgroundColor?1:.3:parseFloat(this.backgroundOpacity);return e={opacity:t},Object(n["a"])(e,this.isReversed?"right":"left",Object(d["g"])(this.normalizedValue,"%")),Object(n["a"])(e,"width",Object(d["g"])(Math.max(0,this.normalizedBuffer-this.normalizedValue),"%")),e},classes:function(){return Object(r["a"])({"v-progress-linear--absolute":this.absolute,"v-progress-linear--fixed":this.fixed,"v-progress-linear--query":this.query,"v-progress-linear--reactive":this.reactive,"v-progress-linear--reverse":this.isReversed,"v-progress-linear--rounded":this.rounded,"v-progress-linear--striped":this.striped,"v-progress-linear--visible":this.isVisible},this.themeClasses)},computedTransition:function(){return this.indeterminate?i["d"]:i["e"]},isReversed:function(){return this.$vuetify.rtl!==this.reverse},normalizedBuffer:function(){return this.normalize(this.bufferValue)},normalizedValue:function(){return this.normalize(this.internalLazyValue)},reactive:function(){return Boolean(this.$listeners.change)},styles:function(){var e={};return this.active||(e.height=0),this.indeterminate||100===parseFloat(this.normalizedBuffer)||(e.width=Object(d["g"])(this.normalizedBuffer,"%")),e}},methods:{genContent:function(){var e=Object(d["r"])(this,"default",{value:this.internalLazyValue});return e?this.$createElement("div",{staticClass:"v-progress-linear__content"},e):null},genListeners:function(){var e=this.$listeners;return this.reactive&&(e.click=this.onClick),e},genProgressBar:function(e){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-progress-linear__indeterminate",class:Object(n["a"])({},e,!0)}))},onClick:function(e){if(this.reactive){var t=this.$el.getBoundingClientRect(),o=t.width;this.internalValue=e.offsetX/o*100}},onObserve:function(e,t,o){this.isVisible=o},normalize:function(e){return e<0?0:e>100?100:parseFloat(e)}},render:function(e){var t={staticClass:"v-progress-linear",attrs:{role:"progressbar","aria-valuemin":0,"aria-valuemax":this.normalizedBuffer,"aria-valuenow":this.indeterminate?void 0:this.normalizedValue},class:this.classes,directives:[{name:"intersect",value:this.onObserve}],style:{bottom:this.bottom?0:void 0,height:this.active?Object(d["g"])(this.height):0,top:this.top?0:void 0},on:this.genListeners()};return e("div",t,[this.__cachedStream,this.__cachedBackground,this.__cachedBuffer,this.__cachedBar,this.genContent()])}})},"8ff2":function(e,t,o){},"99d9":function(e,t,o){"use strict";o.d(t,"a",(function(){return i})),o.d(t,"b",(function(){return l}));var r=o("b0af"),n=o("80d2"),i=Object(n["h"])("v-card__actions"),s=Object(n["h"])("v-card__subtitle"),a=Object(n["h"])("v-card__text"),l=Object(n["h"])("v-card__title");r["a"]},b0af:function(e,t,o){"use strict";var r=o("5530"),n=(o("a9e3"),o("0481"),o("615b"),o("10d2")),i=o("297c"),s=o("1c87"),a=o("58df");t["a"]=Object(a["a"])(i["a"],s["a"],n["a"]).extend({name:"v-card",props:{flat:Boolean,hover:Boolean,img:String,link:Boolean,loaderHeight:{type:[Number,String],default:4},raised:Boolean},computed:{classes:function(){return Object(r["a"])(Object(r["a"])({"v-card":!0},s["a"].options.computed.classes.call(this)),{},{"v-card--flat":this.flat,"v-card--hover":this.hover,"v-card--link":this.isClickable,"v-card--loading":this.loading,"v-card--disabled":this.disabled,"v-card--raised":this.raised},n["a"].options.computed.classes.call(this))},styles:function(){var e=Object(r["a"])({},n["a"].options.computed.styles.call(this));return this.img&&(e.background='url("'.concat(this.img,'") center center / cover no-repeat')),e}},methods:{genProgress:function(){var e=i["a"].options.methods.genProgress.call(this);return e?this.$createElement("div",{staticClass:"v-card__progress",key:"progress"},[e]):null}},render:function(e){var t=this.generateRouteLink(),o=t.tag,r=t.data;return r.style=this.styles,this.isClickable&&(r.attrs=r.attrs||{},r.attrs.tabindex=0),e(o,this.setBackgroundColor(this.color,r),[this.genProgress(),this.$slots.default])}})},ba87:function(e,t,o){"use strict";var r=o("5530"),n=(o("a9e3"),o("1b2c"),o("a9ad")),i=o("7560"),s=o("58df"),a=o("80d2"),l=Object(s["a"])(i["a"]).extend({name:"v-label",functional:!0,props:{absolute:Boolean,color:{type:String,default:"primary"},disabled:Boolean,focused:Boolean,for:String,left:{type:[Number,String],default:0},right:{type:[Number,String],default:"auto"},value:Boolean},render:function(e,t){var o=t.children,s=t.listeners,l=t.props,u={staticClass:"v-label",class:Object(r["a"])({"v-label--active":l.value,"v-label--is-disabled":l.disabled},Object(i["b"])(t)),attrs:{for:l.for,"aria-hidden":!l.for},on:s,style:{left:Object(a["g"])(l.left),right:Object(a["g"])(l.right),position:l.absolute?"absolute":"relative"},ref:"label"};return e("label",n["a"].options.methods.setTextColor(l.focused&&l.color,u),o)}});t["a"]=l},c37a:function(e,t,o){"use strict";var r=o("5530"),n=(o("a9e3"),o("4de4"),o("d81d"),o("ac1f"),o("1276"),o("99af"),o("d191"),o("9d26")),i=o("ba87"),s=(o("8ff2"),o("a9ad")),a=o("7560"),l=o("58df"),u=o("80d2"),c=Object(l["a"])(s["a"],a["a"]).extend({name:"v-messages",props:{value:{type:Array,default:function(){return[]}}},methods:{genChildren:function(){return this.$createElement("transition-group",{staticClass:"v-messages__wrapper",attrs:{name:"message-transition",tag:"div"}},this.value.map(this.genMessage))},genMessage:function(e,t){return this.$createElement("div",{staticClass:"v-messages__message",key:t},Object(u["r"])(this,"default",{message:e,key:t})||[e])}},render:function(e){return e("div",this.setTextColor(this.color,{staticClass:"v-messages",class:this.themeClasses}),[this.genChildren()])}}),d=c,p=o("7e2b"),h=o("38cb"),f=o("d9f7"),b=Object(l["a"])(p["a"],h["a"]),m=b.extend().extend({name:"v-input",inheritAttrs:!1,props:{appendIcon:String,backgroundColor:{type:String,default:""},dense:Boolean,height:[Number,String],hideDetails:[Boolean,String],hint:String,id:String,label:String,loading:Boolean,persistentHint:Boolean,prependIcon:String,value:null},data:function(){return{lazyValue:this.value,hasMouseDown:!1}},computed:{classes:function(){return Object(r["a"])({"v-input--has-state":this.hasState,"v-input--hide-details":!this.showDetails,"v-input--is-label-active":this.isLabelActive,"v-input--is-dirty":this.isDirty,"v-input--is-disabled":this.isDisabled,"v-input--is-focused":this.isFocused,"v-input--is-loading":!1!==this.loading&&null!=this.loading,"v-input--is-readonly":this.isReadonly,"v-input--dense":this.dense},this.themeClasses)},computedId:function(){return this.id||"input-".concat(this._uid)},hasDetails:function(){return this.messagesToDisplay.length>0},hasHint:function(){return!this.hasMessages&&!!this.hint&&(this.persistentHint||this.isFocused)},hasLabel:function(){return!(!this.$slots.label&&!this.label)},internalValue:{get:function(){return this.lazyValue},set:function(e){this.lazyValue=e,this.$emit(this.$_modelEvent,e)}},isDirty:function(){return!!this.lazyValue},isLabelActive:function(){return this.isDirty},messagesToDisplay:function(){var e=this;return this.hasHint?[this.hint]:this.hasMessages?this.validations.map((function(t){if("string"===typeof t)return t;var o=t(e.internalValue);return"string"===typeof o?o:""})).filter((function(e){return""!==e})):[]},showDetails:function(){return!1===this.hideDetails||"auto"===this.hideDetails&&this.hasDetails}},watch:{value:function(e){this.lazyValue=e}},beforeCreate:function(){this.$_modelEvent=this.$options.model&&this.$options.model.event||"input"},methods:{genContent:function(){return[this.genPrependSlot(),this.genControl(),this.genAppendSlot()]},genControl:function(){return this.$createElement("div",{staticClass:"v-input__control",attrs:{title:this.attrs$.title}},[this.genInputSlot(),this.genMessages()])},genDefaultSlot:function(){return[this.genLabel(),this.$slots.default]},genIcon:function(e,t){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this["".concat(e,"Icon")],s="click:".concat(Object(u["v"])(e)),a=!(!this.listeners$[s]&&!t),l=Object(f["a"])({attrs:{"aria-label":a?Object(u["v"])(e).split("-")[0]+" icon":void 0,color:this.validationState,dark:this.dark,disabled:this.isDisabled,light:this.light},on:a?{click:function(e){e.preventDefault(),e.stopPropagation(),o.$emit(s,e),t&&t(e)},mouseup:function(e){e.preventDefault(),e.stopPropagation()}}:void 0},r);return this.$createElement("div",{staticClass:"v-input__icon",class:e?"v-input__icon--".concat(Object(u["v"])(e)):void 0},[this.$createElement(n["a"],l,i)])},genInputSlot:function(){return this.$createElement("div",this.setBackgroundColor(this.backgroundColor,{staticClass:"v-input__slot",style:{height:Object(u["g"])(this.height)},on:{click:this.onClick,mousedown:this.onMouseDown,mouseup:this.onMouseUp},ref:"input-slot"}),[this.genDefaultSlot()])},genLabel:function(){return this.hasLabel?this.$createElement(i["a"],{props:{color:this.validationState,dark:this.dark,disabled:this.isDisabled,focused:this.hasState,for:this.computedId,light:this.light}},this.$slots.label||this.label):null},genMessages:function(){var e=this;return this.showDetails?this.$createElement(d,{props:{color:this.hasHint?"":this.validationState,dark:this.dark,light:this.light,value:this.messagesToDisplay},attrs:{role:this.hasMessages?"alert":null},scopedSlots:{default:function(t){return Object(u["r"])(e,"message",t)}}}):null},genSlot:function(e,t,o){if(!o.length)return null;var r="".concat(e,"-").concat(t);return this.$createElement("div",{staticClass:"v-input__".concat(r),ref:r},o)},genPrependSlot:function(){var e=[];return this.$slots.prepend?e.push(this.$slots.prepend):this.prependIcon&&e.push(this.genIcon("prepend")),this.genSlot("prepend","outer",e)},genAppendSlot:function(){var e=[];return this.$slots.append?e.push(this.$slots.append):this.appendIcon&&e.push(this.genIcon("append")),this.genSlot("append","outer",e)},onClick:function(e){this.$emit("click",e)},onMouseDown:function(e){this.hasMouseDown=!0,this.$emit("mousedown",e)},onMouseUp:function(e){this.hasMouseDown=!1,this.$emit("mouseup",e)}},render:function(e){return e("div",this.setTextColor(this.validationState,{staticClass:"v-input",class:this.classes}),this.genContent())}});t["a"]=m},ce7e:function(e,t,o){"use strict";var r=o("5530"),n=(o("8ce9"),o("7560"));t["a"]=n["a"].extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render:function(e){var t;return this.$attrs.role&&"separator"!==this.$attrs.role||(t=this.vertical?"vertical":"horizontal"),e("hr",{class:Object(r["a"])({"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical},this.themeClasses),attrs:Object(r["a"])({role:"separator","aria-orientation":t},this.$attrs),on:this.$listeners})}})},d191:function(e,t,o){},e0c7:function(e,t,o){"use strict";var r=o("5530"),n=(o("0bc6"),o("7560")),i=o("58df");t["a"]=Object(i["a"])(n["a"]).extend({name:"v-subheader",props:{inset:Boolean},render:function(e){return e("div",{staticClass:"v-subheader",class:Object(r["a"])({"v-subheader--inset":this.inset},this.themeClasses),attrs:this.$attrs,on:this.$listeners},this.$slots.default)}})},e4d3:function(e,t,o){"use strict";var r=o("2b0e");t["a"]=r["a"].extend({name:"returnable",props:{returnValue:null},data:function(){return{isActive:!1,originalValue:null}},watch:{isActive:function(e){e?this.originalValue=this.returnValue:this.$emit("update:return-value",this.originalValue)}},methods:{save:function(e){var t=this;this.originalValue=e,setTimeout((function(){t.isActive=!1}))}}})},f1c1:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var r=o("d4ec"),n=o("bee2"),i=o("0179"),s=o.n(i),a=function(){function e(t,o,n,i){Object(r["a"])(this,e),this.table=t,this.isUserEditableCell=o,this.x1=n,this.y1=i}return Object(n["a"])(e,[{key:"activateUserEditableClasses",value:function(){this.resetCellClasses(),this.isUserEditableCell&&this.addClassUserEditCell()}},{key:"resetCellClasses",value:function(){var e=document.getElementsByClassName("userEditCell");while(e.length)e[0].classList.remove("userEditCell");while(e.length)e[0].classList.add("readonly")}},{key:"addClassUserEditCell",value:function(){for(var e=0;e<this.table.headers.length;e++){var t=this.getCell(e,this.y1,this.table);t.classList.add("userEditCell")}}},{key:"getCell",value:function(e,t,o){var r=s.a.getColumnNameFromId([e,t]),n=o.getCell([r]);return n}}]),e}()},fece:function(e,t,o){}}]);
//# sourceMappingURL=chunk-3baedfce.3b56269f.js.map